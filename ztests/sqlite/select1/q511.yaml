script: |
  super -f text -I q511.spq > q511.out

inputs:
  - name: q511.spq
    data: |
      SELECT abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      c-d,
      b-c,
      b,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet)
      WHERE b>c
      AND c BETWEEN b-2 AND d+2
      ORDER BY 4,2,5,6,1,3;
  - name: t1

outputs:
  - name: q511.out
    data: |
      234	468	-2	1	232	232
      239	478	-3	1	236	237
      121	1240	1	1	124	122
      153	1510	-4	1	151	152
      168	1670	-3	1	167	167
      245	490	-1	2	249	247
      138	1390	1	2	139	137
      142	1430	1	2	143	142
