script: |
  super -f text -I q654.spq > q654.out

inputs:
  - name: q654.spq
    data: |
      SELECT c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      OR (e>c OR e<d)
      OR (e>a AND e<b)
      ORDER BY 3,1,2,4;
  - name: t1

outputs:
  - name: q654.out
    data: |
      102	1000	1014	1
      106	1050	1067	-2
      113	1120	1130	-1
      119	1180	1172	3
      123	1240	1226	1
      125	1290	1272	-3
      134	1300	1325	1
      137	1390	1371	1
      141	1430	1411	1
      147	1450	1472	-1
      150	1510	1521	-4
      155	1580	1564	-1
      161	1600	1622	-3
      166	1670	1676	-3
      172	1700	1714	1
      176	358	1769	-2
      184	364	1828	1
      187	376	1861	2
      193	382	1918	3
      195	398	1964	-1
      202	402	2019	-1
      208	410	2069	1
      214	426	2125	2
      215	432	2165	-2
      224	440	2226	2
      225	458	2264	-1
      231	468	2323	-2
      235	478	2368	-3
      244	486	2419	3
      247	490	2476	-1
