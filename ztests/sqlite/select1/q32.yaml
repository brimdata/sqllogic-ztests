script: |
  super -f text -I q32.spq > q32.out

inputs:
  - name: q32.spq
    data: |
      SELECT d,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b,
      c,
      e
      FROM t1 (FORMAT parquet)
      WHERE b>c
      ORDER BY 1,2,4,3,5;
  - name: t1

outputs:
  - name: q32.out
    data: |
      122	1240	124	123	120
      128	1290	129	125	126
      136	1390	139	137	135
      140	1430	143	141	144
      154	1510	151	150	152
      156	1580	158	155	157
      169	1670	167	166	165
      190	382	194	193	192
      196	398	198	195	197
      217	432	218	215	219
      226	458	228	225	227
      233	468	232	231	230
      238	478	236	235	237
      248	490	249	247	246
