# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q934.sql > q934.out

inputs:
  - name: q934.sql
    data: |
      SELECT (SELECT count(*) FROM t1 AS x WHERE x.c>t1.c AND x.d<t1.d),
      a-b,
      b,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      e
      FROM t1
      ORDER BY 1,5,4,3,2;
  - name: t1

outputs:
  - name: q934.out
    data: |
      0	4	100	1000	103
      0	2	105	1050	109
      0	-1	112	1120	110
      0	-3	118	1180	117
      0	-3	124	1240	120
      0	-2	129	1290	126
      0	1	130	1300	132
      0	-1	139	1390	135
      0	-1	143	1430	144
      0	4	145	1450	146
      0	2	151	1510	152
      0	1	158	1580	157
      0	3	160	1600	162
      0	1	167	1670	165
      0	4	170	1700	173
      0	4	175	358	177
      0	1	181	364	180
      0	2	186	376	189
      0	-3	194	382	192
      0	1	198	398	197
      0	1	200	402	204
      0	-1	206	410	209
      0	2	211	426	210
      0	-2	218	432	219
      0	-3	223	440	221
      0	1	228	458	227
      0	2	232	468	230
      0	3	236	478	237
      0	3	240	486	242
      0	-4	249	490	246
