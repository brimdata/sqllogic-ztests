# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q354.sql > q354.out

inputs:
  - name: q354.sql
    data: |
      SELECT a,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      (SELECT count(*) FROM t1 AS x WHERE x.c>t1.c AND x.d<t1.d),
      a+b*2+c*3+d*4,
      b
      FROM t1
      WHERE c>d
      OR d>e
      ORDER BY 2,5,1,3,4;

outputs:
  - name: q354.out
    data: |
      179	358	0	1769	175
      182	364	0	1828	181
      188	376	0	1861	186
      191	382	0	1918	194
      205	410	0	2069	206
      213	426	0	2125	211
      220	440	0	2226	223
      234	468	0	2323	232
      239	478	0	2368	236
      243	486	0	2419	240
      245	490	0	2476	249
      104	1000	0	1014	100
      111	1120	0	1130	112
      115	1180	0	1172	118
      121	1240	0	1226	124
      127	1290	0	1272	129
      131	1300	0	1325	130
      138	1390	0	1371	139
      142	1430	0	1411	143
      149	1450	0	1472	145
      153	1510	0	1521	151
      163	1600	0	1622	160
      168	1670	0	1676	167
      174	1700	0	1714	170
