# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q951.sql > q951.out

inputs:
  - name: q951.sql
    data: |
      SELECT (a+b+c+d+e)/5,
      d,
      a+b*2,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      b-c,
      c-d,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END
      FROM t1
      ORDER BY 6,7,2,4,1,5,3;
  - name: t1

outputs:
  - name: q951.out
    data: |
      152	154	455	10	1	-4	1510
      237	238	711	27	1	-3	478
      127	128	385	5	4	-3	1290
      162	164	483	12	-1	-3	1600
      167	169	502	13	1	-3	1670
      177	178	529	15	-1	-2	358
      217	217	652	23	3	-2	432
      232	233	698	26	1	-2	468
      107	108	317	1	-1	-2	1050
      197	196	595	19	3	-1	398
      202	203	601	20	-2	-1	402
      227	226	685	25	3	-1	458
      247	248	743	29	2	-1	490
      112	114	335	2	-1	-1	1120
      147	148	439	9	-2	-1	1450
      157	156	475	11	3	-1	1580
      182	183	544	16	-3	1	364
      207	207	617	21	-2	1	410
      102	101	304	0	-2	1	1000
      122	122	369	4	1	1	1240
      132	133	391	6	-4	1	1300
      137	136	416	7	2	1	1390
      142	140	428	8	2	1	1430
      172	171	514	14	-2	1	1700
      187	185	560	17	-1	2	376
      212	212	635	22	-3	2	426
      222	222	666	24	-1	2	440
      192	190	579	18	1	3	382
      242	241	723	28	-4	3	486
      117	116	351	3	-1	3	1180
