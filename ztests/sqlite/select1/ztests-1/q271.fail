# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q271.sql > q271.out

inputs:
  - name: q271.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      a-b,
      a,
      d-e
      FROM t1
      ORDER BY 1,2,3,4,5;

outputs:
  - name: q271.out
    data: |
      358	15	4	179	1
      364	16	1	182	3
      376	17	2	188	-4
      382	18	-3	191	-2
      398	19	1	199	-1
      402	20	1	201	-1
      410	21	-1	205	-2
      426	22	2	213	2
      432	23	-2	216	-2
      440	24	-3	220	1
      458	25	1	229	-1
      468	26	2	234	3
      478	27	3	239	1
      486	28	3	243	-1
      490	29	-4	245	2
      1000	0	4	104	-2
      1050	1	2	107	-1
      1120	2	-1	111	4
      1180	3	-3	115	-1
      1240	4	-3	121	2
      1290	5	-2	127	2
      1300	6	1	131	1
      1390	7	-1	138	1
      1430	8	-1	142	-4
      1450	9	4	149	2
      1510	10	2	153	2
      1580	11	1	159	-1
      1600	12	3	163	2
      1670	13	1	168	4
      1700	14	4	174	-2
