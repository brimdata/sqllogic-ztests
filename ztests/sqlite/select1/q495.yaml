script: |
  super -f text -I q495.spq > q495.out

inputs:
  - name: q495.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      abs(b-c),
      e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a),
      a
      FROM t1 (FORMAT parquet)
      WHERE d>e
      AND b>c
      AND c BETWEEN b-2 AND d+2
      ORDER BY 4,3,6,1,2,5;
  - name: t1

outputs:
  - name: q495.out
    data: |
      3706	2	246	111	245	245
      1826	1	120	222	121	121
      2046	2	135	222	138	138
      2281	1	152	333	153	153
      2501	1	165	333	168	168
      3473	1	230	333	234	234
      3553	1	237	444	239	239
