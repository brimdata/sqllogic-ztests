script: |
  super -f text -I q150.spq > q150.out

inputs:
  - name: q150.spq
    data: |
      SELECT abs(b-c),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b,
      a
      FROM t1 (FORMAT parquet)
      WHERE b>c
      AND d>e
      ORDER BY 4,1,3,2;
  - name: t1

outputs:
  - name: q150.out
    data: |
      1	1240	124	121
      4	1290	129	127
      2	1390	139	138
      1	1510	151	153
      1	1670	167	168
      1	468	232	234
      1	478	236	239
      2	490	249	245
