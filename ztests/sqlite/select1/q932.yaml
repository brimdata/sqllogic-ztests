script: |
  super -f text -I q932.spq > q932.out

inputs:
  - name: q932.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      e,
      c-d,
      a+b*2+c*3,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR e+d BETWEEN a+b-10 AND c+130
      OR c BETWEEN b-2 AND d+2
      ORDER BY 5,4,3,1,2,6;
  - name: t1

outputs:
  - name: q932.out
    data: |
      247	246	-1	1484	111	-4
      112	110	-1	674	222	-1
      117	117	3	708	222	-3
      122	120	1	738	222	-3
      127	126	-3	760	222	-2
      137	135	1	827	222	-1
      142	144	1	851	222	-1
      207	209	1	1241	222	-1
      222	221	2	1338	222	-3
      107	109	-2	635	333	2
      132	132	1	793	333	1
      152	152	-4	905	333	2
      157	157	-1	940	333	1
      167	165	-3	1000	333	1
      182	180	1	1096	333	1
      187	189	2	1121	333	2
      197	197	-1	1180	333	1
      202	204	-1	1207	333	1
      212	210	2	1277	333	2
      227	227	-1	1360	333	1
      232	230	-2	1391	333	2
      102	103	1	610	444	4
      147	146	-1	880	444	4
      162	162	-3	966	444	3
      172	173	1	1030	444	4
      177	177	-2	1057	444	4
      237	237	-3	1416	444	3
