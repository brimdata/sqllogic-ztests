script: |
  super -f text -I q563.spq > q563.out

inputs:
  - name: q563.spq
    data: |
      SELECT abs(b-c),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      ORDER BY 1,3,2;
  - name: t1

outputs:
  - name: q563.out
    data: |
      1	222	111
      1	222	333
      1	222	333
      1	333	333
      1	333	333
      1	333	333
      1	444	333
      1	222	444
      1	222	444
      1	333	444
      1	333	555
      1	444	555
      1	444	555
      2	222	111
      2	222	111
      2	222	111
      2	333	222
      2	111	444
      2	444	555
      2	444	555
      2	444	555
      3	333	222
      3	222	333
      3	333	333
      3	333	555
      3	333	555
      3	333	555
      4	444	222
      4	222	333
      4	333	444
