script: |
  super -f text -I q813.spq > q813.out

inputs:
  - name: q813.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3,
      a-b,
      c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR d>e
      OR b>c
      ORDER BY 4,2,1,6,5,3;
  - name: t1

outputs:
  - name: q813.out
    data: |
      490	111	1484	-4	247	444
      382	222	1158	-3	193	444
      440	222	1338	-3	224	444
      1240	222	738	-3	123	333
      432	222	1297	-2	215	333
      1290	222	760	-2	125	333
      410	222	1241	-1	208	111
      1120	222	674	-1	113	111
      1390	222	827	-1	137	111
      1430	222	851	-1	141	111
      364	333	1096	1	184	333
      398	333	1180	1	195	555
      402	333	1207	1	202	222
      458	333	1360	1	225	555
      1300	333	793	1	134	444
      1580	333	940	1	155	555
      1670	333	1000	1	166	333
      426	333	1277	2	214	222
      468	333	1391	2	231	555
      1510	333	905	2	150	333
      478	444	1416	3	235	555
      1600	444	966	3	161	333
      358	444	1057	4	176	555
      1450	444	880	4	147	555
