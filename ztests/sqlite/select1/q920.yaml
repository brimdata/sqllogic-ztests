script: |
  super -f text -I q920.spq > q920.out

inputs:
  - name: q920.spq
    data: |
      SELECT a-b,
      c-d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      ORDER BY 3,1,2;
  - name: t1

outputs:
  - name: q920.out
    data: |
      -4	-1	111
      -3	1	222
      -3	2	222
      -3	3	222
      -3	3	222
      -2	-3	222
      -2	-2	222
      -1	-1	222
      -1	1	222
      -1	1	222
      -1	1	222
      1	-3	333
      1	-1	333
      1	-1	333
      1	-1	333
      1	-1	333
      1	1	333
      1	1	333
      2	-4	333
      2	-2	333
      2	-2	333
      2	2	333
      2	2	333
      3	-3	444
      3	-3	444
      3	3	444
      4	-2	444
      4	-1	444
      4	1	444
      4	1	444
