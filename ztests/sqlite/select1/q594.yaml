script: |
  super -f text -I q594.spq > q594.out

inputs:
  - name: q594.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      a+b*2+c*3+d*4,
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE d>e
      OR c BETWEEN b-2 AND d+2
      ORDER BY 1,4,3,2;
  - name: t1

outputs:
  - name: q594.out
    data: |
      111	248	2476	1484
      222	114	1130	674
      222	122	1226	738
      222	128	1272	760
      222	136	1371	827
      222	140	1411	851
      222	207	2069	1241
      222	222	2226	1338
      333	108	1067	635
      333	133	1325	793
      333	154	1521	905
      333	169	1676	1000
      333	183	1828	1096
      333	185	1861	1121
      333	203	2019	1207
      333	212	2125	1277
      333	233	2323	1391
      444	101	1014	610
      444	148	1472	880
      444	164	1622	966
      444	171	1714	1030
      444	178	1769	1057
      444	238	2368	1416
