script: |
  super -f text -I q185.spq > q185.out

inputs:
  - name: q185.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      c
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 1,3,2;
  - name: t1

outputs:
  - name: q185.out
    data: |
      358	1769	176
      376	1861	187
      382	1918	193
      426	2125	214
      432	2165	215
      440	2226	224
      468	2323	231
      478	2368	235
      486	2419	244
      1000	1014	102
      1050	1067	106
      1120	1130	113
      1180	1172	119
      1240	1226	123
      1290	1272	125
      1510	1521	150
      1600	1622	161
      1670	1676	166
