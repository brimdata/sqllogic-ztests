script: |
  super -f text -I q2813.spq | sort > q2813.out

inputs:
  - name: q2813.spq
    data: |
      SELECT b,
      d,
      b-c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      OR d>e
      OR e+d BETWEEN a+b-10 AND c+130
      ORDER BY 3,4,5,1;
  - name: t1

outputs:
  - name: q2813.out
    data: |
      -	101	-	555	-
      -	203	-	222	402
      105	108	-1	333	1050
      112	114	-1	555	1120
      129	128	4	333	1290
      130	133	-4	444	1300
      139	136	2	111	1390
      160	164	-1	333	1600
      170	171	-2	555	1700
      181	183	-3	333	364
      186	185	-1	444	376
      194	190	1	444	382
      198	196	3	555	398
      206	207	-2	555	-
      211	212	-3	222	426
      218	217	3	333	432
      223	222	-1	444	440
      228	226	3	555	458
      232	233	1	555	468
      236	238	-	555	2360
      249	248	2	444	490
