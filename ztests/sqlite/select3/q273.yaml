script: |
  super -f text -I q273.spq | sort > q273.out

inputs:
  - name: q273.spq
    data: |
      SELECT a+b*2,
      abs(a),
      e,
      a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      ORDER BY 5,2;
  - name: t1

outputs:
  - name: q273.out
    data: |
      -	-	-	-	-
      -	-	110	-	1120
      -	104	-	-	-
      -	115	117	-	-
      -	201	204	-	402
      317	107	109	1067	1050
      369	121	-	1226	1240
      385	127	126	1272	1290
      391	131	132	1325	1300
      416	138	135	1371	1390
      428	142	144	1411	1430
      439	149	146	-	1450
      455	153	-	-	1510
      475	159	157	-	1580
      483	163	162	1622	1600
      502	168	165	-	1670
      514	174	173	1714	1700
      529	179	177	-	358
      544	182	180	1828	364
      560	188	189	1861	376
      579	191	192	1918	382
      595	199	197	1964	398
      635	213	210	2125	426
      652	216	219	2165	432
      666	220	221	2226	440
      685	229	227	2264	458
      698	234	230	2323	468
      711	239	237	-	2360
      723	243	-	-	486
      743	245	246	2476	490
