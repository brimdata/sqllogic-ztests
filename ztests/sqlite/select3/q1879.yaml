script: |
  super -f text -I q1879.spq | sort > q1879.out

inputs:
  - name: q1879.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d-e,
      d,
      a+b*2+c*3,
      a-b,
      c-d,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR d NOT BETWEEN 110 AND 150
      ORDER BY 6,2,1,7;
  - name: t1

outputs:
  - name: q1879.out
    data: |
      -	-	101	-	-	1	-
      -	-	207	-	-	1	-
      1050	-1	108	635	2	-2	1067
      1300	1	133	793	1	1	1325
      1390	1	136	827	-1	1	1371
      1430	-4	140	851	-1	1	1411
      1580	-	-	940	1	-	-
      1600	2	164	966	3	-3	1622
      1670	-	-	1000	1	-	-
      1700	-2	171	1030	4	1	1714
      2360	1	238	-	3	-	-
      364	3	183	1096	1	1	1828
      376	-4	185	1121	2	2	1861
      382	-2	190	1158	-3	3	1918
      398	-1	196	1180	1	-1	1964
      402	-1	203	-	-	-1	-
      426	2	212	1277	2	2	2125
      432	-2	217	1297	-2	-2	2165
      440	1	222	1338	-3	2	2226
      458	-1	226	1360	1	-1	2264
      468	3	233	1391	2	-2	2323
      490	2	248	1484	-4	-1	2476
