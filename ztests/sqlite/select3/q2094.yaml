script: |
  super -f text -I q2094.spq | sort > q2094.out

inputs:
  - name: q2094.spq
    data: |
      SELECT a+b*2+c*3,
      a+b*2+c*3+d*4+e*5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b,
      abs(a)
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q2094.out
    data: |
      -	-	444	-	-	104
      -	-	444	-	-	115
      -	-	444	-	206	-
      -	-	444	1120	112	-
      -	-	444	2360	236	239
      -	-	444	402	-	201
      1000	-	333	1670	167	168
      1030	2579	444	1700	170	174
      1057	-	444	358	175	179
      1096	2728	333	364	181	182
      1121	2806	333	376	186	188
      1158	2878	222	382	194	191
      1180	2949	333	398	198	199
      1277	3175	333	426	211	213
      1297	3260	222	432	218	216
      1338	3331	222	440	223	220
      1360	3399	333	458	228	229
      1391	3473	333	468	232	234
      1455	-	444	486	240	243
      1484	3706	111	490	249	245
      635	1612	333	1050	105	107
      738	-	222	1240	124	121
      760	1902	222	1290	129	127
      793	1985	333	1300	130	131
      827	2046	222	1390	139	138
      851	2131	222	1430	143	142
      880	-	444	1450	145	149
      905	-	333	1510	151	153
      940	-	333	1580	158	159
      966	2432	444	1600	160	163
