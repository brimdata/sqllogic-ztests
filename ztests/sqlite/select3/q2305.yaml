script: |
  super -f text -I q2305.spq | sort > q2305.out

inputs:
  - name: q2305.spq
    data: |
      SELECT a-b,
      a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      (a+b+c+d+e)/5,
      abs(a)
      FROM t1 (FORMAT parquet)
      ORDER BY 4,2;
  - name: t1

outputs:
  - name: q2305.out
    data: |
      -	-	444	-	-
      -	-	444	-	-
      -	104	444	-	104
      -	115	444	-	115
      -	201	444	-	201
      -1	138	222	137	138
      -1	142	222	142	142
      -2	127	222	127	127
      -2	216	222	217	216
      -3	121	222	-	121
      -3	191	222	192	191
      -3	220	222	222	220
      -4	245	111	247	245
      1	131	333	132	131
      1	159	333	-	159
      1	168	333	-	168
      1	182	333	182	182
      1	199	333	197	199
      1	229	333	227	229
      2	107	333	107	107
      2	153	333	-	153
      2	188	333	187	188
      2	213	333	212	213
      2	234	333	232	234
      3	163	444	162	163
      3	239	444	-	239
      3	243	444	-	243
      4	149	444	-	149
      4	174	444	172	174
      4	179	444	-	179
