script: |
  super -f tsv -I q522.sql | sort > q522.out

vector: true

inputs:
  - name: q522.sql
    data: |
      SELECT c,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b-c,
      d-e,
      a+b*2+c*3
      FROM t1;
  - name: t1

outputs:
  - name: q522.out
    data: |
      102	NULL	555	NULL	NULL	NULL
      106	1050	333	-1	-1	635
      113	1120	555	-1	4	NULL
      119	NULL	333	NULL	-1	NULL
      123	1240	333	1	NULL	738
      125	1290	333	4	2	760
      134	1300	444	-4	1	793
      137	1390	111	2	1	827
      141	1430	111	2	-4	851
      147	1450	555	-2	NULL	880
      150	1510	555	1	NULL	905
      155	1580	555	3	NULL	940
      161	1600	333	-1	2	966
      166	1670	555	1	NULL	1000
      172	1700	555	-2	-2	1030
      176	358	555	-1	NULL	1057
      184	364	333	-3	3	1096
      187	376	444	-1	-4	1121
      193	382	444	1	-2	1158
      195	398	555	3	-1	1180
      202	402	222	NULL	-1	NULL
      208	NULL	555	-2	NULL	NULL
      214	426	222	-3	2	1277
      215	432	333	3	-2	1297
      224	440	444	-1	1	1338
      225	458	555	3	-1	1360
      231	468	555	1	3	1391
      244	486	222	-4	NULL	1455
      247	490	444	2	2	1484
      NULL	2360	555	NULL	1	NULL
