script: |
  super -f tsv -I q3141.sql | sort > q3141.out

vector: true

inputs:
  - name: q3141.sql
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2,
      b-c,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a,
      a-b
      FROM t1
      ORDER BY 4,1,2,5,6;
  - name: t1

outputs:
  - name: q3141.out
    data: |
      111	743	2	490	245	-4
      222	369	1	1240	121	-3
      222	385	4	1290	127	-2
      222	416	2	1390	138	-1
      222	428	2	1430	142	-1
      222	579	1	382	191	-3
      222	652	3	432	216	-2
      222	666	-1	440	220	-3
      333	317	-1	1050	107	2
      333	391	-4	1300	131	1
      333	455	1	1510	153	2
      333	475	3	1580	159	1
      333	502	1	1670	168	1
      333	544	-3	364	182	1
      333	560	-1	376	188	2
      333	595	3	398	199	1
      333	635	-3	426	213	2
      333	685	3	458	229	1
      333	698	1	468	234	2
      444	439	-2	1450	149	4
      444	483	-1	1600	163	3
      444	514	-2	1700	174	4
      444	529	-1	358	179	4
      444	711	NULL	2360	239	3
      444	723	-4	486	243	3
      444	NULL	-1	1120	NULL	NULL
      444	NULL	-2	NULL	NULL	NULL
      444	NULL	NULL	402	201	NULL
      444	NULL	NULL	NULL	104	NULL
      444	NULL	NULL	NULL	115	NULL
