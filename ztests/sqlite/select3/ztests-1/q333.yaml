script: |
  super -f tsv -I q333.sql | sort > q333.out

vector: true

inputs:
  - name: q333.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3,
      c-d
      FROM t1
      WHERE a>b
      OR e+d BETWEEN a+b-10 AND c+130
      ORDER BY 1,3;
  - name: t1

outputs:
  - name: q333.out
    data: |
      1050	635	-2
      1290	760	-3
      1300	793	1
      1450	880	NULL
      1510	905	NULL
      1580	940	NULL
      1600	966	-3
      1670	1000	NULL
      1700	1030	1
      2360	NULL	NULL
      358	1057	NULL
      364	1096	1
      376	1121	2
      398	1180	-1
      426	1277	2
      458	1360	-1
      468	1391	-2
      486	1455	NULL
