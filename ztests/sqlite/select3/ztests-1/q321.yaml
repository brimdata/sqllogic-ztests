script: |
  super -f tsv -I q321.sql | sort > q321.out

vector: true

inputs:
  - name: q321.sql
    data: |
      SELECT d,
      a,
      a+b*2+c*3,
      a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END
      FROM t1
      ORDER BY 5,3,1,2,4;
  - name: t1

outputs:
  - name: q321.out
    data: |
      101	104	NULL	NULL	NULL
      108	107	635	1067	1050
      114	NULL	NULL	NULL	1120
      116	115	NULL	NULL	NULL
      122	121	738	1226	1240
      128	127	760	1272	1290
      133	131	793	1325	1300
      136	138	827	1371	1390
      140	142	851	1411	1430
      164	163	966	1622	1600
      171	174	1030	1714	1700
      183	182	1096	1828	364
      185	188	1121	1861	376
      190	191	1158	1918	382
      196	199	1180	1964	398
      203	201	NULL	NULL	402
      207	NULL	NULL	NULL	NULL
      212	213	1277	2125	426
      217	216	1297	2165	432
      222	220	1338	2226	440
      226	229	1360	2264	458
      233	234	1391	2323	468
      238	239	NULL	NULL	2360
      248	245	1484	2476	490
      NULL	149	880	NULL	1450
      NULL	153	905	NULL	1510
      NULL	159	940	NULL	1580
      NULL	168	1000	NULL	1670
      NULL	179	1057	NULL	358
      NULL	243	1455	NULL	486
