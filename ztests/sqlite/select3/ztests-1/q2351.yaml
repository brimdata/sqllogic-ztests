script: |
  super -f tsv -I q2351.sql | sort > q2351.out

vector: true

inputs:
  - name: q2351.sql
    data: |
      SELECT a,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4
      FROM t1
      ORDER BY 2,3,1;
  - name: t1

outputs:
  - name: q2351.out
    data: |
      104	NULL	NULL
      107	1050	1067
      115	NULL	NULL
      121	1240	1226
      127	1290	1272
      131	1300	1325
      138	1390	1371
      142	1430	1411
      149	1450	NULL
      153	1510	NULL
      159	1580	NULL
      163	1600	1622
      168	1670	NULL
      174	1700	1714
      179	358	NULL
      182	364	1828
      188	376	1861
      191	382	1918
      199	398	1964
      201	402	NULL
      213	426	2125
      216	432	2165
      220	440	2226
      229	458	2264
      234	468	2323
      239	2360	NULL
      243	486	NULL
      245	490	2476
      NULL	1120	NULL
      NULL	NULL	NULL
