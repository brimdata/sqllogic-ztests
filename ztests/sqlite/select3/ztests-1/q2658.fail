# Failed due to: https://github.com/brimdata/super/issues/6549
script: |
  super -f tsv -I q2658.sql | sort > q2658.out

vector: true

inputs:
  - name: q2658.sql
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4,
      a,
      b,
      c,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b)
      FROM t1
      WHERE c>d
      OR EXISTS(SELECT 1 FROM t1 AS x WHERE x.b<t1.b);
  - name: t1

outputs:
  - name: q2658.out
    data: |
      111	222	1371	138	139	137	5
      111	222	1411	142	143	141	6
      222	333	2125	213	211	214	19
      222	444	NULL	243	240	244	25
      333	222	1226	121	124	123	2
      333	222	1272	127	129	125	3
      333	222	2165	216	218	215	20
      333	333	1828	182	181	184	14
      333	444	1622	163	160	161	10
      333	444	NULL	115	NULL	119	0
      444	111	2476	245	249	247	26
      444	222	1918	191	194	193	16
      444	222	2226	220	223	224	21
      444	333	1325	131	130	134	4
      444	333	1861	188	186	187	15
      555	333	1964	199	198	195	17
      555	333	2264	229	228	225	22
      555	333	2323	234	232	231	23
      555	333	NULL	153	151	150	8
      555	333	NULL	159	158	155	9
      555	333	NULL	168	167	166	11
      555	444	1714	174	170	172	12
      555	444	NULL	104	NULL	102	0
      555	444	NULL	149	145	147	7
      555	444	NULL	179	175	176	13
      555	444	NULL	239	236	NULL	24
      555	444	NULL	NULL	112	113	1
      555	444	NULL	NULL	206	208	18
