script: |
  super -f tsv -I q2657.sql | sort > q2657.out

vector: true

inputs:
  - name: q2657.sql
    data: |
      SELECT d,
      c-d,
      a+b*2+c*3,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5
      FROM t1
      ORDER BY 2,5,6,3,1;
  - name: t1

outputs:
  - name: q2657.out
    data: |
      101	1	NULL	102	NULL	NULL
      108	-2	635	106	1050	1612
      114	-1	NULL	113	1120	NULL
      116	3	NULL	119	NULL	NULL
      122	1	738	123	1240	NULL
      128	-3	760	125	1290	1902
      133	1	793	134	1300	1985
      136	1	827	137	1390	2046
      140	1	851	141	1430	2131
      164	-3	966	161	1600	2432
      171	1	1030	172	1700	2579
      183	1	1096	184	364	2728
      185	2	1121	187	376	2806
      190	3	1158	193	382	2878
      196	-1	1180	195	398	2949
      203	-1	NULL	202	402	NULL
      207	1	NULL	208	NULL	NULL
      212	2	1277	214	426	3175
      217	-2	1297	215	432	3260
      222	2	1338	224	440	3331
      226	-1	1360	225	458	3399
      233	-2	1391	231	468	3473
      238	NULL	NULL	NULL	2360	NULL
      248	-1	1484	247	490	3706
      NULL	NULL	1000	166	1670	NULL
      NULL	NULL	1057	176	358	NULL
      NULL	NULL	1455	244	486	NULL
      NULL	NULL	880	147	1450	NULL
      NULL	NULL	905	150	1510	NULL
      NULL	NULL	940	155	1580	NULL
