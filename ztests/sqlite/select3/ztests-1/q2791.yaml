script: |
  super -f tsv -I q2791.sql | sort > q2791.out

vector: true

inputs:
  - name: q2791.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      abs(a),
      a-b,
      d,
      a+b*2+c*3
      FROM t1
      ORDER BY 4,3,5,6,2,7,1;
  - name: t1

outputs:
  - name: q2791.out
    data: |
      1050	107	333	107	2	108	635
      1120	NULL	555	NULL	NULL	114	NULL
      1240	NULL	333	121	-3	122	738
      1290	127	333	127	-2	128	760
      1300	132	444	131	1	133	793
      1390	137	111	138	-1	136	827
      1430	142	111	142	-1	140	851
      1450	NULL	555	149	4	NULL	880
      1510	NULL	555	153	2	NULL	905
      1580	NULL	555	159	1	NULL	940
      1600	162	333	163	3	164	966
      1670	NULL	555	168	1	NULL	1000
      1700	172	555	174	4	171	1030
      2360	NULL	555	239	3	238	NULL
      358	NULL	555	179	4	NULL	1057
      364	182	333	182	1	183	1096
      376	187	444	188	2	185	1121
      382	192	444	191	-3	190	1158
      398	197	555	199	1	196	1180
      402	NULL	222	201	NULL	203	NULL
      426	212	222	213	2	212	1277
      432	217	333	216	-2	217	1297
      440	222	444	220	-3	222	1338
      458	227	555	229	1	226	1360
      468	232	555	234	2	233	1391
      486	NULL	222	243	3	NULL	1455
      490	247	444	245	-4	248	1484
      NULL	NULL	333	115	NULL	116	NULL
      NULL	NULL	555	104	NULL	101	NULL
      NULL	NULL	555	NULL	NULL	207	NULL
