# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q2570.sql | sort > q2570.out

vector: true

inputs:
  - name: q2570.sql
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      (SELECT count(*) FROM t1 AS x WHERE x.c>t1.c AND x.d<t1.d),
      d-e,
      c-d
      FROM t1;
  - name: t1

outputs:
  - name: q2570.out
    data: |
      111	138	222	136	0	1	1
      111	142	222	140	0	-4	1
      222	201	444	203	0	-1	-1
      222	213	333	212	0	2	2
      222	243	444	NULL	0	NULL	NULL
      333	107	333	108	0	-1	-2
      333	115	444	116	0	-1	3
      333	121	222	122	0	NULL	1
      333	127	222	128	0	2	-3
      333	163	444	164	0	2	-3
      333	182	333	183	0	3	1
      333	216	222	217	0	-2	-2
      444	131	333	133	0	1	1
      444	188	333	185	0	-4	2
      444	191	222	190	0	-2	3
      444	220	222	222	0	1	2
      444	245	111	248	0	2	-1
      555	104	444	101	0	NULL	1
      555	149	444	NULL	0	NULL	NULL
      555	153	333	NULL	0	NULL	NULL
      555	159	333	NULL	0	NULL	NULL
      555	168	333	NULL	0	NULL	NULL
      555	174	444	171	0	-2	1
      555	179	444	NULL	0	NULL	NULL
      555	199	333	196	0	-1	-1
      555	229	333	226	0	-1	-1
      555	234	333	233	0	3	-2
      555	239	444	238	0	1	NULL
      555	NULL	444	114	0	4	-1
      555	NULL	444	207	0	NULL	1
