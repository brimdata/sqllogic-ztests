script: |
  super -f tsv -I q2715.sql | sort > q2715.out

vector: true

inputs:
  - name: q2715.sql
    data: |
      SELECT c-d,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      abs(a),
      d
      FROM t1
      ORDER BY 1,2;
  - name: t1

outputs:
  - name: q2715.out
    data: |
      -1	1120	NULL	NULL	114
      -1	398	197	199	196
      -1	402	NULL	201	203
      -1	458	227	229	226
      -1	490	247	245	248
      -2	1050	107	107	108
      -2	432	217	216	217
      -2	468	232	234	233
      -3	1290	127	127	128
      -3	1600	162	163	164
      1	1240	NULL	121	122
      1	1300	132	131	133
      1	1390	137	138	136
      1	1430	142	142	140
      1	1700	172	174	171
      1	364	182	182	183
      1	NULL	NULL	104	101
      1	NULL	NULL	NULL	207
      2	376	187	188	185
      2	426	212	213	212
      2	440	222	220	222
      3	382	192	191	190
      3	NULL	NULL	115	116
      NULL	1450	NULL	149	NULL
      NULL	1510	NULL	153	NULL
      NULL	1580	NULL	159	NULL
      NULL	1670	NULL	168	NULL
      NULL	2360	NULL	239	238
      NULL	358	NULL	179	NULL
      NULL	486	NULL	243	NULL
