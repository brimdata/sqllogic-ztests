script: |
  super -f tsv -I q2712.sql | sort > q2712.out

vector: true

inputs:
  - name: q2712.sql
    data: |
      SELECT d-e,
      (a+b+c+d+e)/5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a-b,
      a+b*2+c*3+d*4,
      abs(a)
      FROM t1;
  - name: t1

outputs:
  - name: q2712.out
    data: |
      -1	107	333	1050	2	1067	107
      -1	197	555	398	1	1964	199
      -1	227	555	458	1	2264	229
      -1	NULL	222	402	NULL	NULL	201
      -1	NULL	333	NULL	NULL	NULL	115
      -2	172	555	1700	4	1714	174
      -2	192	444	382	-3	1918	191
      -2	217	333	432	-2	2165	216
      -4	142	111	1430	-1	1411	142
      -4	187	444	376	2	1861	188
      1	132	444	1300	1	1325	131
      1	137	111	1390	-1	1371	138
      1	222	444	440	-3	2226	220
      1	NULL	555	2360	3	NULL	239
      2	127	333	1290	-2	1272	127
      2	162	333	1600	3	1622	163
      2	212	222	426	2	2125	213
      2	247	444	490	-4	2476	245
      3	182	333	364	1	1828	182
      3	232	555	468	2	2323	234
      4	NULL	555	1120	NULL	NULL	NULL
      NULL	NULL	222	486	3	NULL	243
      NULL	NULL	333	1240	-3	1226	121
      NULL	NULL	555	1450	4	NULL	149
      NULL	NULL	555	1510	2	NULL	153
      NULL	NULL	555	1580	1	NULL	159
      NULL	NULL	555	1670	1	NULL	168
      NULL	NULL	555	358	4	NULL	179
      NULL	NULL	555	NULL	NULL	NULL	104
      NULL	NULL	555	NULL	NULL	NULL	NULL
