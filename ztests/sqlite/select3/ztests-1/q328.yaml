script: |
  super -f tsv -I q328.sql | sort > q328.out

vector: true

inputs:
  - name: q328.sql
    data: |
      SELECT (a+b+c+d+e)/5,
      d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3,
      a+b*2+c*3+d*4+e*5
      FROM t1
      WHERE (a>b-2 AND a<b+2)
      OR c BETWEEN b-2 AND d+2;
  - name: t1

outputs:
  - name: q328.out
    data: |
      107	108	333	635	1612
      132	133	333	793	1985
      137	136	222	827	2046
      142	140	222	851	2131
      162	164	444	966	2432
      172	171	444	1030	2579
      182	183	333	1096	2728
      187	185	333	1121	2806
      197	196	333	1180	2949
      212	212	333	1277	3175
      222	222	222	1338	3331
      227	226	333	1360	3399
      232	233	333	1391	3473
      247	248	111	1484	3706
      NULL	114	444	NULL	NULL
      NULL	122	222	738	NULL
      NULL	207	444	NULL	NULL
      NULL	NULL	333	1000	NULL
      NULL	NULL	333	940	NULL
