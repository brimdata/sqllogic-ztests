# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q851.sql | sort > q851.out

vector: true

inputs:
  - name: q851.sql
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      c,
      abs(a),
      b,
      (SELECT count(*) FROM t1 AS x WHERE x.c>t1.c AND x.d<t1.d)
      FROM t1
      ORDER BY 3,2,5,4,1,6;
  - name: t1

outputs:
  - name: q851.out
    data: |
      111	248	247	245	249	0
      222	122	123	121	124	0
      222	128	125	127	129	0
      222	136	137	138	139	0
      222	140	141	142	143	0
      222	190	193	191	194	0
      222	217	215	216	218	0
      222	222	224	220	223	0
      333	108	106	107	105	0
      333	133	134	131	130	0
      333	183	184	182	181	0
      333	185	187	188	186	0
      333	196	195	199	198	0
      333	212	214	213	211	0
      333	226	225	229	228	0
      333	233	231	234	232	0
      333	NULL	150	153	151	0
      333	NULL	155	159	158	0
      333	NULL	166	168	167	0
      444	101	102	104	NULL	0
      444	114	113	NULL	112	0
      444	116	119	115	NULL	0
      444	164	161	163	160	0
      444	171	172	174	170	0
      444	203	202	201	NULL	0
      444	207	208	NULL	206	0
      444	238	NULL	239	236	0
      444	NULL	147	149	145	0
      444	NULL	176	179	175	0
      444	NULL	244	243	240	0
