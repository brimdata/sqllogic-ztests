script: |
  super -f tsv -I q723.sql | sort > q723.out

vector: true

inputs:
  - name: q723.sql
    data: |
      SELECT b,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b-c,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a,
      abs(a),
      d-e
      FROM t1
      ORDER BY 5,4,2,7,3;
  - name: t1

outputs:
  - name: q723.out
    data: |
      105	333	-1	1050	107	107	-1
      112	555	-1	1120	NULL	NULL	4
      124	333	1	1240	121	121	NULL
      129	333	4	1290	127	127	2
      130	444	-4	1300	131	131	1
      139	111	2	1390	138	138	1
      143	111	2	1430	142	142	-4
      145	555	-2	1450	149	149	NULL
      151	555	1	1510	153	153	NULL
      158	555	3	1580	159	159	NULL
      160	333	-1	1600	163	163	2
      167	555	1	1670	168	168	NULL
      170	555	-2	1700	174	174	-2
      175	555	-1	358	179	179	NULL
      181	333	-3	364	182	182	3
      186	444	-1	376	188	188	-4
      194	444	1	382	191	191	-2
      198	555	3	398	199	199	-1
      206	555	-2	NULL	NULL	NULL	NULL
      211	222	-3	426	213	213	2
      218	333	3	432	216	216	-2
      223	444	-1	440	220	220	1
      228	555	3	458	229	229	-1
      232	555	1	468	234	234	3
      236	555	NULL	2360	239	239	1
      240	222	-4	486	243	243	NULL
      249	444	2	490	245	245	2
      NULL	222	NULL	402	201	201	-1
      NULL	333	NULL	NULL	115	115	-1
      NULL	555	NULL	NULL	104	104	NULL
