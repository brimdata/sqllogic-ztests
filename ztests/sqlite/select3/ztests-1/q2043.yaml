script: |
  super -f tsv -I q2043.sql | sort > q2043.out

vector: true

inputs:
  - name: q2043.sql
    data: |
      SELECT a+b*2+c*3+d*4,
      e,
      abs(b-c),
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      c-d
      FROM t1
      WHERE c>d
      ORDER BY 1,2,3,5,4;
  - name: t1

outputs:
  - name: q2043.out
    data: |
      1226	NULL	1	1240	1
      1325	132	4	1300	1
      1371	135	2	1390	1
      1411	144	2	1430	1
      1714	173	2	1700	1
      1828	180	3	364	1
      1861	189	1	376	2
      1918	192	1	382	3
      2125	210	3	426	2
      2226	221	1	440	2
      NULL	117	NULL	NULL	3
      NULL	NULL	2	NULL	1
      NULL	NULL	NULL	NULL	1
