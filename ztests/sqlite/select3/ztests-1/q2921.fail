# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q2921.sql | sort > q2921.out

inputs:
  - name: q2921.sql
    data: |
      SELECT a+b*2+c*3+d*4,
      a+b*2,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5
      FROM t1
      ORDER BY 2,1,4;

outputs:
  - name: q2921.out
    data: |
      1067	317	0	333	1050	1612
      1226	369	2	333	1240	NULL
      1272	385	3	333	1290	1902
      1325	391	4	444	1300	1985
      1371	416	5	111	1390	2046
      1411	428	6	111	1430	2131
      1622	483	10	333	1600	2432
      1714	514	12	555	1700	2579
      1828	544	14	333	364	2728
      1861	560	15	444	376	2806
      1918	579	16	444	382	2878
      1964	595	17	555	398	2949
      2125	635	19	222	426	3175
      2165	652	20	333	432	3260
      2226	666	21	444	440	3331
      2264	685	22	555	458	3399
      2323	698	23	555	468	3473
      2476	743	26	444	490	3706
      NULL	439	7	555	1450	NULL
      NULL	455	8	555	1510	NULL
      NULL	475	9	555	1580	NULL
      NULL	502	11	555	1670	NULL
      NULL	529	13	555	358	NULL
      NULL	711	24	555	2360	NULL
      NULL	723	25	222	486	NULL
      NULL	NULL	0	222	402	NULL
      NULL	NULL	0	333	NULL	NULL
      NULL	NULL	0	555	NULL	NULL
      NULL	NULL	1	555	1120	NULL
      NULL	NULL	18	555	NULL	NULL
