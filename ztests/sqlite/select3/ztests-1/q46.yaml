script: |
  super -f tsv -I q46.sql | sort > q46.out

vector: true

inputs:
  - name: q46.sql
    data: |
      SELECT a+b*2+c*3,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      c,
      (a+b+c+d+e)/5,
      d-e,
      a+b*2+c*3+d*4+e*5
      FROM t1;
  - name: t1

outputs:
  - name: q46.out
    data: |
      1000	1670	166	NULL	NULL	NULL
      1030	1700	172	172	-2	2579
      1057	358	176	NULL	NULL	NULL
      1096	364	184	182	3	2728
      1121	376	187	187	-4	2806
      1158	382	193	192	-2	2878
      1180	398	195	197	-1	2949
      1277	426	214	212	2	3175
      1297	432	215	217	-2	3260
      1338	440	224	222	1	3331
      1360	458	225	227	-1	3399
      1391	468	231	232	3	3473
      1455	486	244	NULL	NULL	NULL
      1484	490	247	247	2	3706
      635	1050	106	107	-1	1612
      738	1240	123	NULL	NULL	NULL
      760	1290	125	127	2	1902
      793	1300	134	132	1	1985
      827	1390	137	137	1	2046
      851	1430	141	142	-4	2131
      880	1450	147	NULL	NULL	NULL
      905	1510	150	NULL	NULL	NULL
      940	1580	155	NULL	NULL	NULL
      966	1600	161	162	2	2432
      NULL	1120	113	NULL	4	NULL
      NULL	2360	NULL	NULL	1	NULL
      NULL	402	202	NULL	-1	NULL
      NULL	NULL	102	NULL	NULL	NULL
      NULL	NULL	119	NULL	-1	NULL
      NULL	NULL	208	NULL	NULL	NULL
