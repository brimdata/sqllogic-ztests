script: |
  super -f tsv -I q1687.sql | sort > q1687.out

vector: true

inputs:
  - name: q1687.sql
    data: |
      SELECT a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1
      ORDER BY 2,1;
  - name: t1

outputs:
  - name: q1687.out
    data: |
      104	444
      107	333
      115	444
      121	222
      127	222
      131	333
      138	222
      142	222
      149	444
      153	333
      159	333
      163	444
      168	333
      174	444
      179	444
      182	333
      188	333
      191	222
      199	333
      201	444
      213	333
      216	222
      220	222
      229	333
      234	333
      239	444
      243	444
      245	111
      NULL	444
      NULL	444
