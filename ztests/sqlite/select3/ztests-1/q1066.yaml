script: |
  super -f tsv -I q1066.sql | sort > q1066.out

vector: true

inputs:
  - name: q1066.sql
    data: |
      SELECT e,
      c-d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1;
  - name: t1

outputs:
  - name: q1066.out
    data: |
      109	-2	333
      110	-1	444
      117	3	444
      126	-3	222
      132	1	333
      135	1	222
      144	1	222
      146	NULL	444
      157	NULL	333
      162	-3	444
      165	NULL	333
      173	1	444
      177	NULL	444
      180	1	333
      189	2	333
      192	3	222
      197	-1	333
      204	-1	444
      210	2	333
      219	-2	222
      221	2	222
      227	-1	333
      230	-2	333
      237	NULL	444
      246	-1	111
      NULL	1	222
      NULL	1	444
      NULL	1	444
      NULL	NULL	333
      NULL	NULL	444
