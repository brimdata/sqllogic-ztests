# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q262.sql | sort > q262.out

inputs:
  - name: q262.sql
    data: |
      SELECT abs(b-c),
      d-e,
      c-d,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      (a+b+c+d+e)/5
      FROM t1
      WHERE d>e
      AND c BETWEEN b-2 AND d+2;

outputs:
  - name: q262.out
    data: |
      1	1	2	224	440	21	222
      1	2	-3	161	1600	10	162
      1	3	-2	231	468	23	232
      1	4	-1	113	1120	1	NULL
      2	1	1	137	1390	5	137
      2	2	-1	247	490	26	247
      3	2	2	214	426	19	212
      3	3	1	184	364	14	182
      4	1	1	134	1300	4	132
