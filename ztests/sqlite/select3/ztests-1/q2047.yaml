script: |
  super -f tsv -I q2047.sql | sort > q2047.out

vector: true

inputs:
  - name: q2047.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      a-b,
      b-c,
      abs(b-c),
      (a+b+c+d+e)/5
      FROM t1
      WHERE (e>c OR e<d)
      ORDER BY 6,1,5,4;
  - name: t1

outputs:
  - name: q2047.out
    data: |
      1050	1067	2	-1	1	107
      1120	NULL	NULL	-1	1	NULL
      1290	1272	-2	4	4	127
      1300	1325	1	-4	4	132
      1390	1371	-1	2	2	137
      1430	1411	-1	2	2	142
      1580	NULL	1	3	3	NULL
      1600	1622	3	-1	1	162
      1700	1714	4	-2	2	172
      2360	NULL	3	NULL	NULL	NULL
      358	NULL	4	-1	1	NULL
      364	1828	1	-3	3	182
      376	1861	2	-1	1	187
      398	1964	1	3	3	197
      402	NULL	NULL	NULL	NULL	NULL
      426	2125	2	-3	3	212
      432	2165	-2	3	3	217
      440	2226	-3	-1	1	222
      458	2264	1	3	3	227
      468	2323	2	1	1	232
      490	2476	-4	2	2	247
