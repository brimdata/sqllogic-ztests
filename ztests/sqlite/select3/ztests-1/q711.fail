# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q711.sql | sort > q711.out

inputs:
  - name: q711.sql
    data: |
      SELECT d,
      c-d,
      c,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a-b
      FROM t1
      ORDER BY 2,5,3,1,4;

outputs:
  - name: q711.out
    data: |
      101	1	102	0	NULL	NULL
      108	-2	106	0	1050	2
      114	-1	113	1	1120	NULL
      116	3	119	0	NULL	NULL
      122	1	123	2	1240	-3
      128	-3	125	3	1290	-2
      133	1	134	4	1300	1
      136	1	137	5	1390	-1
      140	1	141	6	1430	-1
      164	-3	161	10	1600	3
      171	1	172	12	1700	4
      183	1	184	14	364	1
      185	2	187	15	376	2
      190	3	193	16	382	-3
      196	-1	195	17	398	1
      203	-1	202	0	402	NULL
      207	1	208	18	NULL	NULL
      212	2	214	19	426	2
      217	-2	215	20	432	-2
      222	2	224	21	440	-3
      226	-1	225	22	458	1
      233	-2	231	23	468	2
      238	NULL	NULL	24	2360	3
      248	-1	247	26	490	-4
      NULL	NULL	147	7	1450	4
      NULL	NULL	150	8	1510	2
      NULL	NULL	155	9	1580	1
      NULL	NULL	166	11	1670	1
      NULL	NULL	176	13	358	4
      NULL	NULL	244	25	486	3
