script: |
  super -f text -I q1241.spq | sort > q1241.out

inputs:
  - name: q1241.spq
    data: |
      SELECT d-e,
      a,
      a+b*2
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR (e>c OR e<d)
      OR (a>b-2 AND a<b+2)
      ORDER BY 3,1;
  - name: t1

outputs:
  - name: q1241.out
    data: |
      -	-	-
      -	121	369
      -	159	475
      -	168	502
      -	179	529
      -1	107	317
      -1	199	595
      -1	201	-
      -1	229	685
      -2	174	514
      -2	216	652
      -4	142	428
      -4	188	560
      1	131	391
      1	138	416
      1	220	666
      1	239	711
      2	127	385
      2	163	483
      2	213	635
      2	245	743
      3	182	544
      3	234	698
      4	-	-
