script: |
  super -f text -I q2678.spq | sort > q2678.out

inputs:
  - name: q2678.spq
    data: |
      SELECT b,
      a+b*2+c*3+d*4,
      d-e,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      (a+b+c+d+e)/5,
      a+b*2,
      a-b
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2;
  - name: t1

outputs:
  - name: q2678.out
    data: |
      105	1067	-1	333	107	317	2
      112	-	4	555	-	-	-
      124	1226	-	333	-	369	-3
      130	1325	1	444	132	391	1
      139	1371	1	111	137	416	-1
      143	1411	-4	111	142	428	-1
      160	1622	2	333	162	483	3
      170	1714	-2	555	172	514	4
      181	1828	3	333	182	544	1
      186	1861	-4	444	187	560	2
      206	-	-	555	-	-	-
      211	2125	2	222	212	635	2
      223	2226	1	444	222	666	-3
      232	2323	3	555	232	698	2
      249	2476	2	444	247	743	-4
