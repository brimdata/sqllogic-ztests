script: |
  super -f text -I q312.spq | sort > q312.out

inputs:
  - name: q312.spq
    data: |
      SELECT c-d,
      a+b*2+c*3+d*4,
      abs(b-c),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      abs(a)
      FROM t1 (FORMAT parquet)
      WHERE a>b
      OR (c<=d-2 OR c>=d+2)
      OR b>c;
  - name: t1

outputs:
  - name: q312.out
    data: |
      -	-	-	555	239
      -	-	1	555	153
      -	-	1	555	168
      -	-	1	555	179
      -	-	2	555	149
      -	-	3	555	159
      -	-	4	222	243
      -1	1964	3	555	199
      -1	2264	3	555	229
      -1	2476	2	444	245
      -2	1067	1	333	107
      -2	2165	3	333	216
      -2	2323	1	555	234
      -3	1272	4	333	127
      -3	1622	1	333	163
      1	1226	1	333	121
      1	1325	4	444	131
      1	1371	2	111	138
      1	1411	2	111	142
      1	1714	2	555	174
      1	1828	3	333	182
      2	1861	1	444	188
      2	2125	3	222	213
      2	2226	1	444	220
      3	-	-	333	115
      3	1918	1	444	191
