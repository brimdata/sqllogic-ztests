script: |
  super -f text -I q2702.spq | sort > q2702.out

inputs:
  - name: q2702.spq
    data: |
      SELECT e,
      d-e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b,
      a
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q2702.out
    data: |
      -	-	222	124	121
      -	-	333	151	153
      -	-	444	-	104
      -	-	444	206	-
      -	-	444	240	243
      109	-1	333	105	107
      110	4	444	112	-
      117	-1	444	-	115
      126	2	222	129	127
      132	1	333	130	131
      135	1	222	139	138
      144	-4	222	143	142
      146	-	444	145	149
      157	-	333	158	159
      162	2	444	160	163
      165	-	333	167	168
      173	-2	444	170	174
      177	-	444	175	179
      180	3	333	181	182
      189	-4	333	186	188
      192	-2	222	194	191
      197	-1	333	198	199
      204	-1	444	-	201
      210	2	333	211	213
      219	-2	222	218	216
      221	1	222	223	220
      227	-1	333	228	229
      230	3	333	232	234
      237	1	444	236	239
      246	2	111	249	245
