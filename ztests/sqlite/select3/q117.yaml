script: |
  super -f text -I q117.spq | sort > q117.out

inputs:
  - name: q117.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a-b,
      e,
      d-e,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      WHERE b>c
      ORDER BY 2,3;
  - name: t1

outputs:
  - name: q117.out
    data: |
      111	-1	135	1	2046
      111	-1	144	-4	2131
      333	-2	126	2	1902
      333	-2	219	-2	3260
      333	-3	-	-	-
      444	-3	192	-2	2878
      444	-4	246	2	3706
      555	1	157	-	-
      555	1	165	-	-
      555	1	197	-1	2949
      555	1	227	-1	3399
      555	2	-	-	-
      555	2	230	3	3473
