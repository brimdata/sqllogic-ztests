script: |
  super -f text -I q1860.spq | sort > q1860.out

inputs:
  - name: q1860.spq
    data: |
      SELECT b-c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a+b*2,
      (a+b+c+d+e)/5,
      d-e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q1860.out
    data: |
      -	222	-	-	-1	444	201
      -	333	-	-	-1	444	115
      -	555	-	-	-	444	104
      -	555	711	-	1	444	239
      -1	333	317	107	-1	333	107
      -1	333	483	162	2	444	163
      -1	444	560	187	-4	333	188
      -1	444	666	222	1	222	220
      -1	555	-	-	4	444	-
      -1	555	529	-	-	444	179
      -2	555	-	-	-	444	-
      -2	555	439	-	-	444	149
      -2	555	514	172	-2	444	174
      -3	222	635	212	2	333	213
      -3	333	544	182	3	333	182
      -4	222	723	-	-	444	243
      -4	444	391	132	1	333	131
      1	333	369	-	-	222	121
      1	444	579	192	-2	222	191
      1	555	455	-	-	333	153
      1	555	502	-	-	333	168
      1	555	698	232	3	333	234
      2	111	416	137	1	222	138
      2	111	428	142	-4	222	142
      2	444	743	247	2	111	245
      3	333	652	217	-2	222	216
      3	555	475	-	-	333	159
      3	555	595	197	-1	333	199
      3	555	685	227	-1	333	229
      4	333	385	127	2	222	127
