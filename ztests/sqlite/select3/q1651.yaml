script: |
  super -f text -I q1651.spq | sort > q1651.out

inputs:
  - name: q1651.spq
    data: |
      SELECT abs(b-c),
      a+b*2,
      abs(a),
      d-e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR a>b
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 3,4,1;
  - name: t1

outputs:
  - name: q1651.out
    data: |
      -	-	115	-1	444
      -	711	239	1	444
      1	317	107	-1	333
      1	369	121	-	222
      1	455	153	-	333
      1	483	163	2	444
      1	502	168	-	333
      1	529	179	-	444
      1	560	188	-4	333
      1	579	191	-2	222
      1	666	220	1	222
      1	698	234	3	333
      2	416	138	1	222
      2	428	142	-4	222
      2	439	149	-	444
      2	514	174	-2	444
      2	743	245	2	111
      3	475	159	-	333
      3	544	182	3	333
      3	595	199	-1	333
      3	635	213	2	333
      3	652	216	-2	222
      3	685	229	-1	333
      4	385	127	2	222
      4	391	131	1	333
      4	723	243	-	444
