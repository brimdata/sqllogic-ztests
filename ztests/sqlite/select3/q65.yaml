script: |
  super -f text -I q65.spq | sort > q65.out

inputs:
  - name: q65.spq
    data: |
      SELECT a-b,
      d,
      c-d,
      a+b*2+c*3+d*4,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR b>c
      ORDER BY 3,5,1,2;
  - name: t1

outputs:
  - name: q65.out
    data: |
      -	114	-1	-	555
      -	203	-1	-	222
      -1	136	1	1371	111
      -1	140	1	1411	111
      -2	128	-3	1272	333
      -2	217	-2	2165	333
      -3	122	1	1226	333
      -3	190	3	1918	444
      -3	222	2	2226	444
      -4	248	-1	2476	444
      1	-	-	-	555
      1	-	-	-	555
      1	133	1	1325	444
      1	183	1	1828	333
      1	196	-1	1964	555
      1	226	-1	2264	555
      2	-	-	-	555
      2	108	-2	1067	333
      2	185	2	1861	444
      2	212	2	2125	222
      2	233	-2	2323	555
      3	164	-3	1622	333
      3	238	-	-	555
      4	-	-	-	555
      4	171	1	1714	555
