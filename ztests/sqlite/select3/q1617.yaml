script: |
  super -f text -I q1617.spq | sort > q1617.out

inputs:
  - name: q1617.spq
    data: |
      SELECT d,
      a+b*2+c*3+d*4+e*5,
      a+b*2+c*3,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4,
      c-d,
      a+b*2
      FROM t1 (FORMAT parquet)
      WHERE (e>a AND e<b)
      OR (c<=d-2 OR c>=d+2)
      OR a>b
      ORDER BY 5,6,1,2,7,3,4;
  - name: t1

outputs:
  - name: q1617.out
    data: |
      -	-	1000	333	-	-	502
      -	-	1057	444	-	-	529
      -	-	1455	444	-	-	723
      -	-	880	444	-	-	439
      -	-	905	333	-	-	455
      -	-	940	333	-	-	475
      108	1612	635	333	1067	-2	317
      116	-	-	444	-	3	-
      128	1902	760	222	1272	-3	385
      133	1985	793	333	1325	1	391
      164	2432	966	444	1622	-3	483
      171	2579	1030	444	1714	1	514
      183	2728	1096	333	1828	1	544
      185	2806	1121	333	1861	2	560
      190	2878	1158	222	1918	3	579
      196	2949	1180	333	1964	-1	595
      212	3175	1277	333	2125	2	635
      217	3260	1297	222	2165	-2	652
      222	3331	1338	222	2226	2	666
      226	3399	1360	333	2264	-1	685
      233	3473	1391	333	2323	-2	698
      238	-	-	444	-	-	711
      248	3706	1484	111	2476	-1	743
