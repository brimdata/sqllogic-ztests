script: |
  super -f text -I q3216.spq | sort > q3216.out

inputs:
  - name: q3216.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b-c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q3216.out
    data: |
      -	-	-	333
      -	-	-	555
      -	-	-2	555
      -	1120	-1	555
      -	1240	1	333
      -	1450	-2	555
      -	1510	1	555
      -	1580	3	555
      -	1670	1	555
      -	2360	-	555
      -	358	-1	555
      -	402	-	222
      -	486	-4	222
      1612	1050	-1	333
      1902	1290	4	333
      1985	1300	-4	444
      2046	1390	2	111
      2131	1430	2	111
      2432	1600	-1	333
      2579	1700	-2	555
      2728	364	-3	333
      2806	376	-1	444
      2878	382	1	444
      2949	398	3	555
      3175	426	-3	222
      3260	432	3	333
      3331	440	-1	444
      3399	458	3	555
      3473	468	1	555
      3706	490	2	444
