script: |
  super -f text -I q1944.spq | sort > q1944.out

inputs:
  - name: q1944.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      a-b,
      b-c
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      OR (e>c OR e<d);
  - name: t1

outputs:
  - name: q1944.out
    data: |
      1050	1067	2	-1
      1120	-	-	-1
      1290	1272	-2	4
      1300	1325	1	-4
      1390	1371	-1	2
      1430	1411	-1	2
      1580	-	1	3
      1600	1622	3	-1
      1700	1714	4	-2
      2360	-	3	-
      358	-	4	-1
      364	1828	1	-3
      376	1861	2	-1
      398	1964	1	3
      402	-	-	-
      426	2125	2	-3
      432	2165	-2	3
      440	2226	-3	-1
      458	2264	1	3
      468	2323	2	1
      490	2476	-4	2
