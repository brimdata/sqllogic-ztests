script: |
  super -f text -I q403.spq | sort > q403.out

inputs:
  - name: q403.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      b,
      a+b*2,
      abs(a),
      a,
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR e+d BETWEEN a+b-10 AND c+130
      ORDER BY 1,7,5,6,3,4,2;
  - name: t1

outputs:
  - name: q403.out
    data: |
      1050	1067	105	317	107	107	635
      1120	-	112	-	-	-	-
      1290	1272	129	385	127	127	760
      1300	1325	130	391	131	131	793
      1390	1371	139	416	138	138	827
      1430	1411	143	428	142	142	851
      1580	-	158	475	159	159	940
      1600	1622	160	483	163	163	966
      1700	1714	170	514	174	174	1030
      2360	-	236	711	239	239	-
      358	-	175	529	179	179	1057
      364	1828	181	544	182	182	1096
      376	1861	186	560	188	188	1121
      398	1964	198	595	199	199	1180
      402	-	-	-	201	201	-
      426	2125	211	635	213	213	1277
      432	2165	218	652	216	216	1297
      440	2226	223	666	220	220	1338
      458	2264	228	685	229	229	1360
      468	2323	232	698	234	234	1391
      490	2476	249	743	245	245	1484
