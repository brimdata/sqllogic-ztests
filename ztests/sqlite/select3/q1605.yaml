script: |
  super -f text -I q1605.spq | sort > q1605.out

inputs:
  - name: q1605.spq
    data: |
      SELECT d-e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2,
      d,
      a
      FROM t1 (FORMAT parquet)
      ORDER BY 5,1;
  - name: t1

outputs:
  - name: q1605.out
    data: |
      -	-	-	101	104
      -	-	-	207	-
      -	1240	369	122	121
      -	1450	439	-	149
      -	1510	455	-	153
      -	1580	475	-	159
      -	1670	502	-	168
      -	358	529	-	179
      -	486	723	-	243
      -1	-	-	116	115
      -1	1050	317	108	107
      -1	398	595	196	199
      -1	402	-	203	201
      -1	458	685	226	229
      -2	1700	514	171	174
      -2	382	579	190	191
      -2	432	652	217	216
      -4	1430	428	140	142
      -4	376	560	185	188
      1	1300	391	133	131
      1	1390	416	136	138
      1	2360	711	238	239
      1	440	666	222	220
      2	1290	385	128	127
      2	1600	483	164	163
      2	426	635	212	213
      2	490	743	248	245
      3	364	544	183	182
      3	468	698	233	234
      4	1120	-	114	-
