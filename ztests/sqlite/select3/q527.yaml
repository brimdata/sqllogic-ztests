script: |
  super -f text -I q527.spq | sort > q527.out

inputs:
  - name: q527.spq
    data: |
      SELECT c,
      abs(b-c),
      a+b*2+c*3+d*4,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b,
      d-e,
      a+b*2
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR (e>c OR e<d)
      ORDER BY 6,2,3,4,7,1,5;
  - name: t1

outputs:
  - name: q527.out
    data: |
      -	-	-	444	3	1	711
      106	1	1067	333	2	-1	317
      113	1	-	444	-	4	-
      123	1	1226	222	-3	-	369
      125	4	1272	222	-2	2	385
      134	4	1325	333	1	1	391
      137	2	1371	222	-1	1	416
      141	2	1411	222	-1	-4	428
      155	3	-	333	1	-	475
      161	1	1622	444	3	2	483
      172	2	1714	444	4	-2	514
      176	1	-	444	4	-	529
      184	3	1828	333	1	3	544
      187	1	1861	333	2	-4	560
      195	3	1964	333	1	-1	595
      202	-	-	444	-	-1	-
      208	2	-	444	-	-	-
      214	3	2125	333	2	2	635
      215	3	2165	222	-2	-2	652
      224	1	2226	222	-3	1	666
      225	3	2264	333	1	-1	685
      231	1	2323	333	2	3	698
      247	2	2476	111	-4	2	743
