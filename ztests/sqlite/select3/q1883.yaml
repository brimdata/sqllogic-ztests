script: |
  super -f text -I q1883.spq | sort > q1883.out

inputs:
  - name: q1883.spq
    data: |
      SELECT e,
      c-d,
      (a+b+c+d+e)/5,
      abs(b-c),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      ORDER BY 2,5,3,6,7,4,1;
  - name: t1

outputs:
  - name: q1883.out
    data: |
      -	-	-	1	1510	-	333
      -	-	-	4	486	-	444
      -	1	-	-	-	-	444
      -	1	-	1	1240	-	222
      -	1	-	2	-	-	444
      109	-2	107	1	1050	1612	333
      110	-1	-	1	1120	-	444
      117	3	-	-	-	-	444
      126	-3	127	4	1290	1902	222
      132	1	132	4	1300	1985	333
      135	1	137	2	1390	2046	222
      144	1	142	2	1430	2131	222
      146	-	-	2	1450	-	444
      157	-	-	3	1580	-	333
      162	-3	162	1	1600	2432	444
      165	-	-	1	1670	-	333
      173	1	172	2	1700	2579	444
      177	-	-	1	358	-	444
      180	1	182	3	364	2728	333
      189	2	187	1	376	2806	333
      192	3	192	1	382	2878	222
      197	-1	197	3	398	2949	333
      204	-1	-	-	402	-	444
      210	2	212	3	426	3175	333
      219	-2	217	3	432	3260	222
      221	2	222	1	440	3331	222
      227	-1	227	3	458	3399	333
      230	-2	232	1	468	3473	333
      237	-	-	-	2360	-	444
      246	-1	247	2	490	3706	111
