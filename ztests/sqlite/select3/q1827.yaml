script: |
  super -f text -I q1827.spq | sort > q1827.out

inputs:
  - name: q1827.spq
    data: |
      SELECT b,
      abs(a),
      a+b*2,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d-e,
      a,
      c
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      OR d>e
      ORDER BY 5,2,1,7,3,4;
  - name: t1

outputs:
  - name: q1827.out
    data: |
      -	104	-	-	-	104	102
      -	201	-	402	-1	201	202
      105	107	317	1050	-1	107	106
      112	-	-	1120	4	-	113
      129	127	385	1290	2	127	125
      130	131	391	1300	1	131	134
      139	138	416	1390	1	138	137
      160	163	483	1600	2	163	161
      170	174	514	1700	-2	174	172
      181	182	544	364	3	182	184
      186	188	560	376	-4	188	187
      194	191	579	382	-2	191	193
      198	199	595	398	-1	199	195
      206	-	-	-	-	-	208
      211	213	635	426	2	213	214
      218	216	652	432	-2	216	215
      223	220	666	440	1	220	224
      228	229	685	458	-1	229	225
      232	234	698	468	3	234	231
      236	239	711	2360	1	239	-
      249	245	743	490	2	245	247
