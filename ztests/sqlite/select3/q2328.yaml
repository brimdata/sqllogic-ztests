script: |
  super -f text -I q2328.spq | sort > q2328.out

inputs:
  - name: q2328.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      WHERE (e>a AND e<b)
      OR a>b;
  - name: t1

outputs:
  - name: q2328.out
    data: |
      -	1450	444
      -	1510	333
      -	1580	333
      -	1670	333
      -	2360	444
      -	358	444
      -	486	444
      107	1050	333
      132	1300	333
      162	1600	444
      172	1700	444
      182	364	333
      187	376	333
      192	382	222
      197	398	333
      212	426	333
      222	440	222
      227	458	333
      232	468	333
      247	490	111
