script: |
  super -f text -I q430.spq | sort > q430.out

inputs:
  - name: q430.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      (a+b+c+d+e)/5,
      abs(a),
      abs(b-c),
      c-d
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q430.out
    data: |
      -	-	333	-	115	-	3
      -	-	555	-	-	2	1
      -	-	555	-	104	-	1
      1050	317	333	107	107	1	-2
      1120	-	555	-	-	1	-1
      1240	369	333	-	121	1	1
      1290	385	333	127	127	4	-3
      1300	391	444	132	131	4	1
      1390	416	111	137	138	2	1
      1430	428	111	142	142	2	1
      1450	439	555	-	149	2	-
      1510	455	555	-	153	1	-
      1580	475	555	-	159	3	-
      1600	483	333	162	163	1	-3
      1670	502	555	-	168	1	-
      1700	514	555	172	174	2	1
      2360	711	555	-	239	-	-
      358	529	555	-	179	1	-
      364	544	333	182	182	3	1
      376	560	444	187	188	1	2
      382	579	444	192	191	1	3
      398	595	555	197	199	3	-1
      402	-	222	-	201	-	-1
      426	635	222	212	213	3	2
      432	652	333	217	216	3	-2
      440	666	444	222	220	1	2
      458	685	555	227	229	3	-1
      468	698	555	232	234	1	-2
      486	723	222	-	243	4	-
      490	743	444	247	245	2	-1
