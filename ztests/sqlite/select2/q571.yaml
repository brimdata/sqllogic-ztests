script: |
  super -f text -I q571.spq | sort > q571.out

inputs:
  - name: q571.spq
    data: |
      SELECT e,
      a+b*2,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q571.out
    data: |
      -	-	444	-
      -	-	444	-
      -	369	222	-
      -	455	333	-
      -	723	444	-
      109	317	333	1612
      110	-	444	-
      117	-	444	-
      126	385	222	1902
      132	391	333	1985
      135	416	222	2046
      144	428	222	2131
      146	439	444	-
      157	475	333	-
      162	483	444	2432
      165	502	333	-
      173	514	444	2579
      177	529	444	-
      180	544	333	2728
      189	560	333	2806
      192	579	222	2878
      197	595	333	2949
      204	-	444	-
      210	635	333	3175
      219	652	222	3260
      221	666	222	3331
      227	685	333	3399
      230	698	333	3473
      237	711	444	-
      246	743	111	3706
