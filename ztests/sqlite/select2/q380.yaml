script: |
  super -f text -I q380.spq | sort > q380.out

inputs:
  - name: q380.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      e,
      d,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      OR (e>a AND e<b)
      OR b IS NOT NULL;
  - name: t1

outputs:
  - name: q380.out
    data: |
      -	-	-	207	-
      -	-	117	116	-
      -	1120	110	114	-
      -	1240	-	122	1226
      -	1450	146	-	-
      -	1510	-	-	-
      -	1580	157	-	-
      -	1670	165	-	-
      -	2360	237	238	-
      -	358	177	-	-
      -	486	-	-	-
      1612	1050	109	108	1067
      1902	1290	126	128	1272
      1985	1300	132	133	1325
      2046	1390	135	136	1371
      2131	1430	144	140	1411
      2432	1600	162	164	1622
      2579	1700	173	171	1714
      2728	364	180	183	1828
      2806	376	189	185	1861
      2878	382	192	190	1918
      2949	398	197	196	1964
      3175	426	210	212	2125
      3260	432	219	217	2165
      3331	440	221	222	2226
      3399	458	227	226	2264
      3473	468	230	233	2323
      3706	490	246	248	2476
