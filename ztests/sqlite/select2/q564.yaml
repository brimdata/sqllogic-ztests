script: |
  super -f text -I q564.spq | sort > q564.out

inputs:
  - name: q564.spq
    data: |
      SELECT a,
      d-e,
      e,
      a+b*2+c*3,
      abs(b-c),
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR c>d;
  - name: t1

outputs:
  - name: q564.out
    data: |
      -	-	-	-	2	208	-
      104	-	-	-	-	102	-
      115	-1	117	-	-	119	-
      121	-	-	738	1	123	1240
      131	1	132	793	4	134	1300
      138	1	135	827	2	137	1390
      142	-4	144	851	2	141	1430
      159	-	157	940	3	155	1580
      168	-	165	1000	1	166	1670
      174	-2	173	1030	2	172	1700
      182	3	180	1096	3	184	364
      188	-4	189	1121	1	187	376
      191	-2	192	1158	1	193	382
      199	-1	197	1180	3	195	398
      213	2	210	1277	3	214	426
      220	1	221	1338	1	224	440
      229	-1	227	1360	3	225	458
