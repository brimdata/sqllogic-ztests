script: |
  super -f text -I q339.spq | sort > q339.out

inputs:
  - name: q339.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      a+b*2,
      d-e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(a),
      a
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q339.out
    data: |
      -	-	-	-	-	-
      -	-	-	-	104	104
      -	-	-1	-	115	115
      -	-	-1	402	201	201
      -	-	4	1120	-	-
      -	439	-	1450	149	149
      -	455	-	1510	153	153
      -	475	-	1580	159	159
      -	502	-	1670	168	168
      -	529	-	358	179	179
      -	711	1	2360	239	239
      -	723	-	486	243	243
      1067	317	-1	1050	107	107
      1226	369	-	1240	121	121
      1272	385	2	1290	127	127
      1325	391	1	1300	131	131
      1371	416	1	1390	138	138
      1411	428	-4	1430	142	142
      1622	483	2	1600	163	163
      1714	514	-2	1700	174	174
      1828	544	3	364	182	182
      1861	560	-4	376	188	188
      1918	579	-2	382	191	191
      1964	595	-1	398	199	199
      2125	635	2	426	213	213
      2165	652	-2	432	216	216
      2226	666	1	440	220	220
      2264	685	-1	458	229	229
      2323	698	3	468	234	234
      2476	743	2	490	245	245
