script: |
  super -f text -I q750.spq | sort > q750.out

inputs:
  - name: q750.spq
    data: |
      SELECT b,
      b-c,
      e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a
      FROM t1 (FORMAT parquet)
      WHERE a IS NULL
      OR (c<=d-2 OR c>=d+2);
  - name: t1

outputs:
  - name: q750.out
    data: |
      -	-	117	444	-	115
      105	-1	109	333	1050	107
      112	-1	110	444	1120	-
      129	4	126	222	1290	127
      160	-1	162	444	1600	163
      186	-1	189	333	376	188
      194	1	192	222	382	191
      206	-2	-	444	-	-
      211	-3	210	333	426	213
      218	3	219	222	432	216
      223	-1	221	222	440	220
      232	1	230	333	468	234
