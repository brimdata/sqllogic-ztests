script: |
  super -f text -I q861.spq | sort > q861.out

inputs:
  - name: q861.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      a+b*2+c*3+d*4+e*5,
      a,
      (a+b+c+d+e)/5,
      e,
      d
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q861.out
    data: |
      -	-	-	-	-	-	207
      -	-	-	104	-	-	101
      -	-	-	115	-	117	116
      1050	1067	1612	107	107	109	108
      1120	-	-	-	-	110	114
      1240	1226	-	121	-	-	122
      1290	1272	1902	127	127	126	128
      1300	1325	1985	131	132	132	133
      1390	1371	2046	138	137	135	136
      1430	1411	2131	142	142	144	140
      1450	-	-	149	-	146	-
      1510	-	-	153	-	-	-
      1580	-	-	159	-	157	-
      1600	1622	2432	163	162	162	164
      1670	-	-	168	-	165	-
      1700	1714	2579	174	172	173	171
      2360	-	-	239	-	237	238
      358	-	-	179	-	177	-
      364	1828	2728	182	182	180	183
      376	1861	2806	188	187	189	185
      382	1918	2878	191	192	192	190
      398	1964	2949	199	197	197	196
      402	-	-	201	-	204	203
      426	2125	3175	213	212	210	212
      432	2165	3260	216	217	219	217
      440	2226	3331	220	222	221	222
      458	2264	3399	229	227	227	226
      468	2323	3473	234	232	230	233
      486	-	-	243	-	-	-
      490	2476	3706	245	247	246	248
