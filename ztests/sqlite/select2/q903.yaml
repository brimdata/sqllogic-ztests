script: |
  super -f text -I q903.spq | sort > q903.out

inputs:
  - name: q903.spq
    data: |
      SELECT d-e,
      a-b,
      c,
      c-d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q903.out
    data: |
      -	-	102	1	555
      -	-	208	1	555
      -	-3	123	1	333
      -	1	155	-	555
      -	1	166	-	555
      -	2	150	-	555
      -	3	244	-	222
      -	4	147	-	555
      -	4	176	-	555
      -1	-	119	3	333
      -1	-	202	-1	222
      -1	1	195	-1	555
      -1	1	225	-1	555
      -1	2	106	-2	333
      -2	-2	215	-2	333
      -2	-3	193	3	444
      -2	4	172	1	555
      -4	-1	141	1	111
      -4	2	187	2	444
      1	-1	137	1	111
      1	-3	224	2	444
      1	1	134	1	444
      1	3	-	-	555
      2	-2	125	-3	333
      2	-4	247	-1	444
      2	2	214	2	222
      2	3	161	-3	333
      3	1	184	1	333
      3	2	231	-2	555
      4	-	113	-1	555
