script: |
  super -f text -I q417.spq | sort > q417.out

inputs:
  - name: q417.spq
    data: |
      SELECT a,
      c-d,
      b,
      a+b*2,
      b-c,
      a-b
      FROM t1 (FORMAT parquet)
      WHERE b IS NOT NULL
      AND b>c;
  - name: t1

outputs:
  - name: q417.out
    data: |
      121	1	124	369	1	-3
      127	-3	129	385	4	-2
      138	1	139	416	2	-1
      142	1	143	428	2	-1
      153	-	151	455	1	2
      159	-	158	475	3	1
      168	-	167	502	1	1
      191	3	194	579	1	-3
      199	-1	198	595	3	1
      216	-2	218	652	3	-2
      229	-1	228	685	3	1
      234	-2	232	698	1	2
      245	-1	249	743	2	-4
