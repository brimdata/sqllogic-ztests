script: |
  super -f text -I q874.spq | sort > q874.out

inputs:
  - name: q874.spq
    data: |
      SELECT e,
      b-c,
      abs(b-c),
      abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      OR (e>a AND e<b);
  - name: t1

outputs:
  - name: q874.out
    data: |
      109	-1	1	107	1050	108
      126	4	4	127	1290	128
      192	1	1	191	382	190
      221	-1	1	220	440	222
      246	2	2	245	490	248
