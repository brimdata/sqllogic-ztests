script: |
  super -f text -I q303.spq | sort > q303.out

inputs:
  - name: q303.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b-c,
      d,
      abs(b-c),
      e,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q303.out
    data: |
      111	2	136	2	135	2046
      111	2	140	2	144	2131
      222	-	203	-	204	-
      222	-3	212	3	210	3175
      222	-4	-	4	-	-
      333	-	116	-	117	-
      333	-1	108	1	109	1612
      333	-1	164	1	162	2432
      333	-3	183	3	180	2728
      333	1	122	1	-	-
      333	3	217	3	219	3260
      333	4	128	4	126	1902
      444	-1	185	1	189	2806
      444	-1	222	1	221	3331
      444	-4	133	4	132	1985
      444	1	190	1	192	2878
      444	2	248	2	246	3706
      555	-	101	-	-	-
      555	-	238	-	237	-
      555	-1	-	1	177	-
      555	-1	114	1	110	-
      555	-2	-	2	146	-
      555	-2	171	2	173	2579
      555	-2	207	2	-	-
      555	1	-	1	-	-
      555	1	-	1	165	-
      555	1	233	1	230	3473
      555	3	-	3	157	-
      555	3	196	3	197	2949
      555	3	226	3	227	3399
