script: |
  super -f text -I q351.spq | sort > q351.out

inputs:
  - name: q351.spq
    data: |
      SELECT a+b*2+c*3,
      a+b*2+c*3+d*4+e*5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE d>e
      AND coalesce(a,b,c,d,e)<>0;
  - name: t1

outputs:
  - name: q351.out
    data: |
      -	-	555
      -	-	555
      1096	2728	333
      1277	3175	222
      1338	3331	444
      1391	3473	555
      1484	3706	444
      760	1902	333
      793	1985	444
      827	2046	111
      966	2432	333
