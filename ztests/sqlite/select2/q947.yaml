script: |
  super -f text -I q947.spq | sort > q947.out

inputs:
  - name: q947.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2,
      (a+b+c+d+e)/5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE a>b
      OR c BETWEEN b-2 AND d+2
      OR e+d BETWEEN a+b-10 AND c+130;
  - name: t1

outputs:
  - name: q947.out
    data: |
      111	743	247	444	-4	490
      222	369	-	333	-3	1240
      222	385	127	333	-2	1290
      222	416	137	111	-1	1390
      222	428	142	111	-1	1430
      222	666	222	444	-3	440
      333	317	107	333	2	1050
      333	391	132	444	1	1300
      333	455	-	555	2	1510
      333	475	-	555	1	1580
      333	502	-	555	1	1670
      333	544	182	333	1	364
      333	560	187	444	2	376
      333	595	197	555	1	398
      333	635	212	222	2	426
      333	685	227	555	1	458
      333	698	232	555	2	468
      444	-	-	555	-	-
      444	-	-	555	-	1120
      444	439	-	555	4	1450
      444	483	162	333	3	1600
      444	514	172	555	4	1700
      444	529	-	555	4	358
      444	711	-	555	3	2360
      444	723	-	222	3	486
