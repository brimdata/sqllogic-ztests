script: |
  super -f text -I q902.spq | sort > q902.out

inputs:
  - name: q902.spq
    data: |
      SELECT abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      e
      FROM t1 (FORMAT parquet)
      WHERE b IS NOT NULL;
  - name: t1

outputs:
  - name: q902.out
    data: |
      -	-	-
      -	1120	110
      107	1050	109
      121	1240	-
      127	1290	126
      131	1300	132
      138	1390	135
      142	1430	144
      149	1450	146
      153	1510	-
      159	1580	157
      163	1600	162
      168	1670	165
      174	1700	173
      179	358	177
      182	364	180
      188	376	189
      191	382	192
      199	398	197
      213	426	210
      216	432	219
      220	440	221
      229	458	227
      234	468	230
      239	2360	237
      243	486	-
      245	490	246
