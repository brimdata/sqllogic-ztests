script: |
  super -f text -I q37.spq | sort > q37.out

inputs:
  - name: q37.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(a),
      a+b*2+c*3+d*4+e*5,
      a-b,
      a+b*2,
      c
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q37.out
    data: |
      -	-	-	-	-	208
      -	104	-	-	-	102
      -	115	-	-	-	119
      1050	107	1612	2	317	106
      1120	-	-	-	-	113
      1240	121	-	-3	369	123
      1290	127	1902	-2	385	125
      1300	131	1985	1	391	134
      1390	138	2046	-1	416	137
      1430	142	2131	-1	428	141
      1450	149	-	4	439	147
      1510	153	-	2	455	150
      1580	159	-	1	475	155
      1600	163	2432	3	483	161
      1670	168	-	1	502	166
      1700	174	2579	4	514	172
      2360	239	-	3	711	-
      358	179	-	4	529	176
      364	182	2728	1	544	184
      376	188	2806	2	560	187
      382	191	2878	-3	579	193
      398	199	2949	1	595	195
      402	201	-	-	-	202
      426	213	3175	2	635	214
      432	216	3260	-2	652	215
      440	220	3331	-3	666	224
      458	229	3399	1	685	225
      468	234	3473	2	698	231
      486	243	-	3	723	244
      490	245	3706	-4	743	247
