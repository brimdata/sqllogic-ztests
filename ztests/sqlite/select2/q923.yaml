script: |
  super -f text -I q923.spq | sort > q923.out

inputs:
  - name: q923.spq
    data: |
      SELECT abs(b-c),
      d,
      abs(a),
      a-b,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      c-d,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR c>d;
  - name: t1

outputs:
  - name: q923.out
    data: |
      -	101	104	-	555	1	-
      -	116	115	-	333	3	-
      1	-	153	2	555	-	1510
      1	-	168	1	555	-	1670
      1	122	121	-3	333	1	1240
      1	185	188	2	444	2	376
      1	190	191	-3	444	3	382
      1	222	220	-3	444	2	440
      1	233	234	2	555	-2	468
      2	136	138	-1	111	1	1390
      2	140	142	-1	111	1	1430
      2	171	174	4	555	1	1700
      2	207	-	-	555	1	-
      2	248	245	-4	444	-1	490
      3	-	159	1	555	-	1580
      3	183	182	1	333	1	364
      3	196	199	1	555	-1	398
      3	212	213	2	222	2	426
      3	217	216	-2	333	-2	432
      3	226	229	1	555	-1	458
      4	128	127	-2	333	-3	1290
      4	133	131	1	444	1	1300
