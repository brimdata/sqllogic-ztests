script: |
  super -f tsv -I q727.sql | sort > q727.out

vector: true

inputs:
  - name: q727.sql
    data: |
      SELECT d-e,
      a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2,
      abs(b-c),
      c-d
      FROM t1
      WHERE (e>a AND e<b)
      OR a IS NULL
      OR c>d;
  - name: t1

outputs:
  - name: q727.out
    data: |
      -1	NULL	NULL	NULL	NULL	3
      -2	-3	382	579	1	3
      -2	4	1700	514	2	1
      -4	-1	1430	428	2	1
      -4	2	376	560	1	2
      1	-1	1390	416	2	1
      1	-3	440	666	1	2
      1	1	1300	391	4	1
      2	-4	490	743	2	-1
      2	2	426	635	3	2
      3	1	364	544	3	1
      4	NULL	1120	NULL	1	-1
      NULL	-3	1240	369	1	1
      NULL	NULL	NULL	NULL	2	1
      NULL	NULL	NULL	NULL	NULL	1
