# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q258.sql | sort > q258.out

inputs:
  - name: q258.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      c,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      abs(b-c),
      (a+b+c+d+e)/5
      FROM t1
      WHERE d>e
      OR (c<=d-2 OR c>=d+2);
  - name: t1

outputs:
  - name: q258.out
    data: |
      1050	106	0	1	107
      1120	113	1	1	NULL
      1290	125	3	4	127
      1300	134	4	4	132
      1390	137	5	2	137
      1600	161	10	1	162
      2360	NULL	24	NULL	NULL
      364	184	14	3	182
      376	187	15	1	187
      382	193	16	1	192
      426	214	19	3	212
      432	215	20	3	217
      440	224	21	1	222
      468	231	23	1	232
      490	247	26	2	247
      NULL	119	0	NULL	NULL
