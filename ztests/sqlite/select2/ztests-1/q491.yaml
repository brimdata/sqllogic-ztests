script: |
  super -f tsv -I q491.sql | sort > q491.out

vector: true

inputs:
  - name: q491.sql
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      c-d,
      abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      b-c,
      a-b,
      b
      FROM t1
      WHERE a>b
      OR (a>b-2 AND a<b+2)
      OR d>e;
  - name: t1

outputs:
  - name: q491.out
    data: |
      111	1	138	1390	2	-1	139
      111	1	142	1430	2	-1	143
      222	2	213	426	-3	2	211
      222	NULL	243	486	-4	3	240
      333	-2	107	1050	-1	2	105
      333	-3	127	1290	4	-2	129
      333	-3	163	1600	-1	3	160
      333	1	182	364	-3	1	181
      444	-1	245	490	2	-4	249
      444	1	131	1300	-4	1	130
      444	2	188	376	-1	2	186
      444	2	220	440	-1	-3	223
      555	-1	199	398	3	1	198
      555	-1	229	458	3	1	228
      555	-1	NULL	1120	-1	NULL	112
      555	-2	234	468	1	2	232
      555	1	174	1700	-2	4	170
      555	NULL	149	1450	-2	4	145
      555	NULL	153	1510	1	2	151
      555	NULL	159	1580	3	1	158
      555	NULL	168	1670	1	1	167
      555	NULL	179	358	-1	4	175
      555	NULL	239	2360	NULL	3	236
