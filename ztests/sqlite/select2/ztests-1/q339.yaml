script: |
  super -f tsv -I q339.sql | sort > q339.out

vector: true

inputs:
  - name: q339.sql
    data: |
      SELECT a+b*2+c*3+d*4,
      a+b*2,
      d-e,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      abs(a),
      a
      FROM t1;
  - name: t1

outputs:
  - name: q339.out
    data: |
      1067	317	-1	1050	107	107
      1226	369	NULL	1240	121	121
      1272	385	2	1290	127	127
      1325	391	1	1300	131	131
      1371	416	1	1390	138	138
      1411	428	-4	1430	142	142
      1622	483	2	1600	163	163
      1714	514	-2	1700	174	174
      1828	544	3	364	182	182
      1861	560	-4	376	188	188
      1918	579	-2	382	191	191
      1964	595	-1	398	199	199
      2125	635	2	426	213	213
      2165	652	-2	432	216	216
      2226	666	1	440	220	220
      2264	685	-1	458	229	229
      2323	698	3	468	234	234
      2476	743	2	490	245	245
      NULL	439	NULL	1450	149	149
      NULL	455	NULL	1510	153	153
      NULL	475	NULL	1580	159	159
      NULL	502	NULL	1670	168	168
      NULL	529	NULL	358	179	179
      NULL	711	1	2360	239	239
      NULL	723	NULL	486	243	243
      NULL	NULL	-1	402	201	201
      NULL	NULL	-1	NULL	115	115
      NULL	NULL	4	1120	NULL	NULL
      NULL	NULL	NULL	NULL	104	104
      NULL	NULL	NULL	NULL	NULL	NULL
