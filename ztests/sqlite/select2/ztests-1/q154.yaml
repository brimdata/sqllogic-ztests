script: |
  super -f tsv -I q154.sql | sort > q154.out

vector: true

inputs:
  - name: q154.sql
    data: |
      SELECT (a+b+c+d+e)/5,
      c-d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a,
      c
      FROM t1
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q154.out
    data: |
      107	-2	333	1050	107	106
      127	-3	222	1290	127	125
      132	1	333	1300	131	134
      137	1	222	1390	138	137
      142	1	222	1430	142	141
      162	-3	444	1600	163	161
      172	1	444	1700	174	172
      182	1	333	364	182	184
      187	2	333	376	188	187
      197	-1	333	398	199	195
      212	2	333	426	213	214
      217	-2	222	432	216	215
      222	2	222	440	220	224
      227	-1	333	458	229	225
      232	-2	333	468	234	231
      247	-1	111	490	245	247
      NULL	-1	444	1120	NULL	113
      NULL	-1	444	402	201	202
      NULL	NULL	333	1580	159	155
      NULL	NULL	444	2360	239	NULL
      NULL	NULL	444	358	179	176
