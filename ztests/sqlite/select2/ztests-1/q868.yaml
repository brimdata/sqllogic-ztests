script: |
  super -f tsv -I q868.sql | sort > q868.out

vector: true

inputs:
  - name: q868.sql
    data: |
      SELECT a+b*2,
      abs(b-c),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      (a+b+c+d+e)/5
      FROM t1;
  - name: t1

outputs:
  - name: q868.out
    data: |
      317	1	333	108	107
      369	1	222	122	NULL
      385	4	222	128	127
      391	4	333	133	132
      416	2	222	136	137
      428	2	222	140	142
      439	2	444	NULL	NULL
      455	1	333	NULL	NULL
      475	3	333	NULL	NULL
      483	1	444	164	162
      502	1	333	NULL	NULL
      514	2	444	171	172
      529	1	444	NULL	NULL
      544	3	333	183	182
      560	1	333	185	187
      579	1	222	190	192
      595	3	333	196	197
      635	3	333	212	212
      652	3	222	217	217
      666	1	222	222	222
      685	3	333	226	227
      698	1	333	233	232
      711	NULL	444	238	NULL
      723	4	444	NULL	NULL
      743	2	111	248	247
      NULL	1	444	114	NULL
      NULL	2	444	207	NULL
      NULL	NULL	444	101	NULL
      NULL	NULL	444	116	NULL
      NULL	NULL	444	203	NULL
