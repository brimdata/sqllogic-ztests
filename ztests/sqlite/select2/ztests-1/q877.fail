# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q877.sql | sort > q877.out

inputs:
  - name: q877.sql
    data: |
      SELECT abs(b-c),
      e,
      a+b*2,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a),
      c-d,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b)
      FROM t1;

outputs:
  - name: q877.out
    data: |
      1	109	317	333	107	-2	0
      1	110	NULL	444	NULL	-1	1
      1	162	483	444	163	-3	10
      1	165	502	333	168	NULL	11
      1	177	529	444	179	NULL	13
      1	189	560	333	188	2	15
      1	192	579	222	191	3	16
      1	221	666	222	220	2	21
      1	230	698	333	234	-2	23
      1	NULL	369	222	121	1	2
      1	NULL	455	333	153	NULL	8
      2	135	416	222	138	1	5
      2	144	428	222	142	1	6
      2	146	439	444	149	NULL	7
      2	173	514	444	174	1	12
      2	246	743	111	245	-1	26
      2	NULL	NULL	444	NULL	1	18
      3	157	475	333	159	NULL	9
      3	180	544	333	182	1	14
      3	197	595	333	199	-1	17
      3	210	635	333	213	2	19
      3	219	652	222	216	-2	20
      3	227	685	333	229	-1	22
      4	126	385	222	127	-3	3
      4	132	391	333	131	1	4
      4	NULL	723	444	243	NULL	25
      NULL	117	NULL	444	115	3	0
      NULL	204	NULL	444	201	-1	0
      NULL	237	711	444	239	NULL	24
      NULL	NULL	NULL	444	104	1	0
