script: |
  super -f tsv -I q627.sql | sort > q627.out

vector: true

inputs:
  - name: q627.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      c-d,
      d-e,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1;
  - name: t1

outputs:
  - name: q627.out
    data: |
      1050	-2	-1	333	333
      1120	-1	4	555	444
      1240	1	NULL	333	222
      1290	-3	2	333	222
      1300	1	1	444	333
      1390	1	1	111	222
      1430	1	-4	111	222
      1450	NULL	NULL	555	444
      1510	NULL	NULL	555	333
      1580	NULL	NULL	555	333
      1600	-3	2	333	444
      1670	NULL	NULL	555	333
      1700	1	-2	555	444
      2360	NULL	1	555	444
      358	NULL	NULL	555	444
      364	1	3	333	333
      376	2	-4	444	333
      382	3	-2	444	222
      398	-1	-1	555	333
      402	-1	-1	222	444
      426	2	2	222	333
      432	-2	-2	333	222
      440	2	1	444	222
      458	-1	-1	555	333
      468	-2	3	555	333
      486	NULL	NULL	222	444
      490	-1	2	444	111
      NULL	1	NULL	555	444
      NULL	1	NULL	555	444
      NULL	3	-1	333	444
