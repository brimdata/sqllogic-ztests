# Failed due to: https://github.com/brimdata/super/issues/6549
script: |
  super -f tsv -I q77.sql | sort > q77.out

vector: true

inputs:
  - name: q77.sql
    data: |
      SELECT (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      c-d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4+e*5,
      a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      b
      FROM t1;
  - name: t1

outputs:
  - name: q77.out
    data: |
      0	-1	444	NULL	NULL	402	NULL
      0	-2	333	1612	2	1050	105
      0	1	444	NULL	NULL	NULL	NULL
      0	3	444	NULL	NULL	NULL	NULL
      1	-1	444	NULL	NULL	1120	112
      10	-3	444	2432	3	1600	160
      11	NULL	333	NULL	1	1670	167
      12	1	444	2579	4	1700	170
      13	NULL	444	NULL	4	358	175
      14	1	333	2728	1	364	181
      15	2	333	2806	2	376	186
      16	3	222	2878	-3	382	194
      17	-1	333	2949	1	398	198
      18	1	444	NULL	NULL	NULL	206
      19	2	333	3175	2	426	211
      2	1	222	NULL	-3	1240	124
      20	-2	222	3260	-2	432	218
      21	2	222	3331	-3	440	223
      22	-1	333	3399	1	458	228
      23	-2	333	3473	2	468	232
      24	NULL	444	NULL	3	2360	236
      25	NULL	444	NULL	3	486	240
      26	-1	111	3706	-4	490	249
      3	-3	222	1902	-2	1290	129
      4	1	333	1985	1	1300	130
      5	1	222	2046	-1	1390	139
      6	1	222	2131	-1	1430	143
      7	NULL	444	NULL	4	1450	145
      8	NULL	333	NULL	2	1510	151
      9	NULL	333	NULL	1	1580	158
