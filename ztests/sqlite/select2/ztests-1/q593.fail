# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q593.sql | sort > q593.out

inputs:
  - name: q593.sql
    data: |
      SELECT abs(b-c),
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      abs(a),
      (SELECT count(*) FROM t1 AS x WHERE x.c>t1.c AND x.d<t1.d),
      a-b,
      c,
      a
      FROM t1;

outputs:
  - name: q593.out
    data: |
      1	1050	107	0	2	106	107
      1	1120	NULL	0	NULL	113	NULL
      1	1240	121	0	-3	123	121
      1	1510	153	0	2	150	153
      1	1600	163	0	3	161	163
      1	1670	168	0	1	166	168
      1	358	179	0	4	176	179
      1	376	188	0	2	187	188
      1	382	191	0	-3	193	191
      1	440	220	0	-3	224	220
      1	468	234	0	2	231	234
      2	1390	138	0	-1	137	138
      2	1430	142	0	-1	141	142
      2	1450	149	0	4	147	149
      2	1700	174	0	4	172	174
      2	490	245	0	-4	247	245
      2	NULL	NULL	0	NULL	208	NULL
      3	1580	159	0	1	155	159
      3	364	182	0	1	184	182
      3	398	199	0	1	195	199
      3	426	213	0	2	214	213
      3	432	216	0	-2	215	216
      3	458	229	0	1	225	229
      4	1290	127	0	-2	125	127
      4	1300	131	0	1	134	131
      4	486	243	0	3	244	243
      NULL	2360	239	0	3	NULL	239
      NULL	402	201	0	NULL	202	201
      NULL	NULL	104	0	NULL	102	104
      NULL	NULL	115	0	NULL	119	115
