# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q216.sql | sort > q216.out

inputs:
  - name: q216.sql
    data: |
      SELECT c-d,
      abs(b-c),
      b,
      abs(a),
      a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b)
      FROM t1;

outputs:
  - name: q216.out
    data: |
      -1	1	112	NULL	NULL	444	1
      -1	2	249	245	245	111	26
      -1	3	198	199	199	333	17
      -1	3	228	229	229	333	22
      -1	NULL	NULL	201	201	444	0
      -2	1	105	107	107	333	0
      -2	1	232	234	234	333	23
      -2	3	218	216	216	222	20
      -3	1	160	163	163	444	10
      -3	4	129	127	127	222	3
      1	1	124	121	121	222	2
      1	2	139	138	138	222	5
      1	2	143	142	142	222	6
      1	2	170	174	174	444	12
      1	2	206	NULL	NULL	444	18
      1	3	181	182	182	333	14
      1	4	130	131	131	333	4
      1	NULL	NULL	104	104	444	0
      2	1	186	188	188	333	15
      2	1	223	220	220	222	21
      2	3	211	213	213	333	19
      3	1	194	191	191	222	16
      3	NULL	NULL	115	115	444	0
      NULL	1	151	153	153	333	8
      NULL	1	167	168	168	333	11
      NULL	1	175	179	179	444	13
      NULL	2	145	149	149	444	7
      NULL	3	158	159	159	333	9
      NULL	4	240	243	243	444	25
      NULL	NULL	236	239	239	444	24
