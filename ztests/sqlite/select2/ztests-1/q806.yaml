script: |
  super -f tsv -I q806.sql | sort > q806.out

vector: true

inputs:
  - name: q806.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      c,
      d,
      b
      FROM t1
      WHERE b IS NOT NULL
      AND c BETWEEN b-2 AND d+2;
  - name: t1

outputs:
  - name: q806.out
    data: |
      1050	1067	106	108	105
      1120	NULL	113	114	112
      1240	1226	123	122	124
      1300	1325	134	133	130
      1390	1371	137	136	139
      1430	1411	141	140	143
      1600	1622	161	164	160
      1700	1714	172	171	170
      364	1828	184	183	181
      376	1861	187	185	186
      426	2125	214	212	211
      440	2226	224	222	223
      468	2323	231	233	232
      490	2476	247	248	249
      NULL	NULL	208	207	206
