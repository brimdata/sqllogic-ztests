script: |
  super -f tsv -I q799.sql | sort > q799.out

vector: true

inputs:
  - name: q799.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a-b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1
      WHERE c BETWEEN b-2 AND d+2
      OR a>b;
  - name: t1

outputs:
  - name: q799.out
    data: |
      1050	2	333
      1120	NULL	444
      1240	-3	222
      1300	1	333
      1390	-1	222
      1430	-1	222
      1450	4	444
      1510	2	333
      1580	1	333
      1600	3	444
      1670	1	333
      1700	4	444
      2360	3	444
      358	4	444
      364	1	333
      376	2	333
      398	1	333
      426	2	333
      440	-3	222
      458	1	333
      468	2	333
      486	3	444
      490	-4	111
      NULL	NULL	444
