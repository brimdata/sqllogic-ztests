script: |
  super -f tsv -I q362.sql | sort > q362.out

vector: true

inputs:
  - name: q362.sql
    data: |
      SELECT c-d,
      abs(a),
      a+b*2+c*3,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END
      FROM t1;
  - name: t1

outputs:
  - name: q362.out
    data: |
      -1	199	1180	333	398
      -1	201	NULL	444	402
      -1	229	1360	333	458
      -1	245	1484	111	490
      -1	NULL	NULL	444	1120
      -2	107	635	333	1050
      -2	216	1297	222	432
      -2	234	1391	333	468
      -3	127	760	222	1290
      -3	163	966	444	1600
      1	104	NULL	444	NULL
      1	121	738	222	1240
      1	131	793	333	1300
      1	138	827	222	1390
      1	142	851	222	1430
      1	174	1030	444	1700
      1	182	1096	333	364
      1	NULL	NULL	444	NULL
      2	188	1121	333	376
      2	213	1277	333	426
      2	220	1338	222	440
      3	115	NULL	444	NULL
      3	191	1158	222	382
      NULL	149	880	444	1450
      NULL	153	905	333	1510
      NULL	159	940	333	1580
      NULL	168	1000	333	1670
      NULL	179	1057	444	358
      NULL	239	NULL	444	2360
      NULL	243	1455	444	486
