script: |
  super -f tsv -I q319.sql | sort > q319.out

vector: true

inputs:
  - name: q319.sql
    data: |
      SELECT c-d,
      a-b,
      (a+b+c+d+e)/5,
      b-c,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1;
  - name: t1

outputs:
  - name: q319.out
    data: |
      -1	-4	247	2	111
      -1	1	197	3	333
      -1	1	227	3	333
      -1	NULL	NULL	-1	444
      -1	NULL	NULL	NULL	444
      -2	-2	217	3	222
      -2	2	107	-1	333
      -2	2	232	1	333
      -3	-2	127	4	222
      -3	3	162	-1	444
      1	-1	137	2	222
      1	-1	142	2	222
      1	-3	NULL	1	222
      1	1	132	-4	333
      1	1	182	-3	333
      1	4	172	-2	444
      1	NULL	NULL	-2	444
      1	NULL	NULL	NULL	444
      2	-3	222	-1	222
      2	2	187	-1	333
      2	2	212	-3	333
      3	-3	192	1	222
      3	NULL	NULL	NULL	444
      NULL	1	NULL	1	333
      NULL	1	NULL	3	333
      NULL	2	NULL	1	333
      NULL	3	NULL	-4	444
      NULL	3	NULL	NULL	444
      NULL	4	NULL	-1	444
      NULL	4	NULL	-2	444
