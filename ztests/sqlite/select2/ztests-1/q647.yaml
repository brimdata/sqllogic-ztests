script: |
  super -f tsv -I q647.sql | sort > q647.out

vector: true

inputs:
  - name: q647.sql
    data: |
      SELECT c,
      abs(b-c),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      c-d,
      a+b*2
      FROM t1
      WHERE (c<=d-2 OR c>=d+2)
      OR c>d
      OR a IS NULL;
  - name: t1

outputs:
  - name: q647.out
    data: |
      102	NULL	555	1	NULL
      106	1	333	-2	317
      113	1	555	-1	NULL
      119	NULL	333	3	NULL
      123	1	333	1	369
      125	4	333	-3	385
      134	4	444	1	391
      137	2	111	1	416
      141	2	111	1	428
      161	1	333	-3	483
      172	2	555	1	514
      184	3	333	1	544
      187	1	444	2	560
      193	1	444	3	579
      208	2	555	1	NULL
      214	3	222	2	635
      215	3	333	-2	652
      224	1	444	2	666
      231	1	555	-2	698
