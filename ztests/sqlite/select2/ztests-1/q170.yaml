script: |
  super -f tsv -I q170.sql | sort > q170.out

vector: true

inputs:
  - name: q170.sql
    data: |
      SELECT a-b,
      b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a),
      a+b*2
      FROM t1;
  - name: t1

outputs:
  - name: q170.out
    data: |
      -1	139	222	138	416
      -1	143	222	142	428
      -2	129	222	127	385
      -2	218	222	216	652
      -3	124	222	121	369
      -3	194	222	191	579
      -3	223	222	220	666
      -4	249	111	245	743
      1	130	333	131	391
      1	158	333	159	475
      1	167	333	168	502
      1	181	333	182	544
      1	198	333	199	595
      1	228	333	229	685
      2	105	333	107	317
      2	151	333	153	455
      2	186	333	188	560
      2	211	333	213	635
      2	232	333	234	698
      3	160	444	163	483
      3	236	444	239	711
      3	240	444	243	723
      4	145	444	149	439
      4	170	444	174	514
      4	175	444	179	529
      NULL	112	444	NULL	NULL
      NULL	206	444	NULL	NULL
      NULL	NULL	444	104	NULL
      NULL	NULL	444	115	NULL
      NULL	NULL	444	201	NULL
