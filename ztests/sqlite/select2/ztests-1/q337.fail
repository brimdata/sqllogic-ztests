# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q337.sql | sort > q337.out

inputs:
  - name: q337.sql
    data: |
      SELECT a+b*2+c*3,
      a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      abs(a),
      b,
      (SELECT count(*) FROM t1 AS x WHERE x.c>t1.c AND x.d<t1.d)
      FROM t1
      WHERE (a>b-2 AND a<b+2)
      OR d>e
      OR a>b;
  - name: t1

outputs:
  - name: q337.out
    data: |
      1000	NULL	1670	168	167	0
      1030	1714	1700	174	170	0
      1057	NULL	358	179	175	0
      1096	1828	364	182	181	0
      1121	1861	376	188	186	0
      1180	1964	398	199	198	0
      1277	2125	426	213	211	0
      1338	2226	440	220	223	0
      1360	2264	458	229	228	0
      1391	2323	468	234	232	0
      1455	NULL	486	243	240	0
      1484	2476	490	245	249	0
      635	1067	1050	107	105	0
      760	1272	1290	127	129	0
      793	1325	1300	131	130	0
      827	1371	1390	138	139	0
      851	1411	1430	142	143	0
      880	NULL	1450	149	145	0
      905	NULL	1510	153	151	0
      940	NULL	1580	159	158	0
      966	1622	1600	163	160	0
      NULL	NULL	1120	NULL	112	0
      NULL	NULL	2360	239	236	0
