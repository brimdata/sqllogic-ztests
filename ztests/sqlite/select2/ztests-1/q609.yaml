script: |
  super -f tsv -I q609.sql | sort > q609.out

vector: true

inputs:
  - name: q609.sql
    data: |
      SELECT a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      b,
      d,
      c-d,
      a+b*2
      FROM t1
      WHERE a>b
      OR (c<=d-2 OR c>=d+2)
      OR a IS NULL;
  - name: t1

outputs:
  - name: q609.out
    data: |
      1067	1050	105	108	-2	317
      1272	1290	129	128	-3	385
      1325	1300	130	133	1	391
      1622	1600	160	164	-3	483
      1714	1700	170	171	1	514
      1828	364	181	183	1	544
      1861	376	186	185	2	560
      1918	382	194	190	3	579
      1964	398	198	196	-1	595
      2125	426	211	212	2	635
      2165	432	218	217	-2	652
      2226	440	223	222	2	666
      2264	458	228	226	-1	685
      2323	468	232	233	-2	698
      NULL	1120	112	114	-1	NULL
      NULL	1450	145	NULL	NULL	439
      NULL	1510	151	NULL	NULL	455
      NULL	1580	158	NULL	NULL	475
      NULL	1670	167	NULL	NULL	502
      NULL	2360	236	238	NULL	711
      NULL	358	175	NULL	NULL	529
      NULL	486	240	NULL	NULL	723
      NULL	NULL	206	207	1	NULL
      NULL	NULL	NULL	116	3	NULL
