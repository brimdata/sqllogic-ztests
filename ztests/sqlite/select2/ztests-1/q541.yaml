script: |
  super -f tsv -I q541.sql | sort > q541.out

vector: true

inputs:
  - name: q541.sql
    data: |
      SELECT a-b,
      c,
      b,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3
      FROM t1;
  - name: t1

outputs:
  - name: q541.out
    data: |
      -1	137	139	1390	827
      -1	141	143	1430	851
      -2	125	129	1290	760
      -2	215	218	432	1297
      -3	123	124	1240	738
      -3	193	194	382	1158
      -3	224	223	440	1338
      -4	247	249	490	1484
      1	134	130	1300	793
      1	155	158	1580	940
      1	166	167	1670	1000
      1	184	181	364	1096
      1	195	198	398	1180
      1	225	228	458	1360
      2	106	105	1050	635
      2	150	151	1510	905
      2	187	186	376	1121
      2	214	211	426	1277
      2	231	232	468	1391
      3	161	160	1600	966
      3	244	240	486	1455
      3	NULL	236	2360	NULL
      4	147	145	1450	880
      4	172	170	1700	1030
      4	176	175	358	1057
      NULL	102	NULL	NULL	NULL
      NULL	113	112	1120	NULL
      NULL	119	NULL	NULL	NULL
      NULL	202	NULL	402	NULL
      NULL	208	206	NULL	NULL
