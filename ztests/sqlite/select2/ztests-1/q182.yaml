script: |
  super -f tsv -I q182.sql | sort > q182.out

vector: true

inputs:
  - name: q182.sql
    data: |
      SELECT d-e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3,
      a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      abs(b-c)
      FROM t1
      WHERE coalesce(a,b,c,d,e)<>0
      OR c BETWEEN b-2 AND d+2
      OR (c<=d-2 OR c>=d+2);
  - name: t1

outputs:
  - name: q182.out
    data: |
      -1	333	1180	1	398	3
      -1	333	1360	1	458	3
      -1	333	635	2	1050	1
      -1	444	NULL	NULL	402	NULL
      -1	444	NULL	NULL	NULL	NULL
      -2	222	1158	-3	382	1
      -2	222	1297	-2	432	3
      -2	444	1030	4	1700	2
      -4	222	851	-1	1430	2
      -4	333	1121	2	376	1
      1	222	1338	-3	440	1
      1	222	827	-1	1390	2
      1	333	793	1	1300	4
      1	444	NULL	3	2360	NULL
      2	111	1484	-4	490	2
      2	222	760	-2	1290	4
      2	333	1277	2	426	3
      2	444	966	3	1600	1
      3	333	1096	1	364	3
      3	333	1391	2	468	1
      4	444	NULL	NULL	1120	1
      NULL	222	738	-3	1240	1
      NULL	333	1000	1	1670	1
      NULL	333	905	2	1510	1
      NULL	333	940	1	1580	3
      NULL	444	1057	4	358	1
      NULL	444	1455	3	486	4
      NULL	444	880	4	1450	2
      NULL	444	NULL	NULL	NULL	2
      NULL	444	NULL	NULL	NULL	NULL
