script: |
  super -f tsv -I q245.sql | sort > q245.out

vector: true

inputs:
  - name: q245.sql
    data: |
      SELECT a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5
      FROM t1;
  - name: t1

outputs:
  - name: q245.out
    data: |
      1067	1050	1612
      1226	1240	NULL
      1272	1290	1902
      1325	1300	1985
      1371	1390	2046
      1411	1430	2131
      1622	1600	2432
      1714	1700	2579
      1828	364	2728
      1861	376	2806
      1918	382	2878
      1964	398	2949
      2125	426	3175
      2165	432	3260
      2226	440	3331
      2264	458	3399
      2323	468	3473
      2476	490	3706
      NULL	1120	NULL
      NULL	1450	NULL
      NULL	1510	NULL
      NULL	1580	NULL
      NULL	1670	NULL
      NULL	2360	NULL
      NULL	358	NULL
      NULL	402	NULL
      NULL	486	NULL
      NULL	NULL	NULL
      NULL	NULL	NULL
      NULL	NULL	NULL
