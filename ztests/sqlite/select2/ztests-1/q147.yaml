script: |
  super -f tsv -I q147.sql | sort > q147.out

vector: true

inputs:
  - name: q147.sql
    data: |
      SELECT a,
      d,
      a-b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1;
  - name: t1

outputs:
  - name: q147.out
    data: |
      104	101	NULL	444
      107	108	2	333
      115	116	NULL	444
      121	122	-3	222
      127	128	-2	222
      131	133	1	333
      138	136	-1	222
      142	140	-1	222
      149	NULL	4	444
      153	NULL	2	333
      159	NULL	1	333
      163	164	3	444
      168	NULL	1	333
      174	171	4	444
      179	NULL	4	444
      182	183	1	333
      188	185	2	333
      191	190	-3	222
      199	196	1	333
      201	203	NULL	444
      213	212	2	333
      216	217	-2	222
      220	222	-3	222
      229	226	1	333
      234	233	2	333
      239	238	3	444
      243	NULL	3	444
      245	248	-4	111
      NULL	114	NULL	444
      NULL	207	NULL	444
