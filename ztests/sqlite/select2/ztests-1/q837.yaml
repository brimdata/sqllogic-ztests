script: |
  super -f tsv -I q837.sql | sort > q837.out

vector: true

inputs:
  - name: q837.sql
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      a+b*2+c*3+d*4+e*5
      FROM t1;
  - name: t1

outputs:
  - name: q837.out
    data: |
      1050	107	1612
      1120	NULL	NULL
      1240	NULL	NULL
      1290	127	1902
      1300	132	1985
      1390	137	2046
      1430	142	2131
      1450	NULL	NULL
      1510	NULL	NULL
      1580	NULL	NULL
      1600	162	2432
      1670	NULL	NULL
      1700	172	2579
      2360	NULL	NULL
      358	NULL	NULL
      364	182	2728
      376	187	2806
      382	192	2878
      398	197	2949
      402	NULL	NULL
      426	212	3175
      432	217	3260
      440	222	3331
      458	227	3399
      468	232	3473
      486	NULL	NULL
      490	247	3706
      NULL	NULL	NULL
      NULL	NULL	NULL
      NULL	NULL	NULL
