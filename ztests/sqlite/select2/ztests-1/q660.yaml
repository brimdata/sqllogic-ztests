script: |
  super -f tsv -I q660.sql | sort > q660.out

vector: true

inputs:
  - name: q660.sql
    data: |
      SELECT a+b*2+c*3,
      a+b*2+c*3+d*4,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      abs(a)
      FROM t1;
  - name: t1

outputs:
  - name: q660.out
    data: |
      1000	NULL	333	555	168
      1030	1714	444	555	174
      1057	NULL	444	555	179
      1096	1828	333	333	182
      1121	1861	333	444	188
      1158	1918	222	444	191
      1180	1964	333	555	199
      1277	2125	333	222	213
      1297	2165	222	333	216
      1338	2226	222	444	220
      1360	2264	333	555	229
      1391	2323	333	555	234
      1455	NULL	444	222	243
      1484	2476	111	444	245
      635	1067	333	333	107
      738	1226	222	333	121
      760	1272	222	333	127
      793	1325	333	444	131
      827	1371	222	111	138
      851	1411	222	111	142
      880	NULL	444	555	149
      905	NULL	333	555	153
      940	NULL	333	555	159
      966	1622	444	333	163
      NULL	NULL	444	222	201
      NULL	NULL	444	333	115
      NULL	NULL	444	555	104
      NULL	NULL	444	555	239
      NULL	NULL	444	555	NULL
      NULL	NULL	444	555	NULL
