# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q852.sql | sort > q852.out

inputs:
  - name: q852.sql
    data: |
      SELECT (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b,
      c
      FROM t1;
  - name: t1

outputs:
  - name: q852.out
    data: |
      0	333	2	106
      0	444	NULL	102
      0	444	NULL	119
      0	444	NULL	202
      1	444	NULL	113
      10	444	3	161
      11	333	1	166
      12	444	4	172
      13	444	4	176
      14	333	1	184
      15	333	2	187
      16	222	-3	193
      17	333	1	195
      18	444	NULL	208
      19	333	2	214
      2	222	-3	123
      20	222	-2	215
      21	222	-3	224
      22	333	1	225
      23	333	2	231
      24	444	3	NULL
      25	444	3	244
      26	111	-4	247
      3	222	-2	125
      4	333	1	134
      5	222	-1	137
      6	222	-1	141
      7	444	4	147
      8	333	2	150
      9	333	1	155
