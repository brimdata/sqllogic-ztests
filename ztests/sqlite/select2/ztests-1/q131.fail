# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q131.sql | sort > q131.out

inputs:
  - name: q131.sql
    data: |
      SELECT c,
      b,
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3,
      e,
      (SELECT count(*) FROM t1 AS x WHERE x.b<t1.b)
      FROM t1;
  - name: t1

outputs:
  - name: q131.out
    data: |
      102	NULL	NULL	NULL	NULL	0
      106	105	1050	635	109	0
      113	112	1120	NULL	110	1
      119	NULL	NULL	NULL	117	0
      123	124	1240	738	NULL	2
      125	129	1290	760	126	3
      134	130	1300	793	132	4
      137	139	1390	827	135	5
      141	143	1430	851	144	6
      147	145	1450	880	146	7
      150	151	1510	905	NULL	8
      155	158	1580	940	157	9
      161	160	1600	966	162	10
      166	167	1670	1000	165	11
      172	170	1700	1030	173	12
      176	175	358	1057	177	13
      184	181	364	1096	180	14
      187	186	376	1121	189	15
      193	194	382	1158	192	16
      195	198	398	1180	197	17
      202	NULL	402	NULL	204	0
      208	206	NULL	NULL	NULL	18
      214	211	426	1277	210	19
      215	218	432	1297	219	20
      224	223	440	1338	221	21
      225	228	458	1360	227	22
      231	232	468	1391	230	23
      244	240	486	1455	NULL	25
      247	249	490	1484	246	26
      NULL	236	2360	NULL	237	24
