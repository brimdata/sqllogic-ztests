# Failed due to: https://github.com/brimdata/super/issues/6013
script: |
  super -f tsv -I q299.sql | sort > q299.out

vector: true

inputs:
  - name: q299.sql
    data: |
      SELECT (SELECT count(*) FROM t1 AS x WHERE x.c>t1.c AND x.d<t1.d),
      CASE WHEN c>(SELECT avg(c) FROM t1) THEN a*2 ELSE b*10 END,
      a+b*2+c*3,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      e,
      b-c,
      c-d
      FROM t1
      WHERE EXISTS(SELECT 1 FROM t1 AS x WHERE x.b<t1.b)
      OR c BETWEEN b-2 AND d+2;
  - name: t1

outputs:
  - name: q299.out
    data: |
      0	1050	635	333	109	-1	-2
      0	1120	NULL	555	110	-1	-1
      0	1240	738	333	NULL	1	1
      0	1290	760	333	126	4	-3
      0	1300	793	444	132	-4	1
      0	1390	827	111	135	2	1
      0	1430	851	111	144	2	1
      0	1450	880	555	146	-2	NULL
      0	1510	905	555	NULL	1	NULL
      0	1580	940	555	157	3	NULL
      0	1600	966	333	162	-1	-3
      0	1670	1000	555	165	1	NULL
      0	1700	1030	555	173	-2	1
      0	2360	NULL	555	237	NULL	NULL
      0	358	1057	555	177	-1	NULL
      0	364	1096	333	180	-3	1
      0	376	1121	444	189	-1	2
      0	382	1158	444	192	1	3
      0	398	1180	555	197	3	-1
      0	426	1277	222	210	-3	2
      0	432	1297	333	219	3	-2
      0	440	1338	444	221	-1	2
      0	458	1360	555	227	3	-1
      0	468	1391	555	230	1	-2
      0	486	1455	222	NULL	-4	NULL
      0	490	1484	444	246	2	-1
      0	NULL	NULL	555	NULL	-2	1
