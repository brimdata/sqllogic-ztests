script: |
  super -f text -I q446.spq | sort > q446.out

inputs:
  - name: q446.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      c,
      a+b*2,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q446.out
    data: |
      111	247	743	2476
      222	123	369	1226
      222	125	385	1272
      222	137	416	1371
      222	141	428	1411
      222	193	579	1918
      222	215	652	2165
      222	224	666	2226
      333	106	317	1067
      333	134	391	1325
      333	150	455	-
      333	155	475	-
      333	166	502	-
      333	184	544	1828
      333	187	560	1861
      333	195	595	1964
      333	214	635	2125
      333	225	685	2264
      333	231	698	2323
      444	-	711	-
      444	102	-	-
      444	113	-	-
      444	119	-	-
      444	147	439	-
      444	161	483	1622
      444	172	514	1714
      444	176	529	-
      444	202	-	-
      444	208	-	-
      444	244	723	-
