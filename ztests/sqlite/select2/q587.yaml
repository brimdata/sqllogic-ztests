script: |
  super -f text -I q587.spq | sort > q587.out

inputs:
  - name: q587.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4+e*5,
      b,
      abs(b-c),
      abs(a)
      FROM t1 (FORMAT parquet)
      WHERE b IS NOT NULL
      OR (a>b-2 AND a<b+2)
      OR (e>a AND e<b);
  - name: t1

outputs:
  - name: q587.out
    data: |
      111	3706	249	2	245
      222	-	124	1	121
      222	1902	129	4	127
      222	2046	139	2	138
      222	2131	143	2	142
      222	2878	194	1	191
      222	3260	218	3	216
      222	3331	223	1	220
      333	-	151	1	153
      333	-	158	3	159
      333	-	167	1	168
      333	1612	105	1	107
      333	1985	130	4	131
      333	2728	181	3	182
      333	2806	186	1	188
      333	2949	198	3	199
      333	3175	211	3	213
      333	3399	228	3	229
      333	3473	232	1	234
      444	-	112	1	-
      444	-	145	2	149
      444	-	175	1	179
      444	-	206	2	-
      444	-	236	-	239
      444	-	240	4	243
      444	2432	160	1	163
      444	2579	170	2	174
