script: |
  super -f text -I q356.spq | sort > q356.out

inputs:
  - name: q356.spq
    data: |
      SELECT c-d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      d,
      a-b
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q356.out
    data: |
      -	222	-	3
      -	555	-	1
      -	555	-	1
      -	555	-	2
      -	555	-	4
      -	555	-	4
      -	555	238	3
      -1	222	203	-
      -1	444	248	-4
      -1	555	114	-
      -1	555	196	1
      -1	555	226	1
      -2	333	108	2
      -2	333	217	-2
      -2	555	233	2
      -3	333	128	-2
      -3	333	164	3
      1	111	136	-1
      1	111	140	-1
      1	333	122	-3
      1	333	183	1
      1	444	133	1
      1	555	101	-
      1	555	171	4
      1	555	207	-
      2	222	212	2
      2	444	185	2
      2	444	222	-3
      3	333	116	-
      3	444	190	-3
