script: |
  super -f text -I q896.spq | sort > q896.out

inputs:
  - name: q896.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      d,
      (a+b+c+d+e)/5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE b>c;
  - name: t1

outputs:
  - name: q896.out
    data: |
      111	136	137	1390
      111	140	142	1430
      333	122	-	1240
      333	128	127	1290
      333	217	217	432
      444	190	192	382
      444	248	247	490
      555	-	-	1510
      555	-	-	1580
      555	-	-	1670
      555	196	197	398
      555	226	227	458
      555	233	232	468
