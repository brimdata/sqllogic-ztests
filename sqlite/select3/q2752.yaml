vector: true

script: |
  super -f text -I q2752.spq | sort > q2752.out

inputs:
  - name: q2752.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      a+b*2+c*3,
      abs(b-c),
      d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE a>b
      OR (c<=d-2 OR c>=d+2);
  - name: t1

outputs:
  - name: q2752.out
    data: |
      -	-	-	-	-	116	333
      -	1450	-	880	2	-	555
      -	1510	-	905	1	-	555
      -	1580	-	940	3	-	555
      -	1670	-	1000	1	-	555
      -	2360	-	-	-	238	555
      -	358	-	1057	1	-	555
      -	486	-	1455	4	-	222
      1067	1050	107	635	1	108	333
      1272	1290	127	760	4	128	333
      1325	1300	132	793	4	133	444
      1622	1600	162	966	1	164	333
      1714	1700	172	1030	2	171	555
      1828	364	182	1096	3	183	333
      1861	376	187	1121	1	185	444
      1918	382	192	1158	1	190	444
      1964	398	197	1180	3	196	555
      2125	426	212	1277	3	212	222
      2165	432	217	1297	3	217	333
      2226	440	222	1338	1	222	444
      2264	458	227	1360	3	226	555
      2323	468	232	1391	1	233	555
