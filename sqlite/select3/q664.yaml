script: |
  super -f text -I q664.spq | sort > q664.out

inputs:
  - name: q664.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      a,
      abs(b-c),
      c,
      b,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q664.out
    data: |
      -	-	1	113	112	555	-
      -	-	2	208	206	555	-
      -	104	-	102	-	555	-
      -	115	-	119	-	333	-
      -	121	1	123	124	333	-
      -	149	2	147	145	555	-
      -	153	1	150	151	555	-
      -	159	3	155	158	555	-
      -	168	1	166	167	555	-
      -	179	1	176	175	555	-
      -	201	-	202	-	222	-
      -	239	-	-	236	555	-
      -	243	4	244	240	222	-
      1612	107	1	106	105	333	107
      1902	127	4	125	129	333	127
      1985	131	4	134	130	444	132
      2046	138	2	137	139	111	137
      2131	142	2	141	143	111	142
      2432	163	1	161	160	333	162
      2579	174	2	172	170	555	172
      2728	182	3	184	181	333	182
      2806	188	1	187	186	444	187
      2878	191	1	193	194	444	192
      2949	199	3	195	198	555	197
      3175	213	3	214	211	222	212
      3260	216	3	215	218	333	217
      3331	220	1	224	223	444	222
      3399	229	3	225	228	555	227
      3473	234	1	231	232	555	232
      3706	245	2	247	249	444	247
