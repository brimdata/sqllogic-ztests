vector: true

script: |
  super -f text -I q1742.spq | sort > q1742.out

inputs:
  - name: q1742.spq
    data: |
      SELECT b-c,
      abs(a),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      e
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      OR a>b
      OR d>e;
  - name: t1

outputs:
  - name: q1742.out
    data: |
      -	239	555	3	2360	-	237
      -1	-	555	-	1120	-	110
      -1	107	333	2	1050	1067	109
      -1	163	333	3	1600	1622	162
      -1	179	555	4	358	-	177
      -1	188	444	2	376	1861	189
      -1	220	444	-3	440	2226	221
      -2	149	555	4	1450	-	146
      -2	174	555	4	1700	1714	173
      -3	182	333	1	364	1828	180
      -3	213	222	2	426	2125	210
      -4	131	444	1	1300	1325	132
      -4	243	222	3	486	-	-
      1	153	555	2	1510	-	-
      1	168	555	1	1670	-	165
      1	234	555	2	468	2323	230
      2	138	111	-1	1390	1371	135
      2	245	444	-4	490	2476	246
      3	159	555	1	1580	-	157
      3	199	555	1	398	1964	197
      3	229	555	1	458	2264	227
      4	127	333	-2	1290	1272	126
