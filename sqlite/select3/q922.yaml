vector: true

script: |
  super -f text -I q922.spq | sort > q922.out

inputs:
  - name: q922.spq
    data: |
      SELECT a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      e,
      a+b*2+c*3+d*4+e*5,
      a-b
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q922.out
    data: |
      -	444	-	-	-
      -	444	110	-	-
      104	444	-	-	-
      107	333	109	1612	2
      115	444	117	-	-
      121	222	-	-	-3
      127	222	126	1902	-2
      131	333	132	1985	1
      138	222	135	2046	-1
      142	222	144	2131	-1
      149	444	146	-	4
      153	333	-	-	2
      159	333	157	-	1
      163	444	162	2432	3
      168	333	165	-	1
      174	444	173	2579	4
      179	444	177	-	4
      182	333	180	2728	1
      188	333	189	2806	2
      191	222	192	2878	-3
      199	333	197	2949	1
      201	444	204	-	-
      213	333	210	3175	2
      216	222	219	3260	-2
      220	222	221	3331	-3
      229	333	227	3399	1
      234	333	230	3473	2
      239	444	237	-	3
      243	444	-	-	3
      245	111	246	3706	-4
