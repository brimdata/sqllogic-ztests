vector: true

script: |
  super -f text -I q2694.spq | sort > q2694.out

inputs:
  - name: q2694.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q2694.out
    data: |
      111	245
      222	121
      222	127
      222	138
      222	142
      222	191
      222	216
      222	220
      333	107
      333	131
      333	153
      333	159
      333	168
      333	182
      333	188
      333	199
      333	213
      333	229
      333	234
      444	-
      444	-
      444	104
      444	115
      444	149
      444	163
      444	174
      444	179
      444	201
      444	239
      444	243
