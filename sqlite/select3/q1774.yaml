script: |
  super -f text -I q1774.spq | sort > q1774.out

inputs:
  - name: q1774.spq
    data: |
      SELECT c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR d NOT BETWEEN 110 AND 150
      OR (e>a AND e<b);
  - name: t1

outputs:
  - name: q1774.out
    data: |
      -	2360	-	-
      102	-	-	1
      106	1050	1067	-2
      113	1120	-	-1
      125	1290	1272	-3
      134	1300	1325	1
      137	1390	1371	1
      141	1430	1411	1
      155	1580	-	-
      161	1600	1622	-3
      172	1700	1714	1
      176	358	-	-
      184	364	1828	1
      187	376	1861	2
      193	382	1918	3
      195	398	1964	-1
      202	402	-	-1
      208	-	-	1
      214	426	2125	2
      215	432	2165	-2
      224	440	2226	2
      225	458	2264	-1
      231	468	2323	-2
      247	490	2476	-1
