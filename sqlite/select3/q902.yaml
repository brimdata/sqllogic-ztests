vector: true

script: |
  super -f text -I q902.spq | sort > q902.out

inputs:
  - name: q902.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      e,
      a+b*2,
      d-e
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q902.out
    data: |
      111	246	743	2
      222	-	369	-
      222	126	385	2
      222	135	416	1
      222	144	428	-4
      222	192	579	-2
      222	219	652	-2
      222	221	666	1
      333	-	455	-
      333	109	317	-1
      333	132	391	1
      333	157	475	-
      333	165	502	-
      333	180	544	3
      333	189	560	-4
      333	197	595	-1
      333	210	635	2
      333	227	685	-1
      333	230	698	3
      444	-	-	-
      444	-	-	-
      444	-	723	-
      444	110	-	4
      444	117	-	-1
      444	146	439	-
      444	162	483	2
      444	173	514	-2
      444	177	529	-
      444	204	-	-1
      444	237	711	1
