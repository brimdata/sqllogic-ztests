vector: true

script: |
  super -f text -I q349.spq | sort > q349.out

inputs:
  - name: q349.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      b-c,
      a,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      c-d,
      d-e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR e+d BETWEEN a+b-10 AND c+130
      ORDER BY 4,2,6,3,5,7,1;
  - name: t1

outputs:
  - name: q349.out
    data: |
      -	-	201	222	-1	-1	402
      -	-	239	555	-	1	2360
      -	-1	-	555	-1	4	1120
      -	-1	179	555	-	-	358
      -	3	159	555	-	-	1580
      1612	-1	107	333	-2	-1	1050
      1902	4	127	333	-3	2	1290
      1985	-4	131	444	1	1	1300
      2046	2	138	111	1	1	1390
      2131	2	142	111	1	-4	1430
      2432	-1	163	333	-3	2	1600
      2579	-2	174	555	1	-2	1700
      2728	-3	182	333	1	3	364
      2806	-1	188	444	2	-4	376
      2949	3	199	555	-1	-1	398
      3175	-3	213	222	2	2	426
      3260	3	216	333	-2	-2	432
      3331	-1	220	444	2	1	440
      3399	3	229	555	-1	-1	458
      3473	1	234	555	-2	3	468
      3706	2	245	444	-1	2	490
