vector: true

script: |
  super -f text -I q2657.spq | sort > q2657.out

inputs:
  - name: q2657.spq
    data: |
      SELECT d,
      c-d,
      a+b*2+c*3,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      ORDER BY 2,5,6,3,1;
  - name: t1

outputs:
  - name: q2657.out
    data: |
      -	-	1000	166	1670	-
      -	-	1057	176	358	-
      -	-	1455	244	486	-
      -	-	880	147	1450	-
      -	-	905	150	1510	-
      -	-	940	155	1580	-
      101	1	-	102	-	-
      108	-2	635	106	1050	1612
      114	-1	-	113	1120	-
      116	3	-	119	-	-
      122	1	738	123	1240	-
      128	-3	760	125	1290	1902
      133	1	793	134	1300	1985
      136	1	827	137	1390	2046
      140	1	851	141	1430	2131
      164	-3	966	161	1600	2432
      171	1	1030	172	1700	2579
      183	1	1096	184	364	2728
      185	2	1121	187	376	2806
      190	3	1158	193	382	2878
      196	-1	1180	195	398	2949
      203	-1	-	202	402	-
      207	1	-	208	-	-
      212	2	1277	214	426	3175
      217	-2	1297	215	432	3260
      222	2	1338	224	440	3331
      226	-1	1360	225	458	3399
      233	-2	1391	231	468	3473
      238	-	-	-	2360	-
      248	-1	1484	247	490	3706
