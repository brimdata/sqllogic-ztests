vector: true

script: |
  super -f text -I q1783.spq | sort > q1783.out

inputs:
  - name: q1783.spq
    data: |
      SELECT abs(a),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      ORDER BY 1,2,3;
  - name: t1

outputs:
  - name: q1783.out
    data: |
      -	444	-
      -	444	1120
      104	444	-
      107	333	1050
      115	444	-
      121	222	1240
      127	222	1290
      131	333	1300
      138	222	1390
      142	222	1430
      149	444	1450
      153	333	1510
      159	333	1580
      163	444	1600
      168	333	1670
      174	444	1700
      179	444	358
      182	333	364
      188	333	376
      191	222	382
      199	333	398
      201	444	402
      213	333	426
      216	222	432
      220	222	440
      229	333	458
      234	333	468
      239	444	2360
      243	444	486
      245	111	490
