vector: true

script: |
  super -f text -I q1405.spq | sort > q1405.out

inputs:
  - name: q1405.spq
    data: |
      SELECT abs(a),
      b-c,
      a,
      d-e,
      a+b*2,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      ORDER BY 5,4,3,6,2,1;
  - name: t1

outputs:
  - name: q1405.out
    data: |
      -	-2	-	-	-	-
      104	-	104	-	-	-
      107	-1	107	-1	317	1050
      163	-1	163	2	483	1600
      174	-2	174	-2	514	1700
      182	-3	182	3	544	364
      188	-1	188	-4	560	376
      191	1	191	-2	579	382
      199	3	199	-1	595	398
      201	-	201	-1	-	402
      213	-3	213	2	635	426
      216	3	216	-2	652	432
      220	-1	220	1	666	440
      229	3	229	-1	685	458
      234	1	234	3	698	468
      239	-	239	1	711	2360
      245	2	245	2	743	490
