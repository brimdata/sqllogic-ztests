vector: true

script: |
  super -f text -I q2219.spq | sort > q2219.out

inputs:
  - name: q2219.spq
    data: |
      SELECT a+b*2+c*3,
      abs(b-c),
      e,
      (a+b+c+d+e)/5,
      b,
      d,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR a>b
      ORDER BY 2,6,3,1,5,4,7;
  - name: t1

outputs:
  - name: q2219.out
    data: |
      -	-	237	-	236	238	-
      1000	1	165	-	167	-	-
      1030	2	173	172	170	171	1
      1057	1	177	-	175	-	-
      1096	3	180	182	181	183	1
      1121	1	189	187	186	185	2
      1180	3	197	197	198	196	-1
      1277	3	210	212	211	212	2
      1360	3	227	227	228	226	-1
      1391	1	230	232	232	233	-2
      1455	4	-	-	240	-	-
      635	1	109	107	105	108	-2
      793	4	132	132	130	133	1
      827	2	135	137	139	136	1
      851	2	144	142	143	140	1
      880	2	146	-	145	-	-
      905	1	-	-	151	-	-
      940	3	157	-	158	-	-
      966	1	162	162	160	164	-3
