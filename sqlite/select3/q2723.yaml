vector: true

script: |
  super -f text -I q2723.spq | sort > q2723.out

inputs:
  - name: q2723.spq
    data: |
      SELECT e,
      a+b*2,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      abs(b-c)
      FROM t1 (FORMAT parquet)
      ORDER BY 1,3,5,6,4,2;
  - name: t1

outputs:
  - name: q2723.out
    data: |
      -	-	444	-	555	-
      -	-	444	-	555	2
      -	369	222	-3	333	1
      -	455	333	2	555	1
      -	723	444	3	222	4
      109	317	333	2	333	1
      110	-	444	-	555	1
      117	-	444	-	333	-
      126	385	222	-2	333	4
      132	391	333	1	444	4
      135	416	222	-1	111	2
      144	428	222	-1	111	2
      146	439	444	4	555	2
      157	475	333	1	555	3
      162	483	444	3	333	1
      165	502	333	1	555	1
      173	514	444	4	555	2
      177	529	444	4	555	1
      180	544	333	1	333	3
      189	560	333	2	444	1
      192	579	222	-3	444	1
      197	595	333	1	555	3
      204	-	444	-	222	-
      210	635	333	2	222	3
      219	652	222	-2	333	3
      221	666	222	-3	444	1
      227	685	333	1	555	3
      230	698	333	2	555	1
      237	711	444	3	555	-
      246	743	111	-4	444	2
