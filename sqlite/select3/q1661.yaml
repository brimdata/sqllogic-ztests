script: |
  super -f text -I q1661.spq | sort > q1661.out

inputs:
  - name: q1661.spq
    data: |
      SELECT a+b*2,
      abs(a),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4,
      b-c,
      b
      FROM t1 (FORMAT parquet)
      ORDER BY 6,3,5,2,1;
  - name: t1

outputs:
  - name: q1661.out
    data: |
      -	-	444	-	-1	112
      -	-	444	-	-2	206
      -	104	444	-	-	-
      -	115	444	-	-	-
      -	201	444	-	-	-
      317	107	333	1067	-1	105
      369	121	222	1226	1	124
      385	127	222	1272	4	129
      391	131	333	1325	-4	130
      416	138	222	1371	2	139
      428	142	222	1411	2	143
      439	149	444	-	-2	145
      455	153	333	-	1	151
      475	159	333	-	3	158
      483	163	444	1622	-1	160
      502	168	333	-	1	167
      514	174	444	1714	-2	170
      529	179	444	-	-1	175
      544	182	333	1828	-3	181
      560	188	333	1861	-1	186
      579	191	222	1918	1	194
      595	199	333	1964	3	198
      635	213	333	2125	-3	211
      652	216	222	2165	3	218
      666	220	222	2226	-1	223
      685	229	333	2264	3	228
      698	234	333	2323	1	232
      711	239	444	-	-	236
      723	243	444	-	-4	240
      743	245	111	2476	2	249
