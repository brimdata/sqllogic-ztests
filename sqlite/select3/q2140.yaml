vector: true

script: |
  super -f text -I q2140.spq | sort > q2140.out

inputs:
  - name: q2140.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      a+b*2,
      (a+b+c+d+e)/5,
      a+b*2+c*3+d*4,
      c,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE (e>a AND e<b)
      OR (a>b-2 AND a<b+2);
  - name: t1

outputs:
  - name: q2140.out
    data: |
      -	475	-	-	155	-
      -	502	-	-	166	-
      1985	391	132	1325	134	1
      2046	416	137	1371	137	1
      2131	428	142	1411	141	1
      2728	544	182	1828	184	1
      2878	579	192	1918	193	3
      2949	595	197	1964	195	-1
      3331	666	222	2226	224	2
      3399	685	227	2264	225	-1
      3706	743	247	2476	247	-1
