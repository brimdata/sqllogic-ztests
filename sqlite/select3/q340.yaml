vector: true

script: |
  super -f text -I q340.spq | sort > q340.out

inputs:
  - name: q340.spq
    data: |
      SELECT b-c,
      abs(b-c),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4+e*5,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q340.out
    data: |
      -	-	444	-	-
      -	-	444	-	-
      -	-	444	-	-
      -	-	444	-	-
      -1	1	222	3331	222
      -1	1	333	1612	107
      -1	1	333	2806	187
      -1	1	444	-	-
      -1	1	444	-	-
      -1	1	444	2432	162
      -2	2	444	-	-
      -2	2	444	-	-
      -2	2	444	2579	172
      -3	3	333	2728	182
      -3	3	333	3175	212
      -4	4	333	1985	132
      -4	4	444	-	-
      1	1	222	-	-
      1	1	222	2878	192
      1	1	333	-	-
      1	1	333	-	-
      1	1	333	3473	232
      2	2	111	3706	247
      2	2	222	2046	137
      2	2	222	2131	142
      3	3	222	3260	217
      3	3	333	-	-
      3	3	333	2949	197
      3	3	333	3399	227
      4	4	222	1902	127
