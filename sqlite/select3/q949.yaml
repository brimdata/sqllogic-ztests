vector: true

script: |
  super -f text -I q949.spq | sort > q949.out

inputs:
  - name: q949.spq
    data: |
      SELECT d,
      a+b*2+c*3,
      c,
      a+b*2+c*3+d*4,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      ORDER BY 3,2,5,4;
  - name: t1

outputs:
  - name: q949.out
    data: |
      -	1000	166	-	333
      -	1057	176	-	444
      -	1455	244	-	444
      -	880	147	-	444
      -	905	150	-	333
      -	940	155	-	333
      101	-	102	-	444
      108	635	106	1067	333
      114	-	113	-	444
      116	-	119	-	444
      122	738	123	1226	222
      128	760	125	1272	222
      133	793	134	1325	333
      136	827	137	1371	222
      140	851	141	1411	222
      164	966	161	1622	444
      171	1030	172	1714	444
      183	1096	184	1828	333
      185	1121	187	1861	333
      190	1158	193	1918	222
      196	1180	195	1964	333
      203	-	202	-	444
      207	-	208	-	444
      212	1277	214	2125	333
      217	1297	215	2165	222
      222	1338	224	2226	222
      226	1360	225	2264	333
      233	1391	231	2323	333
      238	-	-	-	444
      248	1484	247	2476	111
