vector: true

script: |
  super -f text -I q2229.spq | sort > q2229.out

inputs:
  - name: q2229.spq
    data: |
      SELECT b-c,
      c-d,
      c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      ORDER BY 1,3,4;
  - name: t1

outputs:
  - name: q2229.out
    data: |
      -	-	-	555
      -	-1	202	222
      -	1	102	555
      -	3	119	333
      -1	-	176	555
      -1	-1	113	555
      -1	-2	106	333
      -1	-3	161	333
      -1	2	187	444
      -1	2	224	444
      -2	-	147	555
      -2	1	172	555
      -2	1	208	555
      -3	1	184	333
      -3	2	214	222
      -4	-	244	222
      -4	1	134	444
      1	-	150	555
      1	-	166	555
      1	-2	231	555
      1	1	123	333
      1	3	193	444
      2	-1	247	444
      2	1	137	111
      2	1	141	111
      3	-	155	555
      3	-1	195	555
      3	-1	225	555
      3	-2	215	333
      4	-3	125	333
