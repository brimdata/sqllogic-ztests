vector: true

script: |
  super -f text -I q1127.spq | sort > q1127.out

inputs:
  - name: q1127.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a+b*2+c*3+d*4,
      c,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      OR d>e
      OR (e>a AND e<b)
      ORDER BY 3,4,1;
  - name: t1

outputs:
  - name: q1127.out
    data: |
      111	1371	137	2046
      222	2125	214	3175
      333	-	119	-
      333	1067	106	1612
      333	1272	125	1902
      333	1622	161	2432
      333	1828	184	2728
      333	2165	215	3260
      444	1325	134	1985
      444	1861	187	2806
      444	1918	193	2878
      444	2226	224	3331
      444	2476	247	3706
      555	-	-	-
      555	-	113	-
      555	2323	231	3473
