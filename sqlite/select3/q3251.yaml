vector: true

script: |
  super -f text -I q3251.spq | sort > q3251.out

inputs:
  - name: q3251.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      abs(b-c),
      a+b*2+c*3+d*4,
      d,
      b-c,
      a-b,
      b
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR c>d
      OR (e>c OR e<d)
      ORDER BY 2,1,5,6,3,4,7;
  - name: t1

outputs:
  - name: q3251.out
    data: |
      111	2	1371	136	2	-1	139
      111	2	1411	140	2	-1	143
      222	-	-	203	-	-	-
      222	3	2125	212	-3	2	211
      333	-	-	116	-	-	-
      333	1	1067	108	-1	2	105
      333	1	1226	122	1	-3	124
      333	1	1622	164	-1	3	160
      333	3	1828	183	-3	1	181
      333	3	2165	217	3	-2	218
      333	4	1272	128	4	-2	129
      444	1	1861	185	-1	2	186
      444	1	1918	190	1	-3	194
      444	1	2226	222	-1	-3	223
      444	2	2476	248	2	-4	249
      444	4	1325	133	-4	1	130
      555	-	-	101	-	-	-
      555	-	-	238	-	3	236
      555	1	-	-	-1	4	175
      555	1	-	-	1	1	167
      555	1	-	-	1	2	151
      555	1	-	114	-1	-	112
      555	1	2323	233	1	2	232
      555	2	-	207	-2	-	206
      555	2	1714	171	-2	4	170
      555	3	-	-	3	1	158
      555	3	1964	196	3	1	198
      555	3	2264	226	3	1	228
