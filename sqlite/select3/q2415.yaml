script: |
  super -f text -I q2415.spq | sort > q2415.out

inputs:
  - name: q2415.spq
    data: |
      SELECT e,
      b,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      (a+b+c+d+e)/5,
      a+b*2
      FROM t1 (FORMAT parquet)
      WHERE a>b
      OR (a>b-2 AND a<b+2)
      OR d>e
      ORDER BY 3,2,4,5,1;
  - name: t1

outputs:
  - name: q2415.out
    data: |
      -	151	555	-	455
      -	240	222	-	723
      109	105	333	107	317
      110	112	555	-	-
      126	129	333	127	385
      132	130	444	132	391
      135	139	111	137	416
      144	143	111	142	428
      146	145	555	-	439
      157	158	555	-	475
      162	160	333	162	483
      165	167	555	-	502
      173	170	555	172	514
      177	175	555	-	529
      180	181	333	182	544
      189	186	444	187	560
      197	198	555	197	595
      210	211	222	212	635
      221	223	444	222	666
      227	228	555	227	685
      230	232	555	232	698
      237	236	555	-	711
      246	249	444	247	743
