script: |
  super -f text -I q2732.spq | sort > q2732.out

inputs:
  - name: q2732.spq
    data: |
      SELECT d-e,
      d,
      a+b*2,
      a+b*2+c*3,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b,
      e
      FROM t1 (FORMAT parquet)
      WHERE a>b;
  - name: t1

outputs:
  - name: q2732.out
    data: |
      -	-	439	880	444	145	146
      -	-	455	905	333	151	-
      -	-	475	940	333	158	157
      -	-	502	1000	333	167	165
      -	-	529	1057	444	175	177
      -	-	723	1455	444	240	-
      -1	108	317	635	333	105	109
      -1	196	595	1180	333	198	197
      -1	226	685	1360	333	228	227
      -2	171	514	1030	444	170	173
      -4	185	560	1121	333	186	189
      1	133	391	793	333	130	132
      1	238	711	-	444	236	237
      2	164	483	966	444	160	162
      2	212	635	1277	333	211	210
      3	183	544	1096	333	181	180
      3	233	698	1391	333	232	230
