script: |
  super -f text -I q939.spq | sort > q939.out

inputs:
  - name: q939.spq
    data: |
      SELECT b,
      d-e,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      c-d,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      ORDER BY 2,5,4,1,3;
  - name: t1

outputs:
  - name: q939.out
    data: |
      -	-	555	1	-
      -	-1	222	-1	-
      -	-1	333	3	-
      105	-1	333	-2	1612
      112	4	555	-1	-
      124	-	333	1	-
      129	2	333	-3	1902
      130	1	444	1	1985
      139	1	111	1	2046
      143	-4	111	1	2131
      145	-	555	-	-
      151	-	555	-	-
      158	-	555	-	-
      160	2	333	-3	2432
      167	-	555	-	-
      170	-2	555	1	2579
      175	-	555	-	-
      181	3	333	1	2728
      186	-4	444	2	2806
      194	-2	444	3	2878
      198	-1	555	-1	2949
      206	-	555	1	-
      211	2	222	2	3175
      218	-2	333	-2	3260
      223	1	444	2	3331
      228	-1	555	-1	3399
      232	3	555	-2	3473
      236	1	555	-	-
      240	-	222	-	-
      249	2	444	-1	3706
