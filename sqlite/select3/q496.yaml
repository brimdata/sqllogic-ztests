script: |
  super -f text -I q496.spq | sort > q496.out

inputs:
  - name: q496.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d-e,
      b-c
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q496.out
    data: |
      111	248	-4	490	2	2
      222	122	-3	1240	-	1
      222	128	-2	1290	2	4
      222	136	-1	1390	1	2
      222	140	-1	1430	-4	2
      222	190	-3	382	-2	1
      222	217	-2	432	-2	3
      222	222	-3	440	1	-1
      333	-	1	1580	-	3
      333	-	1	1670	-	1
      333	-	2	1510	-	1
      333	108	2	1050	-1	-1
      333	133	1	1300	1	-4
      333	183	1	364	3	-3
      333	185	2	376	-4	-1
      333	196	1	398	-1	3
      333	212	2	426	2	-3
      333	226	1	458	-1	3
      333	233	2	468	3	1
      444	-	3	486	-	-4
      444	-	4	1450	-	-2
      444	-	4	358	-	-1
      444	101	-	-	-	-
      444	114	-	1120	4	-1
      444	116	-	-	-1	-
      444	164	3	1600	2	-1
      444	171	4	1700	-2	-2
      444	203	-	402	-1	-
      444	207	-	-	-	-2
      444	238	3	2360	1	-
