script: |
  super -f text -I q898.spq | sort > q898.out

inputs:
  - name: q898.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      a+b*2+c*3+d*4+e*5,
      c-d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3,
      d,
      a-b
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q898.out
    data: |
      -	-	-	333	1000	-	1
      -	-	-	333	905	-	2
      -	-	-	333	940	-	1
      -	-	-	444	-	238	3
      -	-	-	444	1057	-	4
      -	-	-	444	1455	-	3
      -	-	-	444	880	-	4
      -	-	-1	444	-	114	-
      -	-	-1	444	-	203	-
      -	-	1	222	738	122	-3
      -	-	1	444	-	101	-
      -	-	1	444	-	207	-
      -	-	3	444	-	116	-
      107	1612	-2	333	635	108	2
      127	1902	-3	222	760	128	-2
      132	1985	1	333	793	133	1
      137	2046	1	222	827	136	-1
      142	2131	1	222	851	140	-1
      162	2432	-3	444	966	164	3
      172	2579	1	444	1030	171	4
      182	2728	1	333	1096	183	1
      187	2806	2	333	1121	185	2
      192	2878	3	222	1158	190	-3
      197	2949	-1	333	1180	196	1
      212	3175	2	333	1277	212	2
      217	3260	-2	222	1297	217	-2
      222	3331	2	222	1338	222	-3
      227	3399	-1	333	1360	226	1
      232	3473	-2	333	1391	233	2
      247	3706	-1	111	1484	248	-4
