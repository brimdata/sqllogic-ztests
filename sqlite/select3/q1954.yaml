script: |
  super -f text -I q1954.spq | sort > q1954.out

inputs:
  - name: q1954.spq
    data: |
      SELECT abs(b-c),
      c-d,
      a+b*2+c*3+d*4+e*5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b-c,
      a-b,
      e
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2;
  - name: t1

outputs:
  - name: q1954.out
    data: |
      1	-1	-	1120	-1	-	110
      1	-2	1612	1050	-1	2	109
      1	-2	3473	468	1	2	230
      1	-3	2432	1600	-1	3	162
      1	1	-	1240	1	-3	-
      1	2	2806	376	-1	2	189
      1	2	3331	440	-1	-3	221
      2	-1	3706	490	2	-4	246
      2	1	-	-	-2	-	-
      2	1	2046	1390	2	-1	135
      2	1	2131	1430	2	-1	144
      2	1	2579	1700	-2	4	173
      3	1	2728	364	-3	1	180
      3	2	3175	426	-3	2	210
      4	1	1985	1300	-4	1	132
