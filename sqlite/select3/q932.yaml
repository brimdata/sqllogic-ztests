script: |
  super -f text -I q932.spq | sort > q932.out

inputs:
  - name: q932.spq
    data: |
      SELECT b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a)
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q932.out
    data: |
      -	444	104
      -	444	115
      -	444	201
      105	333	107
      112	444	-
      124	222	121
      129	222	127
      130	333	131
      139	222	138
      143	222	142
      145	444	149
      151	333	153
      158	333	159
      160	444	163
      167	333	168
      170	444	174
      175	444	179
      181	333	182
      186	333	188
      194	222	191
      198	333	199
      206	444	-
      211	333	213
      218	222	216
      223	222	220
      228	333	229
      232	333	234
      236	444	239
      240	444	243
      249	111	245
