vector: true

script: |
  super -f text -I q390.spq | sort > q390.out

inputs:
  - name: q390.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q390.out
    data: |
      -	-
      -	-
      -	-
      -	1120
      -	1450
      -	1510
      -	1580
      -	1670
      -	2360
      -	358
      -	402
      -	486
      1067	1050
      1226	1240
      1272	1290
      1325	1300
      1371	1390
      1411	1430
      1622	1600
      1714	1700
      1828	364
      1861	376
      1918	382
      1964	398
      2125	426
      2165	432
      2226	440
      2264	458
      2323	468
      2476	490
