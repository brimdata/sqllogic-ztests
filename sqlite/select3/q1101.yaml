vector: true

script: |
  super -f text -I q1101.spq | sort > q1101.out

inputs:
  - name: q1101.spq
    data: |
      SELECT a+b*2,
      abs(b-c),
      abs(a),
      a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      e
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR d NOT BETWEEN 110 AND 150
      ORDER BY 2,4,3;
  - name: t1

outputs:
  - name: q1101.out
    data: |
      -	-	104	-	-	-
      -	-	201	-	402	204
      -	2	-	-	-	-
      317	1	107	1067	1050	109
      369	1	121	1226	1240	-
      385	4	127	1272	1290	126
      416	2	138	1371	1390	135
      428	2	142	1411	1430	144
      455	1	153	-	1510	-
      475	3	159	-	1580	157
      483	1	163	1622	1600	162
      502	1	168	-	1670	165
      514	2	174	1714	1700	173
      544	3	182	1828	364	180
      560	1	188	1861	376	189
      579	1	191	1918	382	192
      595	3	199	1964	398	197
      635	3	213	2125	426	210
      652	3	216	2165	432	219
      666	1	220	2226	440	221
      685	3	229	2264	458	227
      698	1	234	2323	468	230
      711	-	239	-	2360	237
      743	2	245	2476	490	246
