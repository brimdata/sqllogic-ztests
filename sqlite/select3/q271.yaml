script: |
  super -f text -I q271.spq | sort > q271.out

inputs:
  - name: q271.spq
    data: |
      SELECT abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4,
      a-b,
      e
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      ORDER BY 3,5,4;
  - name: t1

outputs:
  - name: q271.out
    data: |
      131	1300	1325	1	132
      138	1390	1371	-1	135
      142	1430	1411	-1	144
      159	1580	-	1	157
      168	1670	-	1	165
      182	364	1828	1	180
      199	398	1964	1	197
      229	458	2264	1	227
