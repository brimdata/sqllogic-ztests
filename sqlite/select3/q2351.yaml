script: |
  super -f text -I q2351.spq | sort > q2351.out

inputs:
  - name: q2351.spq
    data: |
      SELECT a,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      ORDER BY 2,3,1;
  - name: t1

outputs:
  - name: q2351.out
    data: |
      -	-	-
      -	1120	-
      104	-	-
      107	1050	1067
      115	-	-
      121	1240	1226
      127	1290	1272
      131	1300	1325
      138	1390	1371
      142	1430	1411
      149	1450	-
      153	1510	-
      159	1580	-
      163	1600	1622
      168	1670	-
      174	1700	1714
      179	358	-
      182	364	1828
      188	376	1861
      191	382	1918
      199	398	1964
      201	402	-
      213	426	2125
      216	432	2165
      220	440	2226
      229	458	2264
      234	468	2323
      239	2360	-
      243	486	-
      245	490	2476
