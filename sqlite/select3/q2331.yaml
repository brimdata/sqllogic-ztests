vector: true

script: |
  super -f text -I q2331.spq | sort > q2331.out

inputs:
  - name: q2331.spq
    data: |
      SELECT d,
      e,
      a+b*2+c*3+d*4+e*5,
      c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 5,6,4;
  - name: t1

outputs:
  - name: q2331.out
    data: |
      -	-	-	150	555	151
      -	157	-	155	555	158
      -	165	-	166	555	167
      108	109	1612	106	333	105
      116	117	-	119	333	-
      122	-	-	123	333	124
      128	126	1902	125	333	129
      136	135	2046	137	111	139
      140	144	2131	141	111	143
      164	162	2432	161	333	160
      185	189	2806	187	444	186
      190	192	2878	193	444	194
      196	197	2949	195	555	198
      212	210	3175	214	222	211
      217	219	3260	215	333	218
      222	221	3331	224	444	223
      226	227	3399	225	555	228
      233	230	3473	231	555	232
      248	246	3706	247	444	249
