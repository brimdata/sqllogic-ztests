script: |
  super -f text -I q295.spq | sort > q295.out

inputs:
  - name: q295.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a,
      d,
      a+b*2+c*3,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b
      FROM t1 (FORMAT parquet)
      ORDER BY 3,1,5,2,6,4,7;
  - name: t1

outputs:
  - name: q295.out
    data: |
      -	-	-	207	-	444	-
      -	-	104	101	-	444	-
      -	-	115	116	-	444	-
      -	1120	-	114	-	444	-
      -	1240	121	122	738	222	-3
      -	1450	149	-	880	444	4
      -	1510	153	-	905	333	2
      -	1580	159	-	940	333	1
      -	1670	168	-	1000	333	1
      -	2360	239	238	-	444	3
      -	358	179	-	1057	444	4
      -	402	201	203	-	444	-
      -	486	243	-	1455	444	3
      107	1050	107	108	635	333	2
      127	1290	127	128	760	222	-2
      132	1300	131	133	793	333	1
      137	1390	138	136	827	222	-1
      142	1430	142	140	851	222	-1
      162	1600	163	164	966	444	3
      172	1700	174	171	1030	444	4
      182	364	182	183	1096	333	1
      187	376	188	185	1121	333	2
      192	382	191	190	1158	222	-3
      197	398	199	196	1180	333	1
      212	426	213	212	1277	333	2
      217	432	216	217	1297	222	-2
      222	440	220	222	1338	222	-3
      227	458	229	226	1360	333	1
      232	468	234	233	1391	333	2
      247	490	245	248	1484	111	-4
