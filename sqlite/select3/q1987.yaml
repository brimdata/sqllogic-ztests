vector: true

script: |
  super -f text -I q1987.spq | sort > q1987.out

inputs:
  - name: q1987.spq
    data: |
      SELECT c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a-b,
      a+b*2+c*3+d*4,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      ORDER BY 5,2,3,6,4,1;
  - name: t1

outputs:
  - name: q1987.out
    data: |
      106	1050	2	1067	333	108
      113	1120	-	-	444	114
      123	1240	-3	1226	222	122
      134	1300	1	1325	333	133
      137	1390	-1	1371	222	136
      141	1430	-1	1411	222	140
      161	1600	3	1622	444	164
      172	1700	4	1714	444	171
      184	364	1	1828	333	183
      187	376	2	1861	333	185
      208	-	-	-	444	207
      214	426	2	2125	333	212
      224	440	-3	2226	222	222
      231	468	2	2323	333	233
      247	490	-4	2476	111	248
