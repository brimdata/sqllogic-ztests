vector: true

script: |
  super -f text -I q2512.spq | sort > q2512.out

inputs:
  - name: q2512.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      (a+b+c+d+e)/5,
      d-e,
      e,
      d
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q2512.out
    data: |
      111	247	2	246	248
      222	-	-	-	122
      222	127	2	126	128
      222	137	1	135	136
      222	142	-4	144	140
      222	192	-2	192	190
      222	217	-2	219	217
      222	222	1	221	222
      333	-	-	-	-
      333	-	-	157	-
      333	-	-	165	-
      333	107	-1	109	108
      333	132	1	132	133
      333	182	3	180	183
      333	187	-4	189	185
      333	197	-1	197	196
      333	212	2	210	212
      333	227	-1	227	226
      333	232	3	230	233
      444	-	-	-	-
      444	-	-	-	101
      444	-	-	-	207
      444	-	-	146	-
      444	-	-	177	-
      444	-	-1	117	116
      444	-	-1	204	203
      444	-	1	237	238
      444	-	4	110	114
      444	162	2	162	164
      444	172	-2	173	171
