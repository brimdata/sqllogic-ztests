script: |
  super -f text -I q446.spq | sort > q446.out

inputs:
  - name: q446.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      a+b*2+c*3+d*4+e*5,
      abs(a),
      b-c,
      c,
      a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q446.out
    data: |
      -	-	-	-1	113	-	1120
      -	-	159	3	155	1	1580
      -	-	179	-1	176	4	358
      -	-	201	-	202	-	402
      -	-	239	-	-	3	2360
      107	1612	107	-1	106	2	1050
      127	1902	127	4	125	-2	1290
      132	1985	131	-4	134	1	1300
      137	2046	138	2	137	-1	1390
      142	2131	142	2	141	-1	1430
      162	2432	163	-1	161	3	1600
      172	2579	174	-2	172	4	1700
      182	2728	182	-3	184	1	364
      187	2806	188	-1	187	2	376
      197	2949	199	3	195	1	398
      212	3175	213	-3	214	2	426
      217	3260	216	3	215	-2	432
      222	3331	220	-1	224	-3	440
      227	3399	229	3	225	1	458
      232	3473	234	1	231	2	468
      247	3706	245	2	247	-4	490
