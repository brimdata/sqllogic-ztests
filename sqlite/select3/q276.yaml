vector: true

script: |
  super -f text -I q276.spq | sort > q276.out

inputs:
  - name: q276.spq
    data: |
      SELECT abs(b-c),
      a+b*2+c*3+d*4,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3,
      c,
      e,
      d
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR a>b
      OR d NOT BETWEEN 110 AND 150;
  - name: t1

outputs:
  - name: q276.out
    data: |
      -	-	444	-	-	237	238
      -	-	444	-	102	-	101
      -	-	444	-	202	204	203
      1	-	333	1000	166	165	-
      1	-	333	905	150	-	-
      1	-	444	-	113	110	114
      1	-	444	1057	176	177	-
      1	1067	333	635	106	109	108
      1	1226	222	738	123	-	122
      1	1622	444	966	161	162	164
      1	1861	333	1121	187	189	185
      1	1918	222	1158	193	192	190
      1	2226	222	1338	224	221	222
      1	2323	333	1391	231	230	233
      2	-	444	-	208	-	207
      2	-	444	880	147	146	-
      2	1371	222	827	137	135	136
      2	1411	222	851	141	144	140
      2	1714	444	1030	172	173	171
      2	2476	111	1484	247	246	248
      3	-	333	940	155	157	-
      3	1828	333	1096	184	180	183
      3	1964	333	1180	195	197	196
      3	2125	333	1277	214	210	212
      3	2165	222	1297	215	219	217
      3	2264	333	1360	225	227	226
      4	-	444	1455	244	-	-
      4	1325	333	793	134	132	133
