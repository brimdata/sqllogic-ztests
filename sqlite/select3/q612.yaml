vector: true

script: |
  super -f text -I q612.spq | sort > q612.out

inputs:
  - name: q612.spq
    data: |
      SELECT b,
      b-c,
      e,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      WHERE c>d;
  - name: t1

outputs:
  - name: q612.out
    data: |
      -	-	-	102	-	-	-
      -	-	117	119	-	-	-
      124	1	-	123	1240	738	-
      130	-4	132	134	1300	793	1985
      139	2	135	137	1390	827	2046
      143	2	144	141	1430	851	2131
      170	-2	173	172	1700	1030	2579
      181	-3	180	184	364	1096	2728
      186	-1	189	187	376	1121	2806
      194	1	192	193	382	1158	2878
      206	-2	-	208	-	-	-
      211	-3	210	214	426	1277	3175
      223	-1	221	224	440	1338	3331
