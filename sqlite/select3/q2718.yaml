vector: true

script: |
  super -f text -I q2718.spq | sort > q2718.out

inputs:
  - name: q2718.spq
    data: |
      SELECT a,
      d-e,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      OR b>c
      OR c BETWEEN b-2 AND d+2;
  - name: t1

outputs:
  - name: q2718.out
    data: |
      -	-	208	-
      -	4	113	1120
      107	-1	106	1050
      115	-1	119	-
      121	-	123	1240
      127	2	125	1290
      131	1	134	1300
      138	1	137	1390
      142	-4	141	1430
      153	-	150	1510
      159	-	155	1580
      163	2	161	1600
      168	-	166	1670
      174	-2	172	1700
      182	3	184	364
      188	-4	187	376
      191	-2	193	382
      199	-1	195	398
      213	2	214	426
      216	-2	215	432
      220	1	224	440
      229	-1	225	458
      234	3	231	468
      245	2	247	490
