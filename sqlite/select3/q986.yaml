script: |
  super -f text -I q986.spq | sort > q986.out

inputs:
  - name: q986.spq
    data: |
      SELECT a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d-e,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      e,
      a+b*2+c*3
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q986.out
    data: |
      -	-	-	555	-	-
      -	-	-	555	-	-
      -	-	-1	333	117	-
      -	1120	4	555	110	-
      -	402	-1	222	204	-
      -1	1390	1	111	135	827
      -1	1430	-4	111	144	851
      -2	1290	2	333	126	760
      -2	432	-2	333	219	1297
      -3	1240	-	333	-	738
      -3	382	-2	444	192	1158
      -3	440	1	444	221	1338
      -4	490	2	444	246	1484
      1	1300	1	444	132	793
      1	1580	-	555	157	940
      1	1670	-	555	165	1000
      1	364	3	333	180	1096
      1	398	-1	555	197	1180
      1	458	-1	555	227	1360
      2	1050	-1	333	109	635
      2	1510	-	555	-	905
      2	376	-4	444	189	1121
      2	426	2	222	210	1277
      2	468	3	555	230	1391
      3	1600	2	333	162	966
      3	2360	1	555	237	-
      3	486	-	222	-	1455
      4	1450	-	555	146	880
      4	1700	-2	555	173	1030
      4	358	-	555	177	1057
