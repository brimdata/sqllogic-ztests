vector: true

script: |
  super -f text -I q2715.spq | sort > q2715.out

inputs:
  - name: q2715.spq
    data: |
      SELECT c-d,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      abs(a),
      d
      FROM t1 (FORMAT parquet)
      ORDER BY 1,2;
  - name: t1

outputs:
  - name: q2715.out
    data: |
      -	1450	-	149	-
      -	1510	-	153	-
      -	1580	-	159	-
      -	1670	-	168	-
      -	2360	-	239	238
      -	358	-	179	-
      -	486	-	243	-
      -1	1120	-	-	114
      -1	398	197	199	196
      -1	402	-	201	203
      -1	458	227	229	226
      -1	490	247	245	248
      -2	1050	107	107	108
      -2	432	217	216	217
      -2	468	232	234	233
      -3	1290	127	127	128
      -3	1600	162	163	164
      1	-	-	-	207
      1	-	-	104	101
      1	1240	-	121	122
      1	1300	132	131	133
      1	1390	137	138	136
      1	1430	142	142	140
      1	1700	172	174	171
      1	364	182	182	183
      2	376	187	188	185
      2	426	212	213	212
      2	440	222	220	222
      3	-	-	115	116
      3	382	192	191	190
