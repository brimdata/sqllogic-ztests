vector: true

script: |
  super -f text -I q3139.spq | sort > q3139.out

inputs:
  - name: q3139.spq
    data: |
      SELECT d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a,
      a-b
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR a>b
      ORDER BY 1,3,2;
  - name: t1

outputs:
  - name: q3139.out
    data: |
      -	333	153	2
      -	333	159	1
      -	333	168	1
      -	444	149	4
      -	444	179	4
      -	444	243	3
      108	333	107	2
      122	222	121	-3
      128	222	127	-2
      133	333	131	1
      136	222	138	-1
      140	222	142	-1
      164	444	163	3
      171	444	174	4
      183	333	182	1
      185	333	188	2
      190	222	191	-3
      196	333	199	1
      212	333	213	2
      217	222	216	-2
      226	333	229	1
      233	333	234	2
      238	444	239	3
      248	111	245	-4
