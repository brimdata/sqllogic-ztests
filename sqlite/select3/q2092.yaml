vector: true

script: |
  super -f text -I q2092.spq | sort > q2092.out

inputs:
  - name: q2092.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      a+b*2+c*3+d*4+e*5,
      a,
      b-c,
      c-d,
      abs(a)
      FROM t1 (FORMAT parquet)
      WHERE c>d
      OR d>e
      OR (a>b-2 AND a<b+2);
  - name: t1

outputs:
  - name: q2092.out
    data: |
      111	248	3706	245	2	-1	245
      222	122	-	121	1	1	121
      222	128	1902	127	4	-3	127
      222	136	2046	138	2	1	138
      222	140	2131	142	2	1	142
      222	190	2878	191	1	3	191
      222	222	3331	220	-1	2	220
      333	-	-	159	3	-	159
      333	-	-	168	1	-	168
      333	133	1985	131	-4	1	131
      333	183	2728	182	-3	1	182
      333	185	2806	188	-1	2	188
      333	196	2949	199	3	-1	199
      333	212	3175	213	-3	2	213
      333	226	3399	229	3	-1	229
      333	233	3473	234	1	-2	234
      444	101	-	104	-	1	104
      444	114	-	-	-1	-1	-
      444	116	-	115	-	3	115
      444	164	2432	163	-1	-3	163
      444	171	2579	174	-2	1	174
      444	207	-	-	-2	1	-
      444	238	-	239	-	-	239
