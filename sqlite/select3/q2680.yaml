vector: true

script: |
  super -f text -I q2680.spq | sort > q2680.out

inputs:
  - name: q2680.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      a+b*2+c*3,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q2680.out
    data: |
      -	-	-	2360
      -	-	113	1120
      -	-	202	402
      -	1057	176	358
      -	940	155	1580
      1067	635	106	1050
      1272	760	125	1290
      1325	793	134	1300
      1371	827	137	1390
      1411	851	141	1430
      1622	966	161	1600
      1714	1030	172	1700
      1828	1096	184	364
      1861	1121	187	376
      1964	1180	195	398
      2125	1277	214	426
      2165	1297	215	432
      2226	1338	224	440
      2264	1360	225	458
      2323	1391	231	468
      2476	1484	247	490
