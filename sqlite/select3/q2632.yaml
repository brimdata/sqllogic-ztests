script: |
  super -f text -I q2632.spq | sort > q2632.out

inputs:
  - name: q2632.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b-c,
      a+b*2+c*3+d*4,
      a,
      abs(b-c)
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q2632.out
    data: |
      111	2	2476	245	2
      222	-1	2226	220	1
      222	1	1226	121	1
      222	1	1918	191	1
      222	2	1371	138	2
      222	2	1411	142	2
      222	3	2165	216	3
      222	4	1272	127	4
      333	-1	1067	107	1
      333	-1	1861	188	1
      333	-3	1828	182	3
      333	-3	2125	213	3
      333	-4	1325	131	4
      333	1	-	153	1
      333	1	-	168	1
      333	1	2323	234	1
      333	3	-	159	3
      333	3	1964	199	3
      333	3	2264	229	3
      444	-	-	104	-
      444	-	-	115	-
      444	-	-	201	-
      444	-	-	239	-
      444	-1	-	-	1
      444	-1	-	179	1
      444	-1	1622	163	1
      444	-2	-	-	2
      444	-2	-	149	2
      444	-2	1714	174	2
      444	-4	-	243	4
