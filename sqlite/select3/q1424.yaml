vector: true

script: |
  super -f text -I q1424.spq | sort > q1424.out

inputs:
  - name: q1424.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      e,
      d-e
      FROM t1 (FORMAT parquet)
      WHERE a>b
      OR (a>b-2 AND a<b+2)
      OR c>d;
  - name: t1

outputs:
  - name: q1424.out
    data: |
      111	135	1
      111	144	-4
      222	-	-
      222	210	2
      333	-	-
      333	109	-1
      333	117	-1
      333	162	2
      333	180	3
      444	132	1
      444	189	-4
      444	192	-2
      444	221	1
      555	-	-
      555	-	-
      555	-	-
      555	146	-
      555	157	-
      555	165	-
      555	173	-2
      555	177	-
      555	197	-1
      555	227	-1
      555	230	3
      555	237	1
