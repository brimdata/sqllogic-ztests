vector: true

script: |
  super -f text -I q148.spq | sort > q148.out

inputs:
  - name: q148.spq
    data: |
      SELECT a,
      b-c,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q148.out
    data: |
      -	-1	444
      -	-2	444
      104	-	444
      107	-1	333
      115	-	444
      121	1	222
      127	4	222
      131	-4	333
      138	2	222
      142	2	222
      149	-2	444
      153	1	333
      159	3	333
      163	-1	444
      168	1	333
      174	-2	444
      179	-1	444
      182	-3	333
      188	-1	333
      191	1	222
      199	3	333
      201	-	444
      213	-3	333
      216	3	222
      220	-1	222
      229	3	333
      234	1	333
      239	-	444
      243	-4	444
      245	2	111
