vector: true

script: |
  super -f text -I q1983.spq | sort > q1983.out

inputs:
  - name: q1983.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      e,
      abs(a)
      FROM t1 (FORMAT parquet)
      ORDER BY 2,1,3;
  - name: t1

outputs:
  - name: q1983.out
    data: |
      -	-	-
      -	-	104
      -	117	115
      1050	109	107
      1120	110	-
      1240	-	121
      1290	126	127
      1300	132	131
      1390	135	138
      1430	144	142
      1450	146	149
      1510	-	153
      1580	157	159
      1600	162	163
      1670	165	168
      1700	173	174
      2360	237	239
      358	177	179
      364	180	182
      376	189	188
      382	192	191
      398	197	199
      402	204	201
      426	210	213
      432	219	216
      440	221	220
      458	227	229
      468	230	234
      486	-	243
      490	246	245
