vector: true

script: |
  super -f text -I q2667.spq | sort > q2667.out

inputs:
  - name: q2667.spq
    data: |
      SELECT a+b*2,
      a,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      e,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR c BETWEEN b-2 AND d+2
      OR d NOT BETWEEN 110 AND 150
      ORDER BY 5,2;
  - name: t1

outputs:
  - name: q2667.out
    data: |
      -	-	-	-	1
      -	-	1120	110	-1
      -	104	-	-	1
      -	201	402	204	-1
      317	107	1050	109	-2
      369	121	1240	-	1
      391	131	1300	132	1
      416	138	1390	135	1
      428	142	1430	144	1
      475	159	1580	157	-
      483	163	1600	162	-3
      502	168	1670	165	-
      514	174	1700	173	1
      544	182	364	180	1
      560	188	376	189	2
      579	191	382	192	3
      595	199	398	197	-1
      635	213	426	210	2
      652	216	432	219	-2
      666	220	440	221	2
      685	229	458	227	-1
      698	234	468	230	-2
      711	239	2360	237	-
      743	245	490	246	-1
