vector: true

script: |
  super -f text -I q884.spq | sort > q884.out

inputs:
  - name: q884.spq
    data: |
      SELECT e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q884.out
    data: |
      -	-
      -	-
      -	1240
      -	1510
      -	486
      109	1050
      110	1120
      117	-
      126	1290
      132	1300
      135	1390
      144	1430
      146	1450
      157	1580
      162	1600
      165	1670
      173	1700
      177	358
      180	364
      189	376
      192	382
      197	398
      204	402
      210	426
      219	432
      221	440
      227	458
      230	468
      237	2360
      246	490
