vector: true

script: |
  super -f text -I q3269.spq | sort > q3269.out

inputs:
  - name: q3269.spq
    data: |
      SELECT b,
      (a+b+c+d+e)/5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      c
      FROM t1 (FORMAT parquet)
      ORDER BY 4,3,2,1;
  - name: t1

outputs:
  - name: q3269.out
    data: |
      -	-	-	102
      -	-	-	119
      -	-	402	202
      105	107	1050	106
      112	-	1120	113
      124	-	1240	123
      129	127	1290	125
      130	132	1300	134
      139	137	1390	137
      143	142	1430	141
      145	-	1450	147
      151	-	1510	150
      158	-	1580	155
      160	162	1600	161
      167	-	1670	166
      170	172	1700	172
      175	-	358	176
      181	182	364	184
      186	187	376	187
      194	192	382	193
      198	197	398	195
      206	-	-	208
      211	212	426	214
      218	217	432	215
      223	222	440	224
      228	227	458	225
      232	232	468	231
      236	-	2360	-
      240	-	486	244
      249	247	490	247
