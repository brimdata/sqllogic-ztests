vector: true

script: |
  super -f text -I q268.spq | sort > q268.out

inputs:
  - name: q268.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2,
      b,
      a+b*2+c*3+d*4,
      abs(a)
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q268.out
    data: |
      111	222	416	139	1371	138
      111	222	428	143	1411	142
      222	333	635	211	2125	213
      222	444	-	-	-	201
      222	444	723	240	-	243
      333	222	369	124	1226	121
      333	222	385	129	1272	127
      333	222	652	218	2165	216
      333	333	317	105	1067	107
      333	333	544	181	1828	182
      333	444	-	-	-	115
      333	444	483	160	1622	163
      444	111	743	249	2476	245
      444	222	579	194	1918	191
      444	222	666	223	2226	220
      444	333	391	130	1325	131
      444	333	560	186	1861	188
      555	333	455	151	-	153
      555	333	475	158	-	159
      555	333	502	167	-	168
      555	333	595	198	1964	199
      555	333	685	228	2264	229
      555	333	698	232	2323	234
      555	444	-	-	-	104
      555	444	-	112	-	-
      555	444	-	206	-	-
      555	444	439	145	-	149
      555	444	514	170	1714	174
      555	444	529	175	-	179
      555	444	711	236	-	239
