vector: true

script: |
  super -f text -I q330.spq | sort > q330.out

inputs:
  - name: q330.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      OR a>b;
  - name: t1

outputs:
  - name: q330.out
    data: |
      1050	635	-2
      1290	760	-3
      1300	793	1
      1450	880	-
      1510	905	-
      1580	940	-
      1600	966	-3
      1670	1000	-
      1700	1030	1
      2360	-	-
      358	1057	-
      364	1096	1
      376	1121	2
      398	1180	-1
      426	1277	2
      458	1360	-1
      468	1391	-2
      486	1455	-
