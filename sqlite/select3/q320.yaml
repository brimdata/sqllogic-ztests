vector: true

script: |
  super -f text -I q320.spq | sort > q320.out

inputs:
  - name: q320.spq
    data: |
      SELECT d,
      a,
      a+b*2+c*3,
      a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q320.out
    data: |
      -	149	880	-	1450
      -	153	905	-	1510
      -	159	940	-	1580
      -	168	1000	-	1670
      -	179	1057	-	358
      -	243	1455	-	486
      101	104	-	-	-
      108	107	635	1067	1050
      114	-	-	-	1120
      116	115	-	-	-
      122	121	738	1226	1240
      128	127	760	1272	1290
      133	131	793	1325	1300
      136	138	827	1371	1390
      140	142	851	1411	1430
      164	163	966	1622	1600
      171	174	1030	1714	1700
      183	182	1096	1828	364
      185	188	1121	1861	376
      190	191	1158	1918	382
      196	199	1180	1964	398
      203	201	-	-	402
      207	-	-	-	-
      212	213	1277	2125	426
      217	216	1297	2165	432
      222	220	1338	2226	440
      226	229	1360	2264	458
      233	234	1391	2323	468
      238	239	-	-	2360
      248	245	1484	2476	490
