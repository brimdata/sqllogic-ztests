script: |
  super -f text -I q673.spq | sort > q673.out

inputs:
  - name: q673.spq
    data: |
      SELECT d,
      a+b*2+c*3+d*4+e*5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3,
      d-e,
      a+b*2+c*3+d*4,
      c
      FROM t1 (FORMAT parquet)
      WHERE c>d
      OR c BETWEEN b-2 AND d+2
      ORDER BY 5,7;
  - name: t1

outputs:
  - name: q673.out
    data: |
      101	-	444	-	-	-	102
      108	1612	333	635	-1	1067	106
      114	-	444	-	4	-	113
      116	-	444	-	-1	-	119
      122	-	222	738	-	1226	123
      133	1985	333	793	1	1325	134
      136	2046	222	827	1	1371	137
      140	2131	222	851	-4	1411	141
      164	2432	444	966	2	1622	161
      171	2579	444	1030	-2	1714	172
      183	2728	333	1096	3	1828	184
      185	2806	333	1121	-4	1861	187
      190	2878	222	1158	-2	1918	193
      207	-	444	-	-	-	208
      212	3175	333	1277	2	2125	214
      222	3331	222	1338	1	2226	224
      233	3473	333	1391	3	2323	231
      248	3706	111	1484	2	2476	247
