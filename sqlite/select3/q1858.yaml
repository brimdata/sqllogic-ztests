vector: true

script: |
  super -f text -I q1858.spq | sort > q1858.out

inputs:
  - name: q1858.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      a+b*2+c*3,
      a+b*2,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q1858.out
    data: |
      -	-	-	-	333
      -	-	-	-	555
      -	-	-	-	555
      -	-	-	1120	555
      -	-	-	402	222
      -	-	711	2360	555
      -	1000	502	1670	555
      -	1057	529	358	555
      -	1455	723	486	222
      -	738	369	1240	333
      -	880	439	1450	555
      -	905	455	1510	555
      -	940	475	1580	555
      107	635	317	1050	333
      127	760	385	1290	333
      132	793	391	1300	444
      137	827	416	1390	111
      142	851	428	1430	111
      162	966	483	1600	333
      172	1030	514	1700	555
      182	1096	544	364	333
      187	1121	560	376	444
      192	1158	579	382	444
      197	1180	595	398	555
      212	1277	635	426	222
      217	1297	652	432	333
      222	1338	666	440	444
      227	1360	685	458	555
      232	1391	698	468	555
      247	1484	743	490	444
