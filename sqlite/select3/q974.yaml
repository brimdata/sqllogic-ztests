script: |
  super -f text -I q974.spq | sort > q974.out

inputs:
  - name: q974.spq
    data: |
      SELECT c-d,
      d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      d-e
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q974.out
    data: |
      -	-	222	-
      -	-	555	-
      -	-	555	-
      -	-	555	-
      -	-	555	-
      -	-	555	-
      -	238	555	1
      -1	114	555	4
      -1	196	555	-1
      -1	203	222	-1
      -1	226	555	-1
      -1	248	444	2
      -2	108	333	-1
      -2	217	333	-2
      -2	233	555	3
      -3	128	333	2
      -3	164	333	2
      1	101	555	-
      1	122	333	-
      1	133	444	1
      1	136	111	1
      1	140	111	-4
      1	171	555	-2
      1	183	333	3
      1	207	555	-
      2	185	444	-4
      2	212	222	2
      2	222	444	1
      3	116	333	-1
      3	190	444	-2
