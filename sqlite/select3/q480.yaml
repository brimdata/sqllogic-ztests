vector: true

script: |
  super -f text -I q480.spq | sort > q480.out

inputs:
  - name: q480.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a),
      a+b*2+c*3,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q480.out
    data: |
      -	333	153	905	-
      -	333	159	940	-
      -	333	168	1000	-
      -	444	-	-	-
      -	444	-	-	-
      -	444	104	-	-
      -	444	115	-	-
      -	444	149	880	-
      -	444	179	1057	-
      -	444	201	-	-
      -	444	239	-	-
      -	444	243	1455	-
      1067	333	107	635	1612
      1226	222	121	738	-
      1272	222	127	760	1902
      1325	333	131	793	1985
      1371	222	138	827	2046
      1411	222	142	851	2131
      1622	444	163	966	2432
      1714	444	174	1030	2579
      1828	333	182	1096	2728
      1861	333	188	1121	2806
      1918	222	191	1158	2878
      1964	333	199	1180	2949
      2125	333	213	1277	3175
      2165	222	216	1297	3260
      2226	222	220	1338	3331
      2264	333	229	1360	3399
      2323	333	234	1391	3473
      2476	111	245	1484	3706
