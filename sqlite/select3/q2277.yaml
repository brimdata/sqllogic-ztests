vector: true

script: |
  super -f text -I q2277.spq | sort > q2277.out

inputs:
  - name: q2277.spq
    data: |
      SELECT c,
      a+b*2+c*3+d*4+e*5,
      b-c,
      a,
      d-e
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR (a>b-2 AND a<b+2)
      OR d>e
      ORDER BY 3,5,4,2;
  - name: t1

outputs:
  - name: q2277.out
    data: |
      -	-	-	239	1
      106	1612	-1	107	-1
      113	-	-1	-	4
      123	-	1	121	-
      125	1902	4	127	2
      134	1985	-4	131	1
      137	2046	2	138	1
      141	2131	2	142	-4
      155	-	3	159	-
      161	2432	-1	163	2
      166	-	1	168	-
      172	2579	-2	174	-2
      184	2728	-3	182	3
      187	2806	-1	188	-4
      195	2949	3	199	-1
      208	-	-2	-	-
      214	3175	-3	213	2
      224	3331	-1	220	1
      225	3399	3	229	-1
      231	3473	1	234	3
      247	3706	2	245	2
