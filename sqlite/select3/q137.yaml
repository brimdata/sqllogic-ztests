vector: true

script: |
  super -f text -I q137.spq | sort > q137.out

inputs:
  - name: q137.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      b-c,
      abs(a),
      abs(b-c),
      (a+b+c+d+e)/5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE (e>a AND e<b)
      OR b>c
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 2,4,5,3;
  - name: t1

outputs:
  - name: q137.out
    data: |
      -	-	115	-	-	333
      -	1	121	1	-	333
      -	1	153	1	-	555
      -	1	168	1	-	555
      -	3	159	3	-	555
      1612	-1	107	1	107	333
      1902	4	127	4	127	333
      2046	2	138	2	137	111
      2131	2	142	2	142	111
      2432	-1	163	1	162	333
      2806	-1	188	1	187	444
      2878	1	191	1	192	444
      2949	3	199	3	197	555
      3175	-3	213	3	212	222
      3260	3	216	3	217	333
      3331	-1	220	1	222	444
      3399	3	229	3	227	555
      3473	1	234	1	232	555
      3706	2	245	2	247	444
