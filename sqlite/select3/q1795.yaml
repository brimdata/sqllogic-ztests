vector: true

script: |
  super -f text -I q1795.spq | sort > q1795.out

inputs:
  - name: q1795.spq
    data: |
      SELECT c-d,
      a+b*2+c*3+d*4+e*5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a+b*2+c*3+d*4,
      b
      FROM t1 (FORMAT parquet)
      ORDER BY 3,5,4,2,1;
  - name: t1

outputs:
  - name: q1795.out
    data: |
      -	-	222	-	240
      -	-	555	-	145
      -	-	555	-	151
      -	-	555	-	158
      -	-	555	-	167
      -	-	555	-	175
      -	-	555	-	236
      -1	-	222	-	-
      -1	-	555	-	112
      -1	2949	555	1964	198
      -1	3399	555	2264	228
      -1	3706	444	2476	249
      -2	1612	333	1067	105
      -2	3260	333	2165	218
      -2	3473	555	2323	232
      -3	1902	333	1272	129
      -3	2432	333	1622	160
      1	-	333	1226	124
      1	-	555	-	-
      1	-	555	-	206
      1	1985	444	1325	130
      1	2046	111	1371	139
      1	2131	111	1411	143
      1	2579	555	1714	170
      1	2728	333	1828	181
      2	2806	444	1861	186
      2	3175	222	2125	211
      2	3331	444	2226	223
      3	-	333	-	-
      3	2878	444	1918	194
