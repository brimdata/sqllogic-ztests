vector: true

script: |
  super -f text -I q2260.spq | sort > q2260.out

inputs:
  - name: q2260.spq
    data: |
      SELECT a+b*2,
      c-d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q2260.out
    data: |
      -	-1	222	402
      -	-1	555	1120
      -	1	555	-
      -	1	555	-
      -	3	333	-
      317	-2	333	1050
      369	1	333	1240
      385	-3	333	1290
      391	1	444	1300
      416	1	111	1390
      428	1	111	1430
      439	-	555	1450
      455	-	555	1510
      475	-	555	1580
      483	-3	333	1600
      502	-	555	1670
      514	1	555	1700
      529	-	555	358
      544	1	333	364
      560	2	444	376
      579	3	444	382
      595	-1	555	398
      635	2	222	426
      652	-2	333	432
      666	2	444	440
      685	-1	555	458
      698	-2	555	468
      711	-	555	2360
      723	-	222	486
      743	-1	444	490
