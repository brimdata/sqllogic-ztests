vector: true

script: |
  super -f text -I q604.spq | sort > q604.out

inputs:
  - name: q604.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a),
      d,
      a+b*2+c*3+d*4,
      (a+b+c+d+e)/5,
      e,
      a-b
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q604.out
    data: |
      111	245	248	2476	247	246	-4
      222	121	122	1226	-	-	-3
      222	127	128	1272	127	126	-2
      222	138	136	1371	137	135	-1
      222	142	140	1411	142	144	-1
      222	191	190	1918	192	192	-3
      222	216	217	2165	217	219	-2
      222	220	222	2226	222	221	-3
      333	107	108	1067	107	109	2
      333	131	133	1325	132	132	1
      333	153	-	-	-	-	2
      333	159	-	-	-	157	1
      333	168	-	-	-	165	1
      333	182	183	1828	182	180	1
      333	188	185	1861	187	189	2
      333	199	196	1964	197	197	1
      333	213	212	2125	212	210	2
      333	229	226	2264	227	227	1
      333	234	233	2323	232	230	2
      444	-	114	-	-	110	-
      444	-	207	-	-	-	-
      444	104	101	-	-	-	-
      444	115	116	-	-	117	-
      444	149	-	-	-	146	4
      444	163	164	1622	162	162	3
      444	174	171	1714	172	173	4
      444	179	-	-	-	177	4
      444	201	203	-	-	204	-
      444	239	238	-	-	237	3
      444	243	-	-	-	-	3
