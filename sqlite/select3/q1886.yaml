vector: true

script: |
  super -f text -I q1886.spq | sort > q1886.out

inputs:
  - name: q1886.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(a),
      b-c
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q1886.out
    data: |
      -	-	-2
      -	104	-
      -	115	-
      1050	107	-1
      1120	-	-1
      1240	121	1
      1290	127	4
      1300	131	-4
      1390	138	2
      1430	142	2
      1450	149	-2
      1510	153	1
      1580	159	3
      1600	163	-1
      1670	168	1
      1700	174	-2
      2360	239	-
      358	179	-1
      364	182	-3
      376	188	-1
      382	191	1
      398	199	3
      402	201	-
      426	213	-3
      432	216	3
      440	220	-1
      458	229	3
      468	234	1
      486	243	-4
      490	245	2
