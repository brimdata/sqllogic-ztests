script: |
  super -f text -I q918.spq | sort > q918.out

inputs:
  - name: q918.spq
    data: |
      SELECT d,
      b-c,
      c-d,
      a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q918.out
    data: |
      -	-1	-	-	358
      -	3	-	-	1580
      108	-1	-2	1067	1050
      114	-1	-1	-	1120
      128	4	-3	1272	1290
      133	-4	1	1325	1300
      136	2	1	1371	1390
      140	2	1	1411	1430
      164	-1	-3	1622	1600
      171	-2	1	1714	1700
      183	-3	1	1828	364
      185	-1	2	1861	376
      196	3	-1	1964	398
      203	-	-1	-	402
      212	-3	2	2125	426
      217	3	-2	2165	432
      222	-1	2	2226	440
      226	3	-1	2264	458
      233	1	-2	2323	468
      238	-	-	-	2360
      248	2	-1	2476	490
