script: |
  super -f text -I q939.spq | sort > q939.out

inputs:
  - name: q939.spq
    data: |
      SELECT a+b*2+c*3,
      a+b*2,
      e,
      c,
      abs(a),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      AND c>d;
  - name: t1

outputs:
  - name: q939.out
    data: |
      1030	514	173	172	174	444
      1096	544	180	184	182	333
      1121	560	189	187	188	333
      1277	635	210	214	213	333
      1338	666	221	224	220	222
      793	391	132	134	131	333
      827	416	135	137	138	222
      851	428	144	141	142	222
