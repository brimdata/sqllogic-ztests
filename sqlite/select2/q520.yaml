script: |
  super -f text -I q520.spq | sort > q520.out

inputs:
  - name: q520.spq
    data: |
      SELECT c-d,
      a,
      a+b*2,
      abs(a),
      (a+b+c+d+e)/5,
      c
      FROM t1 (FORMAT parquet)
      WHERE a IS NULL
      OR (c<=d-2 OR c>=d+2)
      OR b>c;
  - name: t1

outputs:
  - name: q520.out
    data: |
      -	153	455	153	-	150
      -	159	475	159	-	155
      -	168	502	168	-	166
      -1	-	-	-	-	113
      -1	199	595	199	197	195
      -1	229	685	229	227	225
      -1	245	743	245	247	247
      -2	107	317	107	107	106
      -2	216	652	216	217	215
      -2	234	698	234	232	231
      -3	127	385	127	127	125
      -3	163	483	163	162	161
      1	-	-	-	-	208
      1	121	369	121	-	123
      1	138	416	138	137	137
      1	142	428	142	142	141
      2	188	560	188	187	187
      2	213	635	213	212	214
      2	220	666	220	222	224
      3	115	-	115	-	119
      3	191	579	191	192	193
