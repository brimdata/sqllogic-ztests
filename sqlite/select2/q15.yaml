vector: true

script: |
  super -f text -I q15.spq | sort > q15.out

inputs:
  - name: q15.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b,
      a+b*2+c*3+d*4,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d-e,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a-b
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q15.out
    data: |
      -	-	-	444	-	555	-
      -	-	-	444	-1	333	-
      -	206	-	444	-	555	-
      1050	105	1067	333	-1	333	2
      1120	112	-	444	4	555	-
      1240	124	1226	222	-	333	-3
      1290	129	1272	222	2	333	-2
      1300	130	1325	333	1	444	1
      1390	139	1371	222	1	111	-1
      1430	143	1411	222	-4	111	-1
      1450	145	-	444	-	555	4
      1510	151	-	333	-	555	2
      1580	158	-	333	-	555	1
      1600	160	1622	444	2	333	3
      1670	167	-	333	-	555	1
      1700	170	1714	444	-2	555	4
      2360	236	-	444	1	555	3
      358	175	-	444	-	555	4
      364	181	1828	333	3	333	1
      376	186	1861	333	-4	444	2
      382	194	1918	222	-2	444	-3
      398	198	1964	333	-1	555	1
      402	-	-	444	-1	222	-
      426	211	2125	333	2	222	2
      432	218	2165	222	-2	333	-2
      440	223	2226	222	1	444	-3
      458	228	2264	333	-1	555	1
      468	232	2323	333	3	555	2
      486	240	-	444	-	222	3
      490	249	2476	111	2	444	-4
