script: |
  super -f text -I q415.spq | sort > q415.out

inputs:
  - name: q415.spq
    data: |
      SELECT b,
      c,
      abs(b-c),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b,
      e,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR b>c;
  - name: t1

outputs:
  - name: q415.out
    data: |
      124	123	1	222	-3	-	-
      129	125	4	222	-2	126	1902
      130	134	4	333	1	132	1985
      139	137	2	222	-1	135	2046
      143	141	2	222	-1	144	2131
      151	150	1	333	2	-	-
      158	155	3	333	1	157	-
      167	166	1	333	1	165	-
      181	184	3	333	1	180	2728
      194	193	1	222	-3	192	2878
      198	195	3	333	1	197	2949
      218	215	3	222	-2	219	3260
      228	225	3	333	1	227	3399
      232	231	1	333	2	230	3473
      249	247	2	111	-4	246	3706
