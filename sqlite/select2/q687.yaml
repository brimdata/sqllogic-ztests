vector: true

script: |
  super -f text -I q687.spq | sort > q687.out

inputs:
  - name: q687.spq
    data: |
      SELECT c-d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a+b*2+c*3+d*4,
      a+b*2,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR coalesce(a,b,c,d,e)<>0;
  - name: t1

outputs:
  - name: q687.out
    data: |
      -	222	-	723	244	486
      -	555	-	439	147	1450
      -	555	-	455	150	1510
      -	555	-	475	155	1580
      -	555	-	502	166	1670
      -	555	-	529	176	358
      -	555	-	711	-	2360
      -1	222	-	-	202	402
      -1	444	2476	743	247	490
      -1	555	-	-	113	1120
      -1	555	1964	595	195	398
      -1	555	2264	685	225	458
      -2	333	1067	317	106	1050
      -2	333	2165	652	215	432
      -2	555	2323	698	231	468
      -3	333	1272	385	125	1290
      -3	333	1622	483	161	1600
      1	111	1371	416	137	1390
      1	111	1411	428	141	1430
      1	333	1226	369	123	1240
      1	333	1828	544	184	364
      1	444	1325	391	134	1300
      1	555	-	-	102	-
      1	555	-	-	208	-
      1	555	1714	514	172	1700
      2	222	2125	635	214	426
      2	444	1861	560	187	376
      2	444	2226	666	224	440
      3	333	-	-	119	-
      3	444	1918	579	193	382
