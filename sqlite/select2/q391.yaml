vector: true

script: |
  super -f text -I q391.spq | sort > q391.out

inputs:
  - name: q391.spq
    data: |
      SELECT abs(b-c),
      a+b*2+c*3+d*4,
      e,
      b-c
      FROM t1 (FORMAT parquet)
      WHERE a IS NULL
      OR coalesce(a,b,c,d,e)<>0
      OR b>c;
  - name: t1

outputs:
  - name: q391.out
    data: |
      -	-	-	-
      -	-	117	-
      -	-	204	-
      -	-	237	-
      1	-	-	1
      1	-	110	-1
      1	-	165	1
      1	-	177	-1
      1	1067	109	-1
      1	1226	-	1
      1	1622	162	-1
      1	1861	189	-1
      1	1918	192	1
      1	2226	221	-1
      1	2323	230	1
      2	-	-	-2
      2	-	146	-2
      2	1371	135	2
      2	1411	144	2
      2	1714	173	-2
      2	2476	246	2
      3	-	157	3
      3	1828	180	-3
      3	1964	197	3
      3	2125	210	-3
      3	2165	219	3
      3	2264	227	3
      4	-	-	-4
      4	1272	126	4
      4	1325	132	-4
