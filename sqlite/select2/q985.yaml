vector: true

script: |
  super -f text -I q985.spq | sort > q985.out

inputs:
  - name: q985.spq
    data: |
      SELECT a-b,
      c,
      b,
      b-c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      (a+b+c+d+e)/5,
      d
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0
      OR (c<=d-2 OR c>=d+2);
  - name: t1

outputs:
  - name: q985.out
    data: |
      -	102	-	-	555	-	101
      -	113	112	-1	555	-	114
      -	119	-	-	333	-	116
      -	202	-	-	222	-	203
      -	208	206	-2	555	-	207
      -1	137	139	2	111	137	136
      -1	141	143	2	111	142	140
      -2	125	129	4	333	127	128
      -2	215	218	3	333	217	217
      -3	123	124	1	333	-	122
      -3	193	194	1	444	192	190
      -3	224	223	-1	444	222	222
      -4	247	249	2	444	247	248
      1	134	130	-4	444	132	133
      1	155	158	3	555	-	-
      1	166	167	1	555	-	-
      1	184	181	-3	333	182	183
      1	195	198	3	555	197	196
      1	225	228	3	555	227	226
      2	106	105	-1	333	107	108
      2	150	151	1	555	-	-
      2	187	186	-1	444	187	185
      2	214	211	-3	222	212	212
      2	231	232	1	555	232	233
      3	-	236	-	555	-	238
      3	161	160	-1	333	162	164
      3	244	240	-4	222	-	-
      4	147	145	-2	555	-	-
      4	172	170	-2	555	172	171
      4	176	175	-1	555	-	-
