vector: true

script: |
  super -f text -I q489.spq | sort > q489.out

inputs:
  - name: q489.spq
    data: |
      SELECT a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      WHERE c>d
      OR (e>c OR e<d)
      OR (a>b-2 AND a<b+2);
  - name: t1

outputs:
  - name: q489.out
    data: |
      -	444	555	-
      -	444	555	-
      104	444	555	-
      107	333	333	1612
      115	444	333	-
      121	222	333	-
      127	222	333	1902
      131	333	444	1985
      138	222	111	2046
      142	222	111	2131
      159	333	555	-
      163	444	333	2432
      168	333	555	-
      174	444	555	2579
      179	444	555	-
      182	333	333	2728
      188	333	444	2806
      191	222	444	2878
      199	333	555	2949
      201	444	222	-
      213	333	222	3175
      216	222	333	3260
      220	222	444	3331
      229	333	555	3399
      234	333	555	3473
      239	444	555	-
      245	111	444	3706
