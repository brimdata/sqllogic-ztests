vector: true

script: |
  super -f text -I q780.spq | sort > q780.out

inputs:
  - name: q780.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a,
      e,
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2);
  - name: t1

outputs:
  - name: q780.out
    data: |
      222	138	135	827
      222	142	144	851
      333	131	132	793
      333	159	157	940
      333	168	165	1000
      333	182	180	1096
      333	199	197	1180
      333	229	227	1360
