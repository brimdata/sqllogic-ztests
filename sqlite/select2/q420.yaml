vector: true

script: |
  super -f text -I q420.spq | sort > q420.out

inputs:
  - name: q420.spq
    data: |
      SELECT abs(a),
      a+b*2+c*3+d*4,
      d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q420.out
    data: |
      -	-	114	444
      -	-	207	444
      104	-	101	444
      107	1067	108	333
      115	-	116	444
      121	1226	122	222
      127	1272	128	222
      131	1325	133	333
      138	1371	136	222
      142	1411	140	222
      149	-	-	444
      153	-	-	333
      159	-	-	333
      163	1622	164	444
      168	-	-	333
      174	1714	171	444
      179	-	-	444
      182	1828	183	333
      188	1861	185	333
      191	1918	190	222
      199	1964	196	333
      201	-	203	444
      213	2125	212	333
      216	2165	217	222
      220	2226	222	222
      229	2264	226	333
      234	2323	233	333
      239	-	238	444
      243	-	-	444
      245	2476	248	111
