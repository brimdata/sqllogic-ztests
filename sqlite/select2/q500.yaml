vector: true

script: |
  super -f text -I q500.spq | sort > q500.out

inputs:
  - name: q500.spq
    data: |
      SELECT e,
      a+b*2+c*3,
      a+b*2,
      a,
      abs(b-c),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b
      FROM t1 (FORMAT parquet)
      WHERE b>c;
  - name: t1

outputs:
  - name: q500.out
    data: |
      -	738	369	121	1	1240	124
      -	905	455	153	1	1510	151
      126	760	385	127	4	1290	129
      135	827	416	138	2	1390	139
      144	851	428	142	2	1430	143
      157	940	475	159	3	1580	158
      165	1000	502	168	1	1670	167
      192	1158	579	191	1	382	194
      197	1180	595	199	3	398	198
      219	1297	652	216	3	432	218
      227	1360	685	229	3	458	228
      230	1391	698	234	1	468	232
      246	1484	743	245	2	490	249
