vector: true

script: |
  super -f text -I q718.spq | sort > q718.out

inputs:
  - name: q718.spq
    data: |
      SELECT b,
      b-c,
      a+b*2+c*3+d*4+e*5,
      abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE b IS NOT NULL
      AND coalesce(a,b,c,d,e)<>0;
  - name: t1

outputs:
  - name: q718.out
    data: |
      105	-1	1612	107	1050
      112	-1	-	-	1120
      124	1	-	121	1240
      129	4	1902	127	1290
      130	-4	1985	131	1300
      139	2	2046	138	1390
      143	2	2131	142	1430
      145	-2	-	149	1450
      151	1	-	153	1510
      158	3	-	159	1580
      160	-1	2432	163	1600
      167	1	-	168	1670
      170	-2	2579	174	1700
      175	-1	-	179	358
      181	-3	2728	182	364
      186	-1	2806	188	376
      194	1	2878	191	382
      198	3	2949	199	398
      206	-2	-	-	-
      211	-3	3175	213	426
      218	3	3260	216	432
      223	-1	3331	220	440
      228	3	3399	229	458
      232	1	3473	234	468
      236	-	-	239	2360
      240	-4	-	243	486
      249	2	3706	245	490
