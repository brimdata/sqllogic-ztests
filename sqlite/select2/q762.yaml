vector: true

script: |
  super -f text -I q762.spq | sort > q762.out

inputs:
  - name: q762.spq
    data: |
      SELECT a-b,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      c-d,
      b
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q762.out
    data: |
      -	-	1	-
      -	-	1	206
      -	-	3	-
      -	1120	-1	112
      -	402	-1	-
      -1	1390	1	139
      -1	1430	1	143
      -2	1290	-3	129
      -2	432	-2	218
      -3	1240	1	124
      -3	382	3	194
      -3	440	2	223
      -4	490	-1	249
      1	1300	1	130
      1	1580	-	158
      1	1670	-	167
      1	364	1	181
      1	398	-1	198
      1	458	-1	228
      2	1050	-2	105
      2	1510	-	151
      2	376	2	186
      2	426	2	211
      2	468	-2	232
      3	1600	-3	160
      3	2360	-	236
      3	486	-	240
      4	1450	-	145
      4	1700	1	170
      4	358	-	175
