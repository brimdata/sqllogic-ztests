vector: true

script: |
  super -f text -I q784.spq | sort > q784.out

inputs:
  - name: q784.spq
    data: |
      SELECT b,
      a+b*2+c*3,
      (a+b+c+d+e)/5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4,
      a+b*2,
      c
      FROM t1 (FORMAT parquet)
      WHERE d>e;
  - name: t1

outputs:
  - name: q784.out
    data: |
      112	-	-	444	-	-	113
      129	760	127	222	1272	385	125
      130	793	132	333	1325	391	134
      139	827	137	222	1371	416	137
      160	966	162	444	1622	483	161
      181	1096	182	333	1828	544	184
      211	1277	212	333	2125	635	214
      223	1338	222	222	2226	666	224
      232	1391	232	333	2323	698	231
      236	-	-	444	-	711	-
      249	1484	247	111	2476	743	247
