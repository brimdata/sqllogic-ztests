vector: true

script: |
  super -f text -I q618.spq | sort > q618.out

inputs:
  - name: q618.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a,
      abs(a),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0
      AND d NOT BETWEEN 110 AND 150
      AND b IS NOT NULL;
  - name: t1

outputs:
  - name: q618.out
    data: |
      -	-	-	444
      1050	107	107	333
      1600	163	163	444
      1700	174	174	444
      2360	239	239	444
      364	182	182	333
      376	188	188	333
      382	191	191	222
      398	199	199	333
      426	213	213	333
      432	216	216	222
      440	220	220	222
      458	229	229	333
      468	234	234	333
      490	245	245	111
