script: |
  super -f text -I q280.spq | sort > q280.out

inputs:
  - name: q280.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      b-c,
      b,
      a,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q280.out
    data: |
      -	-	-	104	102	-	-
      -	-	-	115	119	-	-
      -	-	-	201	202	402	-
      -	-	236	239	-	2360	-
      -	-1	112	-	113	1120	-
      -	-1	175	179	176	358	-
      -	-2	145	149	147	1450	-
      -	-2	206	-	208	-	-
      -	-4	240	243	244	486	-
      -	1	124	121	123	1240	-
      -	1	151	153	150	1510	-
      -	1	167	168	166	1670	-
      -	3	158	159	155	1580	-
      1612	-1	105	107	106	1050	107
      1902	4	129	127	125	1290	127
      1985	-4	130	131	134	1300	132
      2046	2	139	138	137	1390	137
      2131	2	143	142	141	1430	142
      2432	-1	160	163	161	1600	162
      2579	-2	170	174	172	1700	172
      2728	-3	181	182	184	364	182
      2806	-1	186	188	187	376	187
      2878	1	194	191	193	382	192
      2949	3	198	199	195	398	197
      3175	-3	211	213	214	426	212
      3260	3	218	216	215	432	217
      3331	-1	223	220	224	440	222
      3399	3	228	229	225	458	227
      3473	1	232	234	231	468	232
      3706	2	249	245	247	490	247
