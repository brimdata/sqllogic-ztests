vector: true

script: |
  super -f text -I q397.spq | sort > q397.out

inputs:
  - name: q397.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q397.out
    data: |
      -	-
      -	-
      -	-
      1050	1067
      1120	-
      1240	1226
      1290	1272
      1300	1325
      1390	1371
      1430	1411
      1450	-
      1510	-
      1580	-
      1600	1622
      1670	-
      1700	1714
      2360	-
      358	-
      364	1828
      376	1861
      382	1918
      398	1964
      402	-
      426	2125
      432	2165
      440	2226
      458	2264
      468	2323
      486	-
      490	2476
