vector: true

script: |
  super -f text -I q150.spq | sort > q150.out

inputs:
  - name: q150.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b
      FROM t1 (FORMAT parquet)
      WHERE a>b;
  - name: t1

outputs:
  - name: q150.out
    data: |
      -	222	240
      -	555	145
      -	555	151
      -	555	158
      -	555	167
      -	555	175
      -	555	236
      107	333	105
      132	444	130
      162	333	160
      172	555	170
      182	333	181
      187	444	186
      197	555	198
      212	222	211
      227	555	228
      232	555	232
