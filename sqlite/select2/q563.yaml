script: |
  super -f text -I q563.spq | sort > q563.out

inputs:
  - name: q563.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b,
      c-d,
      d,
      a+b*2+c*3+d*4,
      a+b*2+c*3
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q563.out
    data: |
      -	222	124	1	122	1226	738
      -	333	151	-	-	-	905
      -	333	158	-	-	-	940
      -	333	167	-	-	-	1000
      -	444	-	-1	203	-	-
      -	444	-	1	101	-	-
      -	444	-	3	116	-	-
      -	444	112	-1	114	-	-
      -	444	145	-	-	-	880
      -	444	175	-	-	-	1057
      -	444	206	1	207	-	-
      -	444	236	-	238	-	-
      -	444	240	-	-	-	1455
      107	333	105	-2	108	1067	635
      127	222	129	-3	128	1272	760
      132	333	130	1	133	1325	793
      137	222	139	1	136	1371	827
      142	222	143	1	140	1411	851
      162	444	160	-3	164	1622	966
      172	444	170	1	171	1714	1030
      182	333	181	1	183	1828	1096
      187	333	186	2	185	1861	1121
      192	222	194	3	190	1918	1158
      197	333	198	-1	196	1964	1180
      212	333	211	2	212	2125	1277
      217	222	218	-2	217	2165	1297
      222	222	223	2	222	2226	1338
      227	333	228	-1	226	2264	1360
      232	333	232	-2	233	2323	1391
      247	111	249	-1	248	2476	1484
