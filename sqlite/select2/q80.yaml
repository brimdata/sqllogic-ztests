vector: true

script: |
  super -f text -I q80.spq | sort > q80.out

inputs:
  - name: q80.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a,
      d,
      b-c,
      b,
      a+b*2+c*3+d*4,
      a+b*2+c*3
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q80.out
    data: |
      111	138	136	2	139	1371	827
      111	142	140	2	143	1411	851
      222	201	203	-	-	-	-
      222	213	212	-3	211	2125	1277
      222	243	-	-4	240	-	1455
      333	107	108	-1	105	1067	635
      333	115	116	-	-	-	-
      333	121	122	1	124	1226	738
      333	127	128	4	129	1272	760
      333	163	164	-1	160	1622	966
      333	182	183	-3	181	1828	1096
      333	216	217	3	218	2165	1297
      444	131	133	-4	130	1325	793
      444	188	185	-1	186	1861	1121
      444	191	190	1	194	1918	1158
      444	220	222	-1	223	2226	1338
      444	245	248	2	249	2476	1484
      555	-	114	-1	112	-	-
      555	-	207	-2	206	-	-
      555	104	101	-	-	-	-
      555	149	-	-2	145	-	880
      555	153	-	1	151	-	905
      555	159	-	3	158	-	940
      555	168	-	1	167	-	1000
      555	174	171	-2	170	1714	1030
      555	179	-	-1	175	-	1057
      555	199	196	3	198	1964	1180
      555	229	226	3	228	2264	1360
      555	234	233	1	232	2323	1391
      555	239	238	-	236	-	-
