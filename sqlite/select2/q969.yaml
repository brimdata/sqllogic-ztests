script: |
  super -f text -I q969.spq | sort > q969.out

inputs:
  - name: q969.spq
    data: |
      SELECT e,
      a+b*2,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q969.out
    data: |
      -	-	444	555	-
      -	-	444	555	206
      -	369	222	333	124
      -	455	333	555	151
      -	723	444	222	240
      109	317	333	333	105
      110	-	444	555	112
      117	-	444	333	-
      126	385	222	333	129
      132	391	333	444	130
      135	416	222	111	139
      144	428	222	111	143
      146	439	444	555	145
      157	475	333	555	158
      162	483	444	333	160
      165	502	333	555	167
      173	514	444	555	170
      177	529	444	555	175
      180	544	333	333	181
      189	560	333	444	186
      192	579	222	444	194
      197	595	333	555	198
      204	-	444	222	-
      210	635	333	222	211
      219	652	222	333	218
      221	666	222	444	223
      227	685	333	555	228
      230	698	333	555	232
      237	711	444	555	236
      246	743	111	444	249
