script: |
  super -f text -I q511.spq | sort > q511.out

inputs:
  - name: q511.spq
    data: |
      SELECT a+b*2,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q511.out
    data: |
      -	-	333
      -	-	555
      -	-	555
      -	1120	555
      -	402	222
      317	1050	333
      369	1240	333
      385	1290	333
      391	1300	444
      416	1390	111
      428	1430	111
      439	1450	555
      455	1510	555
      475	1580	555
      483	1600	333
      502	1670	555
      514	1700	555
      529	358	555
      544	364	333
      560	376	444
      579	382	444
      595	398	555
      635	426	222
      652	432	333
      666	440	444
      685	458	555
      698	468	555
      711	2360	555
      723	486	222
      743	490	444
