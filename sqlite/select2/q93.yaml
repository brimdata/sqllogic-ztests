vector: true

script: |
  super -f text -I q93.spq | sort > q93.out

inputs:
  - name: q93.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b,
      d-e,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q93.out
    data: |
      111	139	1	1371
      111	143	-4	1411
      222	-	-1	-
      222	211	2	2125
      222	240	-	-
      333	-	-1	-
      333	105	-1	1067
      333	124	-	1226
      333	129	2	1272
      333	160	2	1622
      333	181	3	1828
      333	218	-2	2165
      444	130	1	1325
      444	186	-4	1861
      444	194	-2	1918
      444	223	1	2226
      444	249	2	2476
      555	-	-	-
      555	112	4	-
      555	145	-	-
      555	151	-	-
      555	158	-	-
      555	167	-	-
      555	170	-2	1714
      555	175	-	-
      555	198	-1	1964
      555	206	-	-
      555	228	-1	2264
      555	232	3	2323
      555	236	1	-
