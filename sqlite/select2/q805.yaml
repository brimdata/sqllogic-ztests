script: |
  super -f text -I q805.spq | sort > q805.out

inputs:
  - name: q805.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      abs(a),
      c,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0
      OR (c<=d-2 OR c>=d+2);
  - name: t1

outputs:
  - name: q805.out
    data: |
      -	-	113	444	114
      -	-	208	444	207
      -	104	102	444	101
      -	115	119	444	116
      -	121	123	222	122
      -	149	147	444	-
      -	153	150	333	-
      -	159	155	333	-
      -	168	166	333	-
      -	179	176	444	-
      -	201	202	444	203
      -	239	-	444	238
      -	243	244	444	-
      1612	107	106	333	108
      1902	127	125	222	128
      1985	131	134	333	133
      2046	138	137	222	136
      2131	142	141	222	140
      2432	163	161	444	164
      2579	174	172	444	171
      2728	182	184	333	183
      2806	188	187	333	185
      2878	191	193	222	190
      2949	199	195	333	196
      3175	213	214	333	212
      3260	216	215	222	217
      3331	220	224	222	222
      3399	229	225	333	226
      3473	234	231	333	233
      3706	245	247	111	248
