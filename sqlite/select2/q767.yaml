vector: true

script: |
  super -f text -I q767.spq | sort > q767.out

inputs:
  - name: q767.spq
    data: |
      SELECT d,
      abs(a),
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      e
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      AND a>b
      AND (e>c OR e<d);
  - name: t1

outputs:
  - name: q767.out
    data: |
      108	107	106	1050	109
      164	163	161	1600	162
      185	188	187	376	189
      212	213	214	426	210
      233	234	231	468	230
