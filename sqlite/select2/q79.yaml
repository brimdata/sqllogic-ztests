vector: true

script: |
  super -f text -I q79.spq | sort > q79.out

inputs:
  - name: q79.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q79.out
    data: |
      111	138	1390
      111	142	1430
      222	201	402
      222	213	426
      333	107	1050
      333	127	1290
      333	163	1600
      333	182	364
      333	216	432
      444	131	1300
      444	188	376
      444	220	440
      444	245	490
      555	-	1120
      555	159	1580
      555	174	1700
      555	179	358
      555	199	398
      555	229	458
      555	234	468
      555	239	2360
