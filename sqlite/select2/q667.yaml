script: |
  super -f text -I q667.spq | sort > q667.out

inputs:
  - name: q667.spq
    data: |
      SELECT c-d,
      c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q667.out
    data: |
      -	-	555
      -	147	555
      -	150	555
      -	155	555
      -	166	555
      -	176	555
      -	244	222
      -1	113	555
      -1	195	555
      -1	202	222
      -1	225	555
      -1	247	444
      -2	106	333
      -2	215	333
      -2	231	555
      -3	125	333
      -3	161	333
      1	102	555
      1	123	333
      1	134	444
      1	137	111
      1	141	111
      1	172	555
      1	184	333
      1	208	555
      2	187	444
      2	214	222
      2	224	444
      3	119	333
      3	193	444
