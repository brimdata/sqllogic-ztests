vector: true

script: |
  super -f text -I q707.spq | sort > q707.out

inputs:
  - name: q707.spq
    data: |
      SELECT d,
      (a+b+c+d+e)/5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q707.out
    data: |
      -	-	222
      -	-	555
      -	-	555
      -	-	555
      -	-	555
      -	-	555
      101	-	555
      108	107	333
      114	-	555
      116	-	333
      122	-	333
      128	127	333
      133	132	444
      136	137	111
      140	142	111
      164	162	333
      171	172	555
      183	182	333
      185	187	444
      190	192	444
      196	197	555
      203	-	222
      207	-	555
      212	212	222
      217	217	333
      222	222	444
      226	227	555
      233	232	555
      238	-	555
      248	247	444
