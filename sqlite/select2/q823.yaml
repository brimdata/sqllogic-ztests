vector: true

script: |
  super -f text -I q823.spq | sort > q823.out

inputs:
  - name: q823.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2,
      c-d,
      b-c,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q823.out
    data: |
      -	-	1	-	444
      -	-	1	-2	444
      -	-	3	-	444
      1050	317	-2	-1	333
      1120	-	-1	-1	444
      1240	369	1	1	222
      1290	385	-3	4	222
      1300	391	1	-4	333
      1390	416	1	2	222
      1430	428	1	2	222
      1450	439	-	-2	444
      1510	455	-	1	333
      1580	475	-	3	333
      1600	483	-3	-1	444
      1670	502	-	1	333
      1700	514	1	-2	444
      2360	711	-	-	444
      358	529	-	-1	444
      364	544	1	-3	333
      376	560	2	-1	333
      382	579	3	1	222
      398	595	-1	3	333
      402	-	-1	-	444
      426	635	2	-3	333
      432	652	-2	3	222
      440	666	2	-1	222
      458	685	-1	3	333
      468	698	-2	1	333
      486	723	-	-4	444
      490	743	-1	2	111
