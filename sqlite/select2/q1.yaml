vector: true

script: |
  super -f text -I q1.spq | sort > q1.out

inputs:
  - name: q1.spq
    data: |
      SELECT e,
      abs(a),
      b,
      abs(b-c),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE a>b;
  - name: t1

outputs:
  - name: q1.out
    data: |
      -	153	151	1	333	455	-
      -	243	240	4	444	723	-
      109	107	105	1	333	317	1067
      132	131	130	4	333	391	1325
      146	149	145	2	444	439	-
      157	159	158	3	333	475	-
      162	163	160	1	444	483	1622
      165	168	167	1	333	502	-
      173	174	170	2	444	514	1714
      177	179	175	1	444	529	-
      180	182	181	3	333	544	1828
      189	188	186	1	333	560	1861
      197	199	198	3	333	595	1964
      210	213	211	3	333	635	2125
      227	229	228	3	333	685	2264
      230	234	232	1	333	698	2323
      237	239	236	-	444	711	-
