vector: true

script: |
  super -f text -I q364.spq | sort > q364.out

inputs:
  - name: q364.spq
    data: |
      SELECT d,
      c,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q364.out
    data: |
      -	147	444
      -	150	333
      -	155	333
      -	166	333
      -	176	444
      -	244	444
      101	102	444
      108	106	333
      114	113	444
      116	119	444
      122	123	222
      128	125	222
      133	134	333
      136	137	222
      140	141	222
      164	161	444
      171	172	444
      183	184	333
      185	187	333
      190	193	222
      196	195	333
      203	202	444
      207	208	444
      212	214	333
      217	215	222
      222	224	222
      226	225	333
      233	231	333
      238	-	444
      248	247	111
