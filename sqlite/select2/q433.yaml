vector: true

script: |
  super -f text -I q433.spq | sort > q433.out

inputs:
  - name: q433.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      d,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b-c
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q433.out
    data: |
      111	136	1390	2
      111	140	1430	2
      222	-	486	-4
      222	203	402	-
      222	212	426	-3
      333	108	1050	-1
      333	116	-	-
      333	122	1240	1
      333	128	1290	4
      333	164	1600	-1
      333	183	364	-3
      333	217	432	3
      444	133	1300	-4
      444	185	376	-1
      444	190	382	1
      444	222	440	-1
      444	248	490	2
      555	-	1450	-2
      555	-	1510	1
      555	-	1580	3
      555	-	1670	1
      555	-	358	-1
      555	101	-	-
      555	114	1120	-1
      555	171	1700	-2
      555	196	398	3
      555	207	-	-2
      555	226	458	3
      555	233	468	1
      555	238	2360	-
