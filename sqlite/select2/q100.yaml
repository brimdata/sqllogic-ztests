script: |
  super -f text -I q100.spq | sort > q100.out

inputs:
  - name: q100.spq
    data: |
      SELECT a+b*2+c*3,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2,
      d,
      c
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR a>b
      OR (a>b-2 AND a<b+2);
  - name: t1

outputs:
  - name: q100.out
    data: |
      -	-	-	207	208
      -	1120	-	114	113
      -	2360	711	238	-
      1000	1670	502	-	166
      1030	1700	514	171	172
      1057	358	529	-	176
      1096	364	544	183	184
      1121	376	560	185	187
      1180	398	595	196	195
      1277	426	635	212	214
      1338	440	666	222	224
      1360	458	685	226	225
      1391	468	698	233	231
      1455	486	723	-	244
      1484	490	743	248	247
      635	1050	317	108	106
      738	1240	369	122	123
      793	1300	391	133	134
      827	1390	416	136	137
      851	1430	428	140	141
      880	1450	439	-	147
      905	1510	455	-	150
      940	1580	475	-	155
      966	1600	483	164	161
