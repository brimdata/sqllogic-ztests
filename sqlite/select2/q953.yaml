vector: true

script: |
  super -f text -I q953.spq | sort > q953.out

inputs:
  - name: q953.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b-c,
      abs(b-c),
      e,
      a+b*2+c*3,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR a IS NULL
      OR d NOT BETWEEN 110 AND 150;
  - name: t1

outputs:
  - name: q953.out
    data: |
      111	2	2	246	1484	490	247
      222	-1	1	221	1338	440	222
      222	1	1	192	1158	382	192
      222	2	2	135	827	1390	137
      222	2	2	144	851	1430	142
      222	3	3	219	1297	432	217
      333	-1	1	109	635	1050	107
      333	-1	1	189	1121	376	187
      333	-3	3	180	1096	364	182
      333	-3	3	210	1277	426	212
      333	-4	4	132	793	1300	132
      333	1	1	165	1000	1670	-
      333	1	1	230	1391	468	232
      333	3	3	157	940	1580	-
      333	3	3	197	1180	398	197
      333	3	3	227	1360	458	227
      444	-	-	-	-	-	-
      444	-	-	204	-	402	-
      444	-	-	237	-	2360	-
      444	-1	1	110	-	1120	-
      444	-1	1	162	966	1600	162
      444	-2	2	-	-	-	-
      444	-2	2	173	1030	1700	172
