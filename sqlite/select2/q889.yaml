vector: true

script: |
  super -f text -I q889.spq | sort > q889.out

inputs:
  - name: q889.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      b,
      a,
      e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0
      OR b>c;
  - name: t1

outputs:
  - name: q889.out
    data: |
      -	-	104	-	444
      -	-	115	117	444
      -	-	201	204	444
      -	112	-	110	444
      -	145	149	146	444
      -	151	153	-	333
      -	158	159	157	333
      -	167	168	165	333
      -	175	179	177	444
      -	206	-	-	444
      -	236	239	237	444
      -	240	243	-	444
      1067	105	107	109	333
      1226	124	121	-	222
      1272	129	127	126	222
      1325	130	131	132	333
      1371	139	138	135	222
      1411	143	142	144	222
      1622	160	163	162	444
      1714	170	174	173	444
      1828	181	182	180	333
      1861	186	188	189	333
      1918	194	191	192	222
      1964	198	199	197	333
      2125	211	213	210	333
      2165	218	216	219	222
      2226	223	220	221	222
      2264	228	229	227	333
      2323	232	234	230	333
      2476	249	245	246	111
