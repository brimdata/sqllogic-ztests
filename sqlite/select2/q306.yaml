vector: true

script: |
  super -f text -I q306.spq | sort > q306.out

inputs:
  - name: q306.spq
    data: |
      SELECT a,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(b-c),
      c-d
      FROM t1 (FORMAT parquet)
      WHERE a>b;
  - name: t1

outputs:
  - name: q306.out
    data: |
      107	1050	1	-2
      131	1300	4	1
      149	1450	2	-
      153	1510	1	-
      159	1580	3	-
      163	1600	1	-3
      168	1670	1	-
      174	1700	2	1
      179	358	1	-
      182	364	3	1
      188	376	1	2
      199	398	3	-1
      213	426	3	2
      229	458	3	-1
      234	468	1	-2
      239	2360	-	-
      243	486	4	-
