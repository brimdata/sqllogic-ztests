vector: true

script: |
  super -f text -I q759.spq | sort > q759.out

inputs:
  - name: q759.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      c-d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      b
      FROM t1 (FORMAT parquet)
      WHERE c>d;
  - name: t1

outputs:
  - name: q759.out
    data: |
      -	1	555	-	-	-	-
      -	1	555	-	-	-	206
      -	3	333	117	-	-	-
      1226	1	333	-	1240	-	124
      1325	1	444	132	1300	132	130
      1371	1	111	135	1390	137	139
      1411	1	111	144	1430	142	143
      1714	1	555	173	1700	172	170
      1828	1	333	180	364	182	181
      1861	2	444	189	376	187	186
      1918	3	444	192	382	192	194
      2125	2	222	210	426	212	211
      2226	2	444	221	440	222	223
