script: |
  super -f text -I q293.spq | sort > q293.out

inputs:
  - name: q293.spq
    data: |
      SELECT c,
      c-d,
      a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q293.out
    data: |
      -	-	239	444
      102	1	104	444
      106	-2	107	333
      113	-1	-	444
      119	3	115	444
      123	1	121	222
      125	-3	127	222
      134	1	131	333
      137	1	138	222
      141	1	142	222
      147	-	149	444
      150	-	153	333
      155	-	159	333
      161	-3	163	444
      166	-	168	333
      172	1	174	444
      176	-	179	444
      184	1	182	333
      187	2	188	333
      193	3	191	222
      195	-1	199	333
      202	-1	201	444
      208	1	-	444
      214	2	213	333
      215	-2	216	222
      224	2	220	222
      225	-1	229	333
      231	-2	234	333
      244	-	243	444
      247	-1	245	111
