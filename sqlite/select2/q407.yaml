vector: true

script: |
  super -f text -I q407.spq | sort > q407.out

inputs:
  - name: q407.spq
    data: |
      SELECT a+b*2,
      abs(a),
      b,
      c,
      d,
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      AND c BETWEEN b-2 AND d+2
      AND b IS NOT NULL;
  - name: t1

outputs:
  - name: q407.out
    data: |
      317	107	105	106	108	635
      483	163	160	161	164	966
      560	188	186	187	185	1121
      635	213	211	214	212	1277
      666	220	223	224	222	1338
      698	234	232	231	233	1391
