script: |
  super -f text -I q82.spq | sort > q82.out

inputs:
  - name: q82.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(b-c)
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      OR c BETWEEN b-2 AND d+2;
  - name: t1

outputs:
  - name: q82.out
    data: |
      -	-	-
      -	-	2
      -	1120	1
      -	1240	1
      -	2360	-
      -	402	-
      1612	1050	1
      1985	1300	4
      2046	1390	2
      2131	1430	2
      2432	1600	1
      2579	1700	2
      2728	364	3
      2806	376	1
      2878	382	1
      2949	398	3
      3175	426	3
      3260	432	3
      3331	440	1
      3399	458	3
      3473	468	1
      3706	490	2
