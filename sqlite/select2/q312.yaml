script: |
  super -f text -I q312.spq | sort > q312.out

inputs:
  - name: q312.spq
    data: |
      SELECT abs(a),
      d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      e
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR coalesce(a,b,c,d,e)<>0;
  - name: t1

outputs:
  - name: q312.out
    data: |
      -	114	444	110
      -	207	444	-
      104	101	444	-
      107	108	333	109
      115	116	444	117
      121	122	222	-
      127	128	222	126
      131	133	333	132
      138	136	222	135
      142	140	222	144
      149	-	444	146
      153	-	333	-
      159	-	333	157
      163	164	444	162
      168	-	333	165
      174	171	444	173
      179	-	444	177
      182	183	333	180
      188	185	333	189
      191	190	222	192
      199	196	333	197
      201	203	444	204
      213	212	333	210
      216	217	222	219
      220	222	222	221
      229	226	333	227
      234	233	333	230
      239	238	444	237
      243	-	444	-
      245	248	111	246
