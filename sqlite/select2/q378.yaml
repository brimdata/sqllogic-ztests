vector: true

script: |
  super -f text -I q378.spq | sort > q378.out

inputs:
  - name: q378.spq
    data: |
      SELECT d,
      d-e,
      a+b*2+c*3+d*4+e*5,
      abs(a),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2,
      b
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0
      OR b>c
      OR a>b;
  - name: t1

outputs:
  - name: q378.out
    data: |
      -	-	-	149	444	439	145
      -	-	-	153	333	455	151
      -	-	-	159	333	475	158
      -	-	-	168	333	502	167
      -	-	-	179	444	529	175
      -	-	-	243	444	723	240
      101	-	-	104	444	-	-
      108	-1	1612	107	333	317	105
      114	4	-	-	444	-	112
      116	-1	-	115	444	-	-
      122	-	-	121	222	369	124
      128	2	1902	127	222	385	129
      133	1	1985	131	333	391	130
      136	1	2046	138	222	416	139
      140	-4	2131	142	222	428	143
      164	2	2432	163	444	483	160
      171	-2	2579	174	444	514	170
      183	3	2728	182	333	544	181
      185	-4	2806	188	333	560	186
      190	-2	2878	191	222	579	194
      196	-1	2949	199	333	595	198
      203	-1	-	201	444	-	-
      207	-	-	-	444	-	206
      212	2	3175	213	333	635	211
      217	-2	3260	216	222	652	218
      222	1	3331	220	222	666	223
      226	-1	3399	229	333	685	228
      233	3	3473	234	333	698	232
      238	1	-	239	444	711	236
      248	2	3706	245	111	743	249
