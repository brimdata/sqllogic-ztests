vector: true

script: |
  super -f text -I q996.spq | sort > q996.out

inputs:
  - name: q996.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      e,
      c-d,
      a+b*2+c*3,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR coalesce(a,b,c,d,e)<>0
      OR a IS NULL;
  - name: t1

outputs:
  - name: q996.out
    data: |
      -	-	-	1455	444	3
      -	-	-	905	333	2
      -	-	1	-	444	-
      -	-	1	-	444	-
      -	-	1	738	222	-3
      -	110	-1	-	444	-
      -	117	3	-	444	-
      -	146	-	880	444	4
      -	157	-	940	333	1
      -	165	-	1000	333	1
      -	177	-	1057	444	4
      -	204	-1	-	444	-
      -	237	-	-	444	3
      107	109	-2	635	333	2
      127	126	-3	760	222	-2
      132	132	1	793	333	1
      137	135	1	827	222	-1
      142	144	1	851	222	-1
      162	162	-3	966	444	3
      172	173	1	1030	444	4
      182	180	1	1096	333	1
      187	189	2	1121	333	2
      192	192	3	1158	222	-3
      197	197	-1	1180	333	1
      212	210	2	1277	333	2
      217	219	-2	1297	222	-2
      222	221	2	1338	222	-3
      227	227	-1	1360	333	1
      232	230	-2	1391	333	2
      247	246	-1	1484	111	-4
