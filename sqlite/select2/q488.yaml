vector: true

script: |
  super -f text -I q488.spq | sort > q488.out

inputs:
  - name: q488.spq
    data: |
      SELECT c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR d NOT BETWEEN 110 AND 150;
  - name: t1

outputs:
  - name: q488.out
    data: |
      -	2360
      102	-
      106	1050
      113	1120
      123	1240
      134	1300
      137	1390
      141	1430
      161	1600
      172	1700
      184	364
      187	376
      193	382
      195	398
      202	402
      208	-
      214	426
      215	432
      224	440
      225	458
      231	468
      247	490
