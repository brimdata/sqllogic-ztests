vector: true

script: |
  super -f text -I q151.spq | sort > q151.out

inputs:
  - name: q151.spq
    data: |
      SELECT abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150;
  - name: t1

outputs:
  - name: q151.out
    data: |
      -	-
      104	-
      107	1050
      163	1600
      174	1700
      182	364
      188	376
      191	382
      199	398
      201	402
      213	426
      216	432
      220	440
      229	458
      234	468
      239	2360
      245	490
