vector: true

script: |
  super -f text -I q360.spq | sort > q360.out

inputs:
  - name: q360.spq
    data: |
      SELECT b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q360.out
    data: |
      -	444	-
      -	444	-
      -	444	-
      105	333	317
      112	444	-
      124	222	369
      129	222	385
      130	333	391
      139	222	416
      143	222	428
      145	444	439
      151	333	455
      158	333	475
      160	444	483
      167	333	502
      170	444	514
      175	444	529
      181	333	544
      186	333	560
      194	222	579
      198	333	595
      206	444	-
      211	333	635
      218	222	652
      223	222	666
      228	333	685
      232	333	698
      236	444	711
      240	444	723
      249	111	743
