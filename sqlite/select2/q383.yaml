script: |
  super -f text -I q383.spq | sort > q383.out

inputs:
  - name: q383.spq
    data: |
      SELECT e,
      a+b*2,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      a-b,
      abs(a),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q383.out
    data: |
      -	-	-	-	-	-	555
      -	-	-	-	-	104	555
      -	369	1240	-	-3	121	333
      -	455	1510	-	2	153	555
      -	723	486	-	3	243	222
      109	317	1050	107	2	107	333
      110	-	1120	-	-	-	555
      117	-	-	-	-	115	333
      126	385	1290	127	-2	127	333
      132	391	1300	132	1	131	444
      135	416	1390	137	-1	138	111
      144	428	1430	142	-1	142	111
      146	439	1450	-	4	149	555
      157	475	1580	-	1	159	555
      162	483	1600	162	3	163	333
      165	502	1670	-	1	168	555
      173	514	1700	172	4	174	555
      177	529	358	-	4	179	555
      180	544	364	182	1	182	333
      189	560	376	187	2	188	444
      192	579	382	192	-3	191	444
      197	595	398	197	1	199	555
      204	-	402	-	-	201	222
      210	635	426	212	2	213	222
      219	652	432	217	-2	216	333
      221	666	440	222	-3	220	444
      227	685	458	227	1	229	555
      230	698	468	232	2	234	555
      237	711	2360	-	3	239	555
      246	743	490	247	-4	245	444
