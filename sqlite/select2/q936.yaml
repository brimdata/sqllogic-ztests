vector: true

script: |
  super -f text -I q936.spq | sort > q936.out

inputs:
  - name: q936.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(b-c),
      e,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q936.out
    data: |
      -	1120	1	110	-
      -	1580	3	157	-
      -	2360	-	237	-
      -	358	1	177	-
      -	402	-	204	-
      1067	1050	1	109	1612
      1272	1290	4	126	1902
      1325	1300	4	132	1985
      1371	1390	2	135	2046
      1411	1430	2	144	2131
      1622	1600	1	162	2432
      1714	1700	2	173	2579
      1828	364	3	180	2728
      1861	376	1	189	2806
      1964	398	3	197	2949
      2125	426	3	210	3175
      2165	432	3	219	3260
      2226	440	1	221	3331
      2264	458	3	227	3399
      2323	468	1	230	3473
      2476	490	2	246	3706
