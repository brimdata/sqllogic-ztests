script: |
  super -f text -I q148.spq | sort > q148.out

inputs:
  - name: q148.spq
    data: |
      SELECT d,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q148.out
    data: |
      -	147	1450	-
      -	150	1510	-
      -	155	1580	-
      -	166	1670	-
      -	176	358	-
      -	244	486	-
      101	102	-	-
      108	106	1050	1612
      114	113	1120	-
      116	119	-	-
      122	123	1240	-
      128	125	1290	1902
      133	134	1300	1985
      136	137	1390	2046
      140	141	1430	2131
      164	161	1600	2432
      171	172	1700	2579
      183	184	364	2728
      185	187	376	2806
      190	193	382	2878
      196	195	398	2949
      203	202	402	-
      207	208	-	-
      212	214	426	3175
      217	215	432	3260
      222	224	440	3331
      226	225	458	3399
      233	231	468	3473
      238	-	2360	-
      248	247	490	3706
