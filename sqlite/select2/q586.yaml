vector: true

script: |
  super -f text -I q586.spq | sort > q586.out

inputs:
  - name: q586.spq
    data: |
      SELECT c-d,
      d,
      abs(b-c),
      d-e,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b-c
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0
      AND (e>c OR e<d);
  - name: t1

outputs:
  - name: q586.out
    data: |
      -	-	1	-	555	-1
      -	-	3	-	555	3
      -	238	-	1	555	-
      -1	114	1	4	555	-1
      -1	196	3	-1	555	3
      -1	203	-	-1	222	-
      -1	226	3	-1	555	3
      -1	248	2	2	444	2
      -2	108	1	-1	333	-1
      -2	217	3	-2	333	3
      -2	233	1	3	555	1
      -3	128	4	2	333	4
      -3	164	1	2	333	-1
      1	133	4	1	444	-4
      1	136	2	1	111	2
      1	140	2	-4	111	2
      1	171	2	-2	555	-2
      1	183	3	3	333	-3
      2	185	1	-4	444	-1
      2	212	3	2	222	-3
      2	222	1	1	444	-1
