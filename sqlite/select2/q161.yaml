vector: true

script: |
  super -f text -I q161.spq | sort > q161.out

inputs:
  - name: q161.spq
    data: |
      SELECT b,
      d,
      a,
      c,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4+e*5,
      abs(a)
      FROM t1 (FORMAT parquet)
      WHERE d>e
      OR a IS NULL;
  - name: t1

outputs:
  - name: q161.out
    data: |
      112	114	-	113	444	-	-
      129	128	127	125	222	1902	127
      130	133	131	134	333	1985	131
      139	136	138	137	222	2046	138
      160	164	163	161	444	2432	163
      181	183	182	184	333	2728	182
      206	207	-	208	444	-	-
      211	212	213	214	333	3175	213
      223	222	220	224	222	3331	220
      232	233	234	231	333	3473	234
      236	238	239	-	444	-	239
      249	248	245	247	111	3706	245
