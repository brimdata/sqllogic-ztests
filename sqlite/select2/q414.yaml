vector: true

script: |
  super -f text -I q414.spq | sort > q414.out

inputs:
  - name: q414.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b,
      a,
      d-e,
      e,
      c
      FROM t1 (FORMAT parquet)
      WHERE c>d;
  - name: t1

outputs:
  - name: q414.out
    data: |
      222	124	121	-	-	123
      222	139	138	1	135	137
      222	143	142	-4	144	141
      222	194	191	-2	192	193
      222	223	220	1	221	224
      333	130	131	1	132	134
      333	181	182	3	180	184
      333	186	188	-4	189	187
      333	211	213	2	210	214
      444	-	104	-	-	102
      444	-	115	-1	117	119
      444	170	174	-2	173	172
      444	206	-	-	-	208
