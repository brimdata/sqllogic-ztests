vector: true

script: |
  super -f text -I q868.spq | sort > q868.out

inputs:
  - name: q868.spq
    data: |
      SELECT a+b*2,
      abs(b-c),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q868.out
    data: |
      -	-	444	101	-
      -	-	444	116	-
      -	-	444	203	-
      -	1	444	114	-
      -	2	444	207	-
      317	1	333	108	107
      369	1	222	122	-
      385	4	222	128	127
      391	4	333	133	132
      416	2	222	136	137
      428	2	222	140	142
      439	2	444	-	-
      455	1	333	-	-
      475	3	333	-	-
      483	1	444	164	162
      502	1	333	-	-
      514	2	444	171	172
      529	1	444	-	-
      544	3	333	183	182
      560	1	333	185	187
      579	1	222	190	192
      595	3	333	196	197
      635	3	333	212	212
      652	3	222	217	217
      666	1	222	222	222
      685	3	333	226	227
      698	1	333	233	232
      711	-	444	238	-
      723	4	444	-	-
      743	2	111	248	247
