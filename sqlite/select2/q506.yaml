vector: true

script: |
  super -f text -I q506.spq | sort > q506.out

inputs:
  - name: q506.spq
    data: |
      SELECT a+b*2,
      c-d,
      e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q506.out
    data: |
      -	-1	110	1120	112	-
      -	-1	204	402	-	-
      317	-2	109	1050	105	107
      385	-3	126	1290	129	127
      391	1	132	1300	130	132
      416	1	135	1390	139	137
      428	1	144	1430	143	142
      475	-	157	1580	158	-
      483	-3	162	1600	160	162
      514	1	173	1700	170	172
      529	-	177	358	175	-
      544	1	180	364	181	182
      560	2	189	376	186	187
      595	-1	197	398	198	197
      635	2	210	426	211	212
      652	-2	219	432	218	217
      666	2	221	440	223	222
      685	-1	227	458	228	227
      698	-2	230	468	232	232
      711	-	237	2360	236	-
      743	-1	246	490	249	247
