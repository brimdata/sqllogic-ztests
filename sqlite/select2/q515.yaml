script: |
  super -f text -I q515.spq | sort > q515.out

inputs:
  - name: q515.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b-c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5,
      a+b*2,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q515.out
    data: |
      -	222	1	1240	-	369	1226
      -	333	1	1510	-	455	-
      -	333	1	1670	-	502	-
      -	333	3	1580	-	475	-
      -	444	-	-	-	-	-
      -	444	-	-	-	-	-
      -	444	-	2360	-	711	-
      -	444	-	402	-	-	-
      -	444	-1	1120	-	-	-
      -	444	-1	358	-	529	-
      -	444	-2	-	-	-	-
      -	444	-2	1450	-	439	-
      -	444	-4	486	-	723	-
      107	333	-1	1050	1612	317	1067
      127	222	4	1290	1902	385	1272
      132	333	-4	1300	1985	391	1325
      137	222	2	1390	2046	416	1371
      142	222	2	1430	2131	428	1411
      162	444	-1	1600	2432	483	1622
      172	444	-2	1700	2579	514	1714
      182	333	-3	364	2728	544	1828
      187	333	-1	376	2806	560	1861
      192	222	1	382	2878	579	1918
      197	333	3	398	2949	595	1964
      212	333	-3	426	3175	635	2125
      217	222	3	432	3260	652	2165
      222	222	-1	440	3331	666	2226
      227	333	3	458	3399	685	2264
      232	333	1	468	3473	698	2323
      247	111	2	490	3706	743	2476
