script: |
  super -f text -I q677.spq | sort > q677.out

inputs:
  - name: q677.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a+b*2+c*3,
      a+b*2
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0
      AND a>b
      AND b IS NOT NULL;
  - name: t1

outputs:
  - name: q677.out
    data: |
      222	1277	635
      222	1455	723
      333	1096	544
      333	635	317
      333	966	483
      444	1121	560
      444	793	391
      555	-	711
      555	1000	502
      555	1030	514
      555	1057	529
      555	1180	595
      555	1360	685
      555	1391	698
      555	880	439
      555	905	455
      555	940	475
