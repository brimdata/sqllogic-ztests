vector: true

script: |
  super -f text -I q913.spq | sort > q913.out

inputs:
  - name: q913.spq
    data: |
      SELECT a-b,
      a+b*2+c*3+d*4+e*5,
      a+b*2,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      c-d,
      b-c
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q913.out
    data: |
      -	-	-	444	-1	-
      -	-	-	444	-1	-1
      -	-	-	444	1	-
      -	-	-	444	1	-2
      -	-	-	444	3	-
      -1	2046	416	222	1	2
      -1	2131	428	222	1	2
      -2	1902	385	222	-3	4
      -2	3260	652	222	-2	3
      -3	-	369	222	1	1
      -3	2878	579	222	3	1
      -3	3331	666	222	2	-1
      -4	3706	743	111	-1	2
      1	-	475	333	-	3
      1	-	502	333	-	1
      1	1985	391	333	1	-4
      1	2728	544	333	1	-3
      1	2949	595	333	-1	3
      1	3399	685	333	-1	3
      2	-	455	333	-	1
      2	1612	317	333	-2	-1
      2	2806	560	333	2	-1
      2	3175	635	333	2	-3
      2	3473	698	333	-2	1
      3	-	711	444	-	-
      3	-	723	444	-	-4
      3	2432	483	444	-3	-1
      4	-	439	444	-	-2
      4	-	529	444	-	-1
      4	2579	514	444	1	-2
