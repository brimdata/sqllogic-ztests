vector: true

script: |
  super -f text -I q876.spq | sort > q876.out

inputs:
  - name: q876.spq
    data: |
      SELECT a-b,
      a,
      a+b*2+c*3,
      abs(a),
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b-c
      FROM t1 (FORMAT parquet)
      WHERE b IS NOT NULL
      AND (e>c OR e<d)
      AND c>d;
  - name: t1

outputs:
  - name: q876.out
    data: |
      -1	138	827	138	1390	2
      -1	142	851	142	1430	2
      -3	220	1338	220	440	-1
      1	131	793	131	1300	-4
      1	182	1096	182	364	-3
      2	188	1121	188	376	-1
      2	213	1277	213	426	-3
      4	174	1030	174	1700	-2
