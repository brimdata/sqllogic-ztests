script: |
  super -f text -I q471.spq | sort > q471.out

inputs:
  - name: q471.spq
    data: |
      SELECT a+b*2+c*3,
      e,
      c-d,
      d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      AND b IS NOT NULL;
  - name: t1

outputs:
  - name: q471.out
    data: |
      -	-	1	207	444	-	-
      -	237	-	238	444	239	-
      1030	173	1	171	444	174	1714
      1096	180	1	183	333	182	1828
      1121	189	2	185	333	188	1861
      1158	192	3	190	222	191	1918
      1180	197	-1	196	333	199	1964
      1277	210	2	212	333	213	2125
      1297	219	-2	217	222	216	2165
      1338	221	2	222	222	220	2226
      1360	227	-1	226	333	229	2264
      1391	230	-2	233	333	234	2323
      1484	246	-1	248	111	245	2476
      635	109	-2	108	333	107	1067
      966	162	-3	164	444	163	1622
