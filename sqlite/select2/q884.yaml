script: |
  super -f text -I q884.spq | sort > q884.out

inputs:
  - name: q884.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b,
      c,
      a+b*2
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q884.out
    data: |
      111	139	137	416
      111	143	141	428
      222	-	202	-
      222	211	214	635
      222	240	244	723
      333	-	119	-
      333	105	106	317
      333	124	123	369
      333	129	125	385
      333	160	161	483
      333	181	184	544
      333	218	215	652
      444	130	134	391
      444	186	187	560
      444	194	193	579
      444	223	224	666
      444	249	247	743
      555	-	102	-
      555	112	113	-
      555	145	147	439
      555	151	150	455
      555	158	155	475
      555	167	166	502
      555	170	172	514
      555	175	176	529
      555	198	195	595
      555	206	208	-
      555	228	225	685
      555	232	231	698
      555	236	-	711
