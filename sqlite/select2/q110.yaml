vector: true

script: |
  super -f text -I q110.spq | sort > q110.out

inputs:
  - name: q110.spq
    data: |
      SELECT a+b*2+c*3,
      abs(b-c),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a
      FROM t1 (FORMAT parquet)
      WHERE b IS NOT NULL;
  - name: t1

outputs:
  - name: q110.out
    data: |
      -	-	555	2360	239
      -	1	555	1120	-
      -	2	555	-	-
      1000	1	555	1670	168
      1030	2	555	1700	174
      1057	1	555	358	179
      1096	3	333	364	182
      1121	1	444	376	188
      1158	1	444	382	191
      1180	3	555	398	199
      1277	3	222	426	213
      1297	3	333	432	216
      1338	1	444	440	220
      1360	3	555	458	229
      1391	1	555	468	234
      1455	4	222	486	243
      1484	2	444	490	245
      635	1	333	1050	107
      738	1	333	1240	121
      760	4	333	1290	127
      793	4	444	1300	131
      827	2	111	1390	138
      851	2	111	1430	142
      880	2	555	1450	149
      905	1	555	1510	153
      940	3	555	1580	159
      966	1	333	1600	163
