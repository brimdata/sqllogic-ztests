vector: true

script: |
  super -f text -I q553.spq | sort > q553.out

inputs:
  - name: q553.spq
    data: |
      SELECT b,
      (a+b+c+d+e)/5,
      a-b,
      a+b*2+c*3+d*4+e*5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d-e
      FROM t1 (FORMAT parquet)
      WHERE d>e;
  - name: t1

outputs:
  - name: q553.out
    data: |
      112	-	-	-	444	4
      129	127	-2	1902	222	2
      130	132	1	1985	333	1
      139	137	-1	2046	222	1
      160	162	3	2432	444	2
      181	182	1	2728	333	3
      211	212	2	3175	333	2
      223	222	-3	3331	222	1
      232	232	2	3473	333	3
      236	-	3	-	444	1
      249	247	-4	3706	111	2
