script: |
  super -f text -I q892.spq | sort > q892.out

inputs:
  - name: q892.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q892.out
    data: |
      -	-	-
      -	-	-
      -	-	-
      1050	1612	1067
      1120	-	-
      1240	-	1226
      1290	1902	1272
      1300	1985	1325
      1390	2046	1371
      1430	2131	1411
      1450	-	-
      1510	-	-
      1580	-	-
      1600	2432	1622
      1670	-	-
      1700	2579	1714
      2360	-	-
      358	-	-
      364	2728	1828
      376	2806	1861
      382	2878	1918
      398	2949	1964
      402	-	-
      426	3175	2125
      432	3260	2165
      440	3331	2226
      458	3399	2264
      468	3473	2323
      486	-	-
      490	3706	2476
