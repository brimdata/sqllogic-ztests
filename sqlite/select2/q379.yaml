script: |
  super -f text -I q379.spq | sort > q379.out

inputs:
  - name: q379.spq
    data: |
      SELECT d,
      c,
      a+b*2+c*3+d*4,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      abs(a),
      e
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q379.out
    data: |
      -	147	-	555	149	146
      -	150	-	555	153	-
      -	155	-	555	159	157
      -	166	-	555	168	165
      -	176	-	555	179	177
      -	244	-	222	243	-
      101	102	-	555	104	-
      108	106	1067	333	107	109
      114	113	-	555	-	110
      116	119	-	333	115	117
      122	123	1226	333	121	-
      128	125	1272	333	127	126
      133	134	1325	444	131	132
      136	137	1371	111	138	135
      140	141	1411	111	142	144
      164	161	1622	333	163	162
      171	172	1714	555	174	173
      183	184	1828	333	182	180
      185	187	1861	444	188	189
      190	193	1918	444	191	192
      196	195	1964	555	199	197
      203	202	-	222	201	204
      207	208	-	555	-	-
      212	214	2125	222	213	210
      217	215	2165	333	216	219
      222	224	2226	444	220	221
      226	225	2264	555	229	227
      233	231	2323	555	234	230
      238	-	-	555	239	237
      248	247	2476	444	245	246
