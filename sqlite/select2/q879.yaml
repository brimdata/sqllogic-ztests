script: |
  super -f text -I q879.spq | sort > q879.out

inputs:
  - name: q879.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      a+b*2+c*3,
      b,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(b-c),
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q879.out
    data: |
      -	-	-	-	-	-
      -	-	-	-	-	-
      -	-	-	402	-	-
      -	-	112	1120	1	-
      -	-	206	-	2	-
      -	-	236	2360	-	-
      -	1000	167	1670	1	-
      -	1057	175	358	1	-
      -	1455	240	486	4	-
      -	738	124	1240	1	-
      -	880	145	1450	2	-
      -	905	151	1510	1	-
      -	940	158	1580	3	-
      1612	635	105	1050	1	107
      1902	760	129	1290	4	127
      1985	793	130	1300	4	132
      2046	827	139	1390	2	137
      2131	851	143	1430	2	142
      2432	966	160	1600	1	162
      2579	1030	170	1700	2	172
      2728	1096	181	364	3	182
      2806	1121	186	376	1	187
      2878	1158	194	382	1	192
      2949	1180	198	398	3	197
      3175	1277	211	426	3	212
      3260	1297	218	432	3	217
      3331	1338	223	440	1	222
      3399	1360	228	458	3	227
      3473	1391	232	468	1	232
      3706	1484	249	490	2	247
