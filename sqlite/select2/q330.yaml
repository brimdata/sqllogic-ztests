script: |
  super -f text -I q330.spq | sort > q330.out

inputs:
  - name: q330.spq
    data: |
      SELECT a+b*2,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      (a+b+c+d+e)/5,
      a+b*2+c*3,
      b-c,
      a
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150;
  - name: t1

outputs:
  - name: q330.out
    data: |
      -	444	-	-	-	104
      -	444	-	-	-	201
      -	444	-	-	-2	-
      317	333	107	635	-1	107
      483	444	162	966	-1	163
      514	444	172	1030	-2	174
      544	333	182	1096	-3	182
      560	333	187	1121	-1	188
      579	222	192	1158	1	191
      595	333	197	1180	3	199
      635	333	212	1277	-3	213
      652	222	217	1297	3	216
      666	222	222	1338	-1	220
      685	333	227	1360	3	229
      698	333	232	1391	1	234
      711	444	-	-	-	239
      743	111	247	1484	2	245
