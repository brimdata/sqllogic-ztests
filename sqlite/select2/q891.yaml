script: |
  super -f text -I q891.spq | sort > q891.out

inputs:
  - name: q891.spq
    data: |
      SELECT a-b,
      c-d,
      (a+b+c+d+e)/5,
      a+b*2+c*3+d*4+e*5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      d
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q891.out
    data: |
      -	-1	-	-	222	203
      -	-1	-	-	555	114
      -	1	-	-	555	101
      -	1	-	-	555	207
      -	3	-	-	333	116
      -1	1	137	2046	111	136
      -1	1	142	2131	111	140
      -2	-2	217	3260	333	217
      -2	-3	127	1902	333	128
      -3	1	-	-	333	122
      -3	2	222	3331	444	222
      -3	3	192	2878	444	190
      -4	-1	247	3706	444	248
      1	-	-	-	555	-
      1	-	-	-	555	-
      1	-1	197	2949	555	196
      1	-1	227	3399	555	226
      1	1	132	1985	444	133
      1	1	182	2728	333	183
      2	-	-	-	555	-
      2	-2	107	1612	333	108
      2	-2	232	3473	555	233
      2	2	187	2806	444	185
      2	2	212	3175	222	212
      3	-	-	-	222	-
      3	-	-	-	555	238
      3	-3	162	2432	333	164
      4	-	-	-	555	-
      4	-	-	-	555	-
      4	1	172	2579	555	171
