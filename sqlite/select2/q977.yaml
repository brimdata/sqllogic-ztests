script: |
  super -f text -I q977.spq | sort > q977.out

inputs:
  - name: q977.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a),
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0;
  - name: t1

outputs:
  - name: q977.out
    data: |
      111	245	1484
      222	121	738
      222	127	760
      222	138	827
      222	142	851
      222	191	1158
      222	216	1297
      222	220	1338
      333	107	635
      333	131	793
      333	153	905
      333	159	940
      333	168	1000
      333	182	1096
      333	188	1121
      333	199	1180
      333	213	1277
      333	229	1360
      333	234	1391
      444	-	-
      444	-	-
      444	104	-
      444	115	-
      444	149	880
      444	163	966
      444	174	1030
      444	179	1057
      444	201	-
      444	239	-
      444	243	1455
