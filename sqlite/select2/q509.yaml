vector: true

script: |
  super -f text -I q509.spq | sort > q509.out

inputs:
  - name: q509.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      (a+b+c+d+e)/5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      AND b>c;
  - name: t1

outputs:
  - name: q509.out
    data: |
      -	-	1580	-
      1902	127	1290	-3
      2046	137	1390	1
      2131	142	1430	1
      2949	197	398	-1
      3260	217	432	-2
      3399	227	458	-1
      3473	232	468	-2
      3706	247	490	-1
