script: |
  super -f text -I q816.spq | sort > q816.out

inputs:
  - name: q816.spq
    data: |
      SELECT c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2,
      a-b
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      OR e+d BETWEEN a+b-10 AND c+130;
  - name: t1

outputs:
  - name: q816.out
    data: |
      -	2360	711	3
      102	-	-	-
      106	1050	317	2
      125	1290	385	-2
      161	1600	483	3
      172	1700	514	4
      184	364	544	1
      187	376	560	2
      193	382	579	-3
      195	398	595	1
      202	402	-	-
      208	-	-	-
      214	426	635	2
      215	432	652	-2
      224	440	666	-3
      225	458	685	1
      231	468	698	2
      247	490	743	-4
