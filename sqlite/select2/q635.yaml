vector: true

script: |
  super -f text -I q635.spq | sort > q635.out

inputs:
  - name: q635.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      c,
      a+b*2,
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d);
  - name: t1

outputs:
  - name: q635.out
    data: |
      1050	106	317	635
      1120	113	-	-
      1290	125	385	760
      1300	134	391	793
      1390	137	416	827
      1430	141	428	851
      1580	155	475	940
      1600	161	483	966
      1700	172	514	1030
      2360	-	711	-
      358	176	529	1057
      364	184	544	1096
      376	187	560	1121
      398	195	595	1180
      402	202	-	-
      426	214	635	1277
      432	215	652	1297
      440	224	666	1338
      458	225	685	1360
      468	231	698	1391
      490	247	743	1484
