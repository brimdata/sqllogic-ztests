script: |
  super -f text -I q518.spq | sort > q518.out

inputs:
  - name: q518.spq
    data: |
      SELECT CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(b-c),
      d,
      e,
      d-e
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q518.out
    data: |
      111	2	248	246	2
      222	1	122	-	-
      222	1	190	192	-2
      222	1	222	221	1
      222	2	136	135	1
      222	2	140	144	-4
      222	3	217	219	-2
      222	4	128	126	2
      333	1	-	-	-
      333	1	-	165	-
      333	1	108	109	-1
      333	1	185	189	-4
      333	1	233	230	3
      333	3	-	157	-
      333	3	183	180	3
      333	3	196	197	-1
      333	3	212	210	2
      333	3	226	227	-1
      333	4	133	132	1
      444	-	101	-	-
      444	-	116	117	-1
      444	-	203	204	-1
      444	-	238	237	1
      444	1	-	177	-
      444	1	114	110	4
      444	1	164	162	2
      444	2	-	146	-
      444	2	171	173	-2
      444	2	207	-	-
      444	4	-	-	-
