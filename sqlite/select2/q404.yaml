vector: true

script: |
  super -f text -I q404.spq | sort > q404.out

inputs:
  - name: q404.spq
    data: |
      SELECT d-e,
      b-c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(a),
      e
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150;
  - name: t1

outputs:
  - name: q404.out
    data: |
      -	-	-	444	104	-
      -	-2	-	444	-	-
      -1	-	402	444	201	204
      -1	-1	1050	333	107	109
      -1	3	398	333	199	197
      -1	3	458	333	229	227
      -2	-2	1700	444	174	173
      -2	1	382	222	191	192
      -2	3	432	222	216	219
      -4	-1	376	333	188	189
      1	-	2360	444	239	237
      1	-1	440	222	220	221
      2	-1	1600	444	163	162
      2	-3	426	333	213	210
      2	2	490	111	245	246
      3	-3	364	333	182	180
      3	1	468	333	234	230
