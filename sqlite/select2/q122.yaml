vector: true

script: |
  super -f text -I q122.spq | sort > q122.out

inputs:
  - name: q122.spq
    data: |
      SELECT d-e,
      abs(b-c),
      a+b*2+c*3,
      a+b*2,
      a-b
      FROM t1 (FORMAT parquet)
      WHERE coalesce(a,b,c,d,e)<>0;
  - name: t1

outputs:
  - name: q122.out
    data: |
      -	-	-	-	-
      -	1	1000	502	1
      -	1	1057	529	4
      -	1	738	369	-3
      -	1	905	455	2
      -	2	-	-	-
      -	2	880	439	4
      -	3	940	475	1
      -	4	1455	723	3
      -1	-	-	-	-
      -1	-	-	-	-
      -1	1	635	317	2
      -1	3	1180	595	1
      -1	3	1360	685	1
      -2	1	1158	579	-3
      -2	2	1030	514	4
      -2	3	1297	652	-2
      -4	1	1121	560	2
      -4	2	851	428	-1
      1	-	-	711	3
      1	1	1338	666	-3
      1	2	827	416	-1
      1	4	793	391	1
      2	1	966	483	3
      2	2	1484	743	-4
      2	3	1277	635	2
      2	4	760	385	-2
      3	1	1391	698	2
      3	3	1096	544	1
      4	1	-	-	-
