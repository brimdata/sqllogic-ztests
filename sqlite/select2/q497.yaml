vector: true

script: |
  super -f text -I q497.spq | sort > q497.out

inputs:
  - name: q497.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      c,
      a+b*2+c*3+d*4+e*5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE b>c
      AND (e>c OR e<d);
  - name: t1

outputs:
  - name: q497.out
    data: |
      -	155	-	1580
      1272	125	1902	1290
      1371	137	2046	1390
      1411	141	2131	1430
      1964	195	2949	398
      2165	215	3260	432
      2264	225	3399	458
      2323	231	3473	468
      2476	247	3706	490
