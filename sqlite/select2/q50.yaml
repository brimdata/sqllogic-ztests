vector: true

script: |
  super -f text -I q50.spq | sort > q50.out

inputs:
  - name: q50.spq
    data: |
      SELECT a+b*2,
      d-e,
      a-b,
      abs(a),
      (a+b+c+d+e)/5,
      c
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      AND c BETWEEN b-2 AND d+2
      AND coalesce(a,b,c,d,e)<>0;
  - name: t1

outputs:
  - name: q50.out
    data: |
      317	-1	2	107	107	106
      483	2	3	163	162	161
      560	-4	2	188	187	187
      635	2	2	213	212	214
      666	1	-3	220	222	224
      698	3	2	234	232	231
