vector: true

script: |
  super -f text -I q455.spq | sort > q455.out

inputs:
  - name: q455.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q455.out
    data: |
      -	-
      -	-
      -	-
      -	1120
      -	1240
      -	1450
      -	1510
      -	1580
      -	1670
      -	2360
      -	358
      -	402
      -	486
      107	1050
      127	1290
      132	1300
      137	1390
      142	1430
      162	1600
      172	1700
      182	364
      187	376
      192	382
      197	398
      212	426
      217	432
      222	440
      227	458
      232	468
      247	490
