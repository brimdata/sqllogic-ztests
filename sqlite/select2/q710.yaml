script: |
  super -f text -I q710.spq | sort > q710.out

inputs:
  - name: q710.spq
    data: |
      SELECT a+b*2,
      d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(b-c),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      a,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet);
  - name: t1

outputs:
  - name: q710.out
    data: |
      -	101	444	-	555	104	-
      -	114	444	1	555	-	-
      -	116	444	-	333	115	-
      -	203	444	-	222	201	-
      -	207	444	2	555	-	-
      317	108	333	1	333	107	1067
      369	122	222	1	333	121	1226
      385	128	222	4	333	127	1272
      391	133	333	4	444	131	1325
      416	136	222	2	111	138	1371
      428	140	222	2	111	142	1411
      439	-	444	2	555	149	-
      455	-	333	1	555	153	-
      475	-	333	3	555	159	-
      483	164	444	1	333	163	1622
      502	-	333	1	555	168	-
      514	171	444	2	555	174	1714
      529	-	444	1	555	179	-
      544	183	333	3	333	182	1828
      560	185	333	1	444	188	1861
      579	190	222	1	444	191	1918
      595	196	333	3	555	199	1964
      635	212	333	3	222	213	2125
      652	217	222	3	333	216	2165
      666	222	222	1	444	220	2226
      685	226	333	3	555	229	2264
      698	233	333	1	555	234	2323
      711	238	444	-	555	239	-
      723	-	444	4	222	243	-
      743	248	111	2	444	245	2476
