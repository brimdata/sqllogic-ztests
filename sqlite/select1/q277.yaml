script: |
  super -f text -I q277.spq > q277.out

inputs:
  - name: q277.spq
    data: |
      SELECT abs(b-c),
      a-b,
      (a+b+c+d+e)/5
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      OR (a>b-2 AND a<b+2)
      ORDER BY 2,1,3;
  - name: t1

outputs:
  - name: q277.out
    data: |
      2	-4	247
      1	-3	122
      1	-3	222
      1	-1	112
      2	-1	137
      2	-1	142
      2	-1	207
      1	1	167
      2	1	202
      3	1	157
      3	1	182
      3	1	197
      3	1	227
      4	1	132
      1	2	107
      1	2	152
      1	2	187
      1	2	232
      3	2	212
      1	3	162
      1	3	237
      1	4	177
      2	4	102
      2	4	147
      2	4	172
