script: |
  super -f text -I q131.spq > q131.out

inputs:
  - name: q131.spq
    data: |
      SELECT d-e,
      (a+b+c+d+e)/5,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      d
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      ORDER BY 2,1,3,4;
  - name: t1

outputs:
  - name: q131.out
    data: |
      -2	102	555	101
      -1	107	333	108
      4	112	111	114
      2	122	333	122
      2	127	333	128
      1	132	444	133
      1	137	111	136
      -4	142	111	140
      2	147	555	148
      2	152	333	154
      -1	157	555	156
      2	162	333	164
      4	167	333	169
      -2	172	555	171
      1	177	555	178
      3	182	333	183
      -4	187	444	185
      -1	197	555	196
      -1	202	222	203
      -2	207	111	207
      2	212	222	212
      -2	217	333	217
      1	222	444	222
      -1	227	555	226
      3	232	555	233
      1	237	555	238
      2	247	444	248
