vector: true

script: |
  super -f text -I q504.spq > q504.out

inputs:
  - name: q504.spq
    data: |
      SELECT (a+b+c+d+e)/5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      c
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      OR e+d BETWEEN a+b-10 AND c+130
      ORDER BY 3,2,1;
  - name: t1

outputs:
  - name: q504.out
    data: |
      102	444	102
      107	333	106
      112	222	113
      117	222	119
      122	222	123
      127	222	125
      152	333	150
      162	444	161
      167	333	166
      177	444	176
      187	333	187
      192	222	193
      212	333	214
      217	222	215
      222	222	224
      232	333	231
      237	444	235
      242	444	244
