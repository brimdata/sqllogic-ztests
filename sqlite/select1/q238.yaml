vector: true

script: |
  super -f text -I q238.spq > q238.out

inputs:
  - name: q238.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a-b,
      abs(b-c)
      FROM t1 (FORMAT parquet)
      WHERE c>d
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 2,1,3;
  - name: t1

outputs:
  - name: q238.out
    data: |
      382	-3	1
      440	-3	1
      1180	-3	1
      1240	-3	1
      432	-2	3
      1290	-2	4
      410	-1	2
      1390	-1	2
      1430	-1	2
      364	1	3
      1300	1	4
      1670	1	1
      376	2	1
      426	2	3
      468	2	1
      1050	2	1
      1510	2	1
      478	3	1
      486	3	4
      1600	3	1
      358	4	1
      1000	4	2
      1700	4	2
