vector: true

script: |
  super -f text -I q663.spq > q663.out

inputs:
  - name: q663.spq
    data: |
      SELECT b-c,
      (a+b+c+d+e)/5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE b>c
      ORDER BY 1,2,3;
  - name: t1

outputs:
  - name: q663.out
    data: |
      1	122	1240
      1	152	1510
      1	167	1670
      1	192	382
      1	232	468
      1	237	478
      2	137	1390
      2	142	1430
      2	247	490
      3	157	1580
      3	197	398
      3	217	432
      3	227	458
      4	127	1290
