vector: true

script: |
  super -f text -I q478.spq > q478.out

inputs:
  - name: q478.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      b,
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE c BETWEEN b-2 AND d+2
      ORDER BY 3,4,2,1;
  - name: t1

outputs:
  - name: q478.out
    data: |
      1529	1000	100	610
      1612	1050	105	635
      1680	1120	112	674
      1826	1240	124	738
      1985	1300	130	793
      2046	1390	139	827
      2131	1430	143	851
      2202	1450	145	880
      2281	1510	151	905
      2432	1600	160	966
      2501	1670	167	1000
      2579	1700	170	1030
      2654	358	175	1057
      2728	364	181	1096
      2806	376	186	1121
      3039	402	200	1207
      3114	410	206	1241
      3175	426	211	1277
      3331	440	223	1338
      3473	468	232	1391
      3553	478	236	1416
      3706	490	249	1484
