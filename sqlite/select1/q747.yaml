vector: true

script: |
  super -f text -I q747.spq > q747.out

inputs:
  - name: q747.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5,
      a+b*2+c*3+d*4,
      a+b*2+c*3,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE (e>a AND e<b)
      OR (e>c OR e<d)
      OR c>d
      ORDER BY 3,2,6,5,4,1;
  - name: t1

outputs:
  - name: q747.out
    data: |
      555	1000	1529	1014	610	1
      333	1050	1612	1067	635	-2
      111	1120	1680	1130	674	-1
      333	1180	1757	1172	708	3
      333	1240	1826	1226	738	1
      333	1290	1902	1272	760	-3
      444	1300	1985	1325	793	1
      111	1390	2046	1371	827	1
      111	1430	2131	1411	851	1
      555	1450	2202	1472	880	-1
      333	1510	2281	1521	905	-4
      555	1580	2349	1564	940	-1
      333	1600	2432	1622	966	-3
      333	1670	2501	1676	1000	-3
      555	1700	2579	1714	1030	1
      555	358	2654	1769	1057	-2
      333	364	2728	1828	1096	1
      444	376	2806	1861	1121	2
      444	382	2878	1918	1158	3
      555	398	2949	1964	1180	-1
      222	402	3039	2019	1207	-1
      111	410	3114	2069	1241	1
      222	426	3175	2125	1277	2
      333	432	3260	2165	1297	-2
      444	440	3331	2226	1338	2
      555	458	3399	2264	1360	-1
      555	468	3473	2323	1391	-2
      555	478	3553	2368	1416	-3
      222	486	3629	2419	1455	3
      444	490	3706	2476	1484	-1
