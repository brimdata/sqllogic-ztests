vector: true

script: |
  super -f text -I q471.spq > q471.out

inputs:
  - name: q471.spq
    data: |
      SELECT e,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4,
      a+b*2+c*3,
      c-d,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE c>d
      ORDER BY 1,2,5,3,4,7,6;
  - name: t1

outputs:
  - name: q471.out
    data: |
      103	444	1014	610	1	1000	555
      117	222	1172	708	3	1180	333
      120	222	1226	738	1	1240	333
      132	333	1325	793	1	1300	444
      135	222	1371	827	1	1390	111
      144	222	1411	851	1	1430	111
      173	444	1714	1030	1	1700	555
      180	333	1828	1096	1	364	333
      189	333	1861	1121	2	376	444
      192	222	1918	1158	3	382	444
      209	222	2069	1241	1	410	111
      210	333	2125	1277	2	426	222
      221	222	2226	1338	2	440	444
      242	444	2419	1455	3	486	222
