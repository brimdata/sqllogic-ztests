vector: true

script: |
  super -f text -I q624.spq > q624.out

inputs:
  - name: q624.spq
    data: |
      SELECT b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(b-c)
      FROM t1 (FORMAT parquet)
      ORDER BY 2,1,3;
  - name: t1

outputs:
  - name: q624.out
    data: |
      249	111	2
      112	222	1
      118	222	1
      124	222	1
      129	222	4
      139	222	2
      143	222	2
      194	222	1
      206	222	2
      218	222	3
      223	222	1
      105	333	1
      130	333	4
      151	333	1
      158	333	3
      167	333	1
      181	333	3
      186	333	1
      198	333	3
      200	333	2
      211	333	3
      228	333	3
      232	333	1
      100	444	2
      145	444	2
      160	444	1
      170	444	2
      175	444	1
      236	444	1
      240	444	4
