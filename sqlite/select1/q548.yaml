script: |
  super -f text -I q548.spq > q548.out

inputs:
  - name: q548.spq
    data: |
      SELECT abs(a),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a-b,
      b,
      a,
      b-c
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      ORDER BY 3,2,4,6,1,5;
  - name: t1

outputs:
  - name: q548.out
    data: |
      115	222	-3	118	115	-1
      121	222	-3	124	121	1
      127	222	-2	129	127	4
      111	222	-1	112	111	-1
      107	333	2	105	107	-1
      104	444	4	100	104	-2
