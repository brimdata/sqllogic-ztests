script: |
  super -f text -I q358.spq > q358.out

inputs:
  - name: q358.spq
    data: |
      SELECT a+b*2+c*3+d*4,
      (a+b+c+d+e)/5,
      abs(b-c)
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      ORDER BY 3,1,2;
  - name: t1

outputs:
  - name: q358.out
    data: |
      1067	107	1
      1172	117	1
      1521	152	1
      1622	162	1
      1676	167	1
      1769	177	1
      1861	187	1
      1918	192	1
      2226	222	1
      2323	232	1
      2368	237	1
      2125	212	3
      2165	217	3
      1272	127	4
      2419	242	4
