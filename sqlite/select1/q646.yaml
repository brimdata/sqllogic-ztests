vector: true

script: |
  super -f text -I q646.spq > q646.out

inputs:
  - name: q646.spq
    data: |
      SELECT d-e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(b-c),
      (a+b+c+d+e)/5,
      c-d
      FROM t1 (FORMAT parquet)
      WHERE a>b
      ORDER BY 1,3,2,4,5;
  - name: t1

outputs:
  - name: q646.out
    data: |
      -4	376	1	187	2
      -2	1000	2	102	1
      -2	1700	2	172	1
      -1	1050	1	107	-2
      -1	402	2	202	-1
      -1	398	3	197	-1
      -1	458	3	227	-1
      -1	1580	3	157	-1
      -1	486	4	242	3
      1	358	1	177	-2
      1	478	1	237	-3
      1	1300	4	132	1
      2	1510	1	152	-4
      2	1600	1	162	-3
      2	1450	2	147	-1
      2	426	3	212	2
      3	468	1	232	-2
      3	364	3	182	1
      4	1670	1	167	-3
