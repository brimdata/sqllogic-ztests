script: |
  super -f text -I q985.spq > q985.out

inputs:
  - name: q985.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR (e>a AND e<b)
      ORDER BY 1,2;
  - name: t1

outputs:
  - name: q985.out
    data: |
      358	529
      364	544
      376	560
      382	579
      398	595
      402	601
      410	617
      426	635
      432	652
      440	666
      458	685
      468	698
      478	711
      490	743
      1000	304
      1050	317
      1120	335
      1180	351
      1240	369
      1290	385
      1300	391
      1390	416
      1430	428
      1450	439
      1510	455
      1580	475
      1600	483
      1670	502
      1700	514
