vector: true

script: |
  super -f text -I q407.spq > q407.out

inputs:
  - name: q407.spq
    data: |
      SELECT e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      (a+b+c+d+e)/5,
      d,
      d-e
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      OR d NOT BETWEEN 110 AND 150
      OR (e>c OR e<d)
      ORDER BY 5,4,2,3,1;
  - name: t1

outputs:
  - name: q407.out
    data: |
      144	1430	142	140	-4
      189	376	187	185	-4
      103	1000	102	101	-2
      173	1700	172	171	-2
      192	382	192	190	-2
      209	410	207	207	-2
      219	432	217	217	-2
      109	1050	107	108	-1
      117	1180	117	116	-1
      157	1580	157	156	-1
      197	398	197	196	-1
      204	402	202	203	-1
      227	458	227	226	-1
      242	486	242	241	-1
      132	1300	132	133	1
      135	1390	137	136	1
      177	358	177	178	1
      221	440	222	222	1
      237	478	237	238	1
      120	1240	122	122	2
      126	1290	127	128	2
      146	1450	147	148	2
      152	1510	152	154	2
      162	1600	162	164	2
      210	426	212	212	2
      246	490	247	248	2
      180	364	182	183	3
      230	468	232	233	3
      110	1120	112	114	4
      165	1670	167	169	4
