vector: true

script: |
  super -f text -I q969.spq > q969.out

inputs:
  - name: q969.spq
    data: |
      SELECT d-e,
      c-d,
      b,
      b-c,
      abs(b-c),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR e+d BETWEEN a+b-10 AND c+130
      ORDER BY 5,3,4,2,6,1;
  - name: t1

outputs:
  - name: q969.out
    data: |
      -1	-2	105	-1	1	333
      4	-1	112	-1	1	111
      -1	3	118	-1	1	333
      2	1	124	1	1	333
      4	-3	167	1	1	333
      -2	1	100	-2	2	555
      1	1	139	2	2	111
      -4	1	143	2	2	111
      -1	-1	200	-2	2	222
      -2	1	206	-2	2	111
      -1	-1	158	3	3	555
      3	1	181	-3	3	333
      -1	-1	198	3	3	555
      -1	-1	228	3	3	555
      2	-3	129	4	4	333
      1	1	130	-4	4	444
