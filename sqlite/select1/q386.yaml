vector: true

script: |
  super -f text -I q386.spq > q386.out

inputs:
  - name: q386.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a
      FROM t1 (FORMAT parquet)
      WHERE b>c
      AND c BETWEEN b-2 AND d+2
      AND (e>c OR e<d)
      ORDER BY 1,2;
  - name: t1

outputs:
  - name: q386.out
    data: |
      468	234
      478	239
      490	245
      1240	121
      1390	138
      1430	142
      1510	153
      1670	168
