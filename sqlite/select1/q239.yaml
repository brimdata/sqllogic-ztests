vector: true

script: |
  super -f text -I q239.spq > q239.out

inputs:
  - name: q239.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d,
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR c BETWEEN b-2 AND d+2
      OR d NOT BETWEEN 110 AND 150
      ORDER BY 1,3,2;
  - name: t1

outputs:
  - name: q239.out
    data: |
      358	178	1057
      364	183	1096
      376	185	1121
      382	190	1158
      398	196	1180
      402	203	1207
      410	207	1241
      426	212	1277
      432	217	1297
      440	222	1338
      458	226	1360
      468	233	1391
      478	238	1416
      486	241	1455
      490	248	1484
      1000	101	610
      1050	108	635
      1120	114	674
      1240	122	738
      1290	128	760
      1300	133	793
      1390	136	827
      1430	140	851
      1450	148	880
      1510	154	905
      1580	156	940
      1600	164	966
      1670	169	1000
      1700	171	1030
