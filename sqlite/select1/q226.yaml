script: |
  super -f text -I q226.spq > q226.out

inputs:
  - name: q226.spq
    data: |
      SELECT d-e,
      a+b*2+c*3+d*4,
      d,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a-b,
      b
      FROM t1 (FORMAT parquet)
      WHERE c>d
      AND a>b
      ORDER BY 2,4,3,6,1,5;
  - name: t1

outputs:
  - name: q226.out
    data: |
      -2	1014	101	1000	4	100
      1	1325	133	1300	1	130
      -2	1714	171	1700	4	170
      3	1828	183	364	1	181
      -4	1861	185	376	2	186
      2	2125	212	426	2	211
      -1	2419	241	486	3	240
