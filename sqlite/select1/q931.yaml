vector: true

script: |
  super -f text -I q931.spq > q931.out

inputs:
  - name: q931.spq
    data: |
      SELECT a+b*2+c*3,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d-e,
      c,
      abs(a)
      FROM t1 (FORMAT parquet)
      WHERE (e>a AND e<b)
      ORDER BY 4,1,3,5,2;
  - name: t1

outputs:
  - name: q931.out
    data: |
      708	1180	-1	119	115
      1158	382	-2	193	191
      1338	440	1	224	220
      1484	490	2	247	245
