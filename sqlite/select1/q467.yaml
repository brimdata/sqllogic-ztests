vector: true

script: |
  super -f text -I q467.spq > q467.out

inputs:
  - name: q467.spq
    data: |
      SELECT a,
      abs(a),
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR d NOT BETWEEN 110 AND 150
      OR (e>c OR e<d)
      ORDER BY 2,1,3;
  - name: t1

outputs:
  - name: q467.out
    data: |
      104	104	444
      107	107	333
      111	111	222
      121	121	222
      127	127	222
      131	131	333
      138	138	222
      142	142	222
      149	149	444
      153	153	333
      159	159	333
      163	163	444
      168	168	333
      174	174	444
      179	179	444
      182	182	333
      188	188	333
      191	191	222
      199	199	333
      201	201	333
      205	205	222
      213	213	333
      216	216	222
      220	220	222
      229	229	333
      234	234	333
      239	239	444
      243	243	444
      245	245	111
