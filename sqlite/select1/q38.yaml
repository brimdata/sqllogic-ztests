vector: true

script: |
  super -f text -I q38.spq > q38.out

inputs:
  - name: q38.spq
    data: |
      SELECT a,
      e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a-b
      FROM t1 (FORMAT parquet)
      ORDER BY 2,4,3,1;
  - name: t1

outputs:
  - name: q38.out
    data: |
      104	103	1000	4
      107	109	1050	2
      111	110	1120	-1
      115	117	1180	-3
      121	120	1240	-3
      127	126	1290	-2
      131	132	1300	1
      138	135	1390	-1
      142	144	1430	-1
      149	146	1450	4
      153	152	1510	2
      159	157	1580	1
      163	162	1600	3
      168	165	1670	1
      174	173	1700	4
      179	177	358	4
      182	180	364	1
      188	189	376	2
      191	192	382	-3
      199	197	398	1
      201	204	402	1
      205	209	410	-1
      213	210	426	2
      216	219	432	-2
      220	221	440	-3
      229	227	458	1
      234	230	468	2
      239	237	478	3
      243	242	486	3
      245	246	490	-4
