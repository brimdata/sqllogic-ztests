script: |
  super -f text -I q385.spq > q385.out

inputs:
  - name: q385.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR (e>a AND e<b)
      OR c BETWEEN b-2 AND d+2
      ORDER BY 2,1;
  - name: t1

outputs:
  - name: q385.out
    data: |
      1000	1529
      1050	1612
      1120	1680
      1180	1757
      1240	1826
      1290	1902
      1300	1985
      1390	2046
      1430	2131
      1450	2202
      1510	2281
      1580	2349
      1600	2432
      1670	2501
      1700	2579
      358	2654
      364	2728
      376	2806
      382	2878
      398	2949
      402	3039
      410	3114
      426	3175
      432	3260
      440	3331
      458	3399
      468	3473
      478	3553
      490	3706
