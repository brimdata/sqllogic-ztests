vector: true

script: |
  super -f text -I q874.spq > q874.out

inputs:
  - name: q874.spq
    data: |
      SELECT b-c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      e,
      (a+b+c+d+e)/5,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      AND c BETWEEN b-2 AND d+2
      ORDER BY 3,4,2,5,1;
  - name: t1

outputs:
  - name: q874.out
    data: |
      -1	1120	110	112	1130
      -4	1300	132	132	1325
      2	1390	135	137	1371
      2	1430	144	142	1411
      1	1670	165	167	1676
      -3	364	180	182	1828
      -2	402	204	202	2019
      -2	410	209	207	2069
