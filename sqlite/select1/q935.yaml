script: |
  super -f text -I q935.spq > q935.out

inputs:
  - name: q935.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3,
      e,
      d,
      b-c,
      a
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      OR (a>b-2 AND a<b+2)
      ORDER BY 2,4,5,6,1,3;
  - name: t1

outputs:
  - name: q935.out
    data: |
      1000	610	103	101	-2	104
      1050	635	109	108	-1	107
      1120	674	110	114	-1	111
      1180	708	117	116	-1	115
      1240	738	120	122	1	121
      1290	760	126	128	4	127
      1300	793	132	133	-4	131
      1390	827	135	136	2	138
      1430	851	144	140	2	142
      1580	940	157	156	3	159
      1670	1000	165	169	1	168
      364	1096	180	183	-3	182
      398	1180	197	196	3	199
      402	1207	204	203	-2	201
      410	1241	209	207	-2	205
      458	1360	227	226	3	229
