script: |
  super -f text -I q349.spq > q349.out

inputs:
  - name: q349.spq
    data: |
      SELECT a-b,
      c-d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      (a+b+c+d+e)/5,
      a+b*2+c*3+d*4+e*5,
      b,
      abs(b-c)
      FROM t1 (FORMAT parquet)
      WHERE b>c
      ORDER BY 5,2,1,7,3,4,6;
  - name: t1

outputs:
  - name: q349.out
    data: |
      -3	1	222	122	1826	124	1
      -2	-3	222	127	1902	129	4
      -1	1	222	137	2046	139	2
      -1	1	222	142	2131	143	2
      2	-4	333	152	2281	151	1
      1	-1	333	157	2349	158	3
      1	-3	333	167	2501	167	1
      -3	3	222	192	2878	194	1
      1	-1	333	197	2949	198	3
      -2	-2	222	217	3260	218	3
      1	-1	333	227	3399	228	3
      2	-2	333	232	3473	232	1
      3	-3	444	237	3553	236	1
      -4	-1	111	247	3706	249	2
