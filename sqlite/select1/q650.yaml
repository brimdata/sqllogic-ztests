script: |
  super -f text -I q650.spq > q650.out

inputs:
  - name: q650.spq
    data: |
      SELECT a+b*2,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      ORDER BY 2,4,3,1;
  - name: t1

outputs:
  - name: q650.out
    data: |
      529	358	1057	1769
      560	376	1121	1861
      579	382	1158	1918
      635	426	1277	2125
      652	432	1297	2165
      666	440	1338	2226
      698	468	1391	2323
      711	478	1416	2368
      723	486	1455	2419
      317	1050	635	1067
      351	1180	708	1172
      385	1290	760	1272
      455	1510	905	1521
      483	1600	966	1622
      502	1670	1000	1676
