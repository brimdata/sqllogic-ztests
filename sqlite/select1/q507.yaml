script: |
  super -f text -I q507.spq > q507.out

inputs:
  - name: q507.spq
    data: |
      SELECT b-c,
      c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR (e>c OR e<d)
      ORDER BY 1,2,3;
  - name: t1

outputs:
  - name: q507.out
    data: |
      -4	134	444
      -3	184	333
      -3	214	222
      -2	102	555
      -2	147	555
      -2	172	555
      -2	202	222
      -2	208	111
      -1	106	333
      -1	113	111
      -1	161	333
      -1	176	555
      -1	187	444
      -1	224	444
      1	123	333
      1	150	333
      1	166	333
      1	231	555
      1	235	555
      2	137	111
      2	141	111
      2	247	444
      3	155	555
      3	195	555
      3	215	333
      3	225	555
      4	125	333
