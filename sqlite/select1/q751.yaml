vector: true

script: |
  super -f text -I q751.spq > q751.out

inputs:
  - name: q751.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      b-c,
      abs(a)
      FROM t1 (FORMAT parquet)
      ORDER BY 4,1,3,2;
  - name: t1

outputs:
  - name: q751.out
    data: |
      1000	444	-2	104
      1050	333	-1	107
      1120	222	-1	111
      1180	222	-1	115
      1240	222	1	121
      1290	222	4	127
      1300	333	-4	131
      1390	222	2	138
      1430	222	2	142
      1450	444	-2	149
      1510	333	1	153
      1580	333	3	159
      1600	444	-1	163
      1670	333	1	168
      1700	444	-2	174
      358	444	-1	179
      364	333	-3	182
      376	333	-1	188
      382	222	1	191
      398	333	3	199
      402	333	-2	201
      410	222	-2	205
      426	333	-3	213
      432	222	3	216
      440	222	-1	220
      458	333	3	229
      468	333	1	234
      478	444	1	239
      486	444	-4	243
      490	111	2	245
