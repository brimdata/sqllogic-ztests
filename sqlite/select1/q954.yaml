vector: true

script: |
  super -f text -I q954.spq > q954.out

inputs:
  - name: q954.spq
    data: |
      SELECT abs(a),
      e,
      a-b,
      a,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      d-e
      FROM t1 (FORMAT parquet)
      WHERE a>b
      OR d NOT BETWEEN 110 AND 150
      OR b>c
      ORDER BY 4,6,1,2,3,5;
  - name: t1

outputs:
  - name: q954.out
    data: |
      104	103	4	104	555	-2
      107	109	2	107	333	-1
      121	120	-3	121	333	2
      127	126	-2	127	333	2
      131	132	1	131	444	1
      138	135	-1	138	111	1
      142	144	-1	142	111	-4
      149	146	4	149	555	2
      153	152	2	153	333	2
      159	157	1	159	555	-1
      163	162	3	163	333	2
      168	165	1	168	333	4
      174	173	4	174	555	-2
      179	177	4	179	555	1
      182	180	1	182	333	3
      188	189	2	188	444	-4
      191	192	-3	191	444	-2
      199	197	1	199	555	-1
      201	204	1	201	222	-1
      205	209	-1	205	111	-2
      213	210	2	213	222	2
      216	219	-2	216	333	-2
      220	221	-3	220	444	1
      229	227	1	229	555	-1
      234	230	2	234	555	3
      239	237	3	239	555	1
      243	242	3	243	222	-1
      245	246	-4	245	444	2
