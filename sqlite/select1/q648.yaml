vector: true

script: |
  super -f text -I q648.spq > q648.out

inputs:
  - name: q648.spq
    data: |
      SELECT e,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      ORDER BY 2,1;
  - name: t1

outputs:
  - name: q648.out
    data: |
      177	358
      180	364
      189	376
      192	382
      197	398
      204	402
      209	410
      210	426
      219	432
      221	440
      227	458
      230	468
      237	478
      242	486
      246	490
      103	1000
      109	1050
      110	1120
      117	1180
      120	1240
      126	1290
      132	1300
      135	1390
      144	1430
      146	1450
      152	1510
      157	1580
      162	1600
      165	1670
      173	1700
