vector: true

script: |
  super -f text -I q927.spq > q927.out

inputs:
  - name: q927.spq
    data: |
      SELECT c,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      e,
      a,
      d-e,
      b-c,
      d
      FROM t1 (FORMAT parquet)
      WHERE d NOT BETWEEN 110 AND 150
      ORDER BY 1,7,6,2,3,4,5;
  - name: t1

outputs:
  - name: q927.out
    data: |
      102	555	103	104	-2	-2	101
      106	333	109	107	-1	-1	108
      150	333	152	153	2	1	154
      155	555	157	159	-1	3	156
      161	333	162	163	2	-1	164
      166	333	165	168	4	1	169
      172	555	173	174	-2	-2	171
      176	555	177	179	1	-1	178
      184	333	180	182	3	-3	183
      187	444	189	188	-4	-1	185
      193	444	192	191	-2	1	190
      195	555	197	199	-1	3	196
      202	222	204	201	-1	-2	203
      208	111	209	205	-2	-2	207
      214	222	210	213	2	-3	212
      215	333	219	216	-2	3	217
      224	444	221	220	1	-1	222
      225	555	227	229	-1	3	226
      231	555	230	234	3	1	233
      235	555	237	239	1	1	238
      244	222	242	243	-1	-4	241
      247	444	246	245	2	2	248
