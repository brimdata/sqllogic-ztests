vector: true

script: |
  super -f text -I q884.spq > q884.out

inputs:
  - name: q884.spq
    data: |
      SELECT a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      abs(b-c),
      a+b*2+c*3
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR (e>c OR e<d)
      ORDER BY 2,1,3,4;
  - name: t1

outputs:
  - name: q884.out
    data: |
      245	111	2	1484
      111	222	1	674
      121	222	1	738
      127	222	4	760
      138	222	2	827
      142	222	2	851
      191	222	1	1158
      205	222	2	1241
      216	222	3	1297
      220	222	1	1338
      107	333	1	635
      131	333	4	793
      153	333	1	905
      159	333	3	940
      168	333	1	1000
      182	333	3	1096
      188	333	1	1121
      199	333	3	1180
      201	333	2	1207
      213	333	3	1277
      229	333	3	1360
      234	333	1	1391
      104	444	2	610
      149	444	2	880
      163	444	1	966
      174	444	2	1030
      179	444	1	1057
      239	444	1	1416
