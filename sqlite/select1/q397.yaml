script: |
  super -f text -I q397.spq > q397.out

inputs:
  - name: q397.spq
    data: |
      SELECT c-d,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b-c,
      b
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 3,4,2,1;
  - name: t1

outputs:
  - name: q397.out
    data: |
      1	444	-4	130
      3	222	-4	240
      1	333	-3	181
      2	222	-3	211
      -1	222	-2	200
      1	111	-2	206
      -2	333	-1	105
      -1	111	-1	112
      3	333	-1	118
      -3	333	-1	160
      -2	555	-1	175
      2	444	-1	186
      2	444	-1	223
      -4	333	1	151
      -3	333	1	167
      3	444	1	194
      -2	555	1	232
      -3	555	1	236
      1	111	2	139
      1	111	2	143
      -1	555	3	158
      -1	555	3	198
      -2	333	3	218
      -1	555	3	228
      -3	333	4	129
