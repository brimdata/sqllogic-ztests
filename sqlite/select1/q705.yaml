vector: true

script: |
  super -f text -I q705.spq > q705.out

inputs:
  - name: q705.spq
    data: |
      SELECT CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE c>d
      ORDER BY 2,1,4,3;
  - name: t1

outputs:
  - name: q705.out
    data: |
      555	102	1000	1014
      333	119	1180	1172
      333	123	1240	1226
      444	134	1300	1325
      111	137	1390	1371
      111	141	1430	1411
      555	172	1700	1714
      333	184	364	1828
      444	187	376	1861
      444	193	382	1918
      111	208	410	2069
      222	214	426	2125
      444	224	440	2226
      222	244	486	2419
