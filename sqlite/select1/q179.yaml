vector: true

script: |
  super -f text -I q179.spq > q179.out

inputs:
  - name: q179.spq
    data: |
      SELECT a+b*2+c*3,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      c,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      d
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      ORDER BY 1,5,3,2,4;
  - name: t1

outputs:
  - name: q179.out
    data: |
      635	333	106	1050	108
      708	222	119	1180	116
      760	222	125	1290	128
      905	333	150	1510	154
      966	444	161	1600	164
      1000	333	166	1670	169
      1057	444	176	358	178
      1121	333	187	376	185
      1158	222	193	382	190
      1277	333	214	426	212
      1297	222	215	432	217
      1338	222	224	440	222
      1391	333	231	468	233
      1416	444	235	478	238
      1455	444	244	486	241
