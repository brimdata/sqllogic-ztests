script: |
  super -f text -I q989.spq > q989.out

inputs:
  - name: q989.spq
    data: |
      SELECT a-b,
      d,
      d-e,
      a,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE a>b
      ORDER BY 3,5,4,2,1,6;
  - name: t1

outputs:
  - name: q989.out
    data: |
      2	185	-4	188	333	444
      4	101	-2	104	444	555
      4	171	-2	174	444	555
      2	108	-1	107	333	333
      1	156	-1	159	333	555
      1	196	-1	199	333	555
      1	203	-1	201	333	222
      1	226	-1	229	333	555
      3	241	-1	243	444	222
      1	133	1	131	333	444
      4	178	1	179	444	555
      3	238	1	239	444	555
      2	154	2	153	333	333
      2	212	2	213	333	222
      4	148	2	149	444	555
      3	164	2	163	444	333
      1	183	3	182	333	333
      2	233	3	234	333	555
      1	169	4	168	333	333
