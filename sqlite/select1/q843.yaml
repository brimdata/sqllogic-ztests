vector: true

script: |
  super -f text -I q843.spq > q843.out

inputs:
  - name: q843.spq
    data: |
      SELECT b-c,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      d,
      a+b*2+c*3+d*4+e*5,
      e
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      ORDER BY 3,5,1,2,4;
  - name: t1

outputs:
  - name: q843.out
    data: |
      -1	222	114	1680	110
      -4	333	133	1985	132
      2	222	136	2046	135
      2	222	140	2131	144
      3	333	156	2349	157
      1	333	169	2501	165
      -3	333	183	2728	180
      3	333	196	2949	197
      -2	333	203	3039	204
      -2	222	207	3114	209
      3	333	226	3399	227
