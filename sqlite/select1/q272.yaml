vector: true

script: |
  super -f text -I q272.spq > q272.out

inputs:
  - name: q272.spq
    data: |
      SELECT a-b,
      b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      ORDER BY 2,1,3;
  - name: t1

outputs:
  - name: q272.out
    data: |
      4	100	444
      2	105	333
      -1	112	222
      -3	118	222
      -3	124	222
      -2	129	222
      1	130	333
      -1	139	222
      -1	143	222
      4	145	444
      2	151	333
      1	158	333
      3	160	444
      1	167	333
      4	170	444
      4	175	444
      1	181	333
      2	186	333
      -3	194	222
      1	198	333
      1	200	333
      -1	206	222
      2	211	333
      -2	218	222
      -3	223	222
      1	228	333
      2	232	333
      3	236	444
      3	240	444
      -4	249	111
