script: |
  super -f text -I q617.spq > q617.out

inputs:
  - name: q617.spq
    data: |
      SELECT a+b*2+c*3,
      a+b*2+c*3+d*4+e*5,
      CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END
      FROM t1 (FORMAT parquet)
      WHERE b>c
      OR d NOT BETWEEN 110 AND 150
      OR e+d BETWEEN a+b-10 AND c+130
      ORDER BY 3,2,1;
  - name: t1

outputs:
  - name: q617.out
    data: |
      1057	2654	358
      1096	2728	364
      1121	2806	376
      1158	2878	382
      1180	2949	398
      1207	3039	402
      1241	3114	410
      1277	3175	426
      1297	3260	432
      1338	3331	440
      1360	3399	458
      1391	3473	468
      1416	3553	478
      1455	3629	486
      1484	3706	490
      610	1529	1000
      635	1612	1050
      674	1680	1120
      708	1757	1180
      738	1826	1240
      760	1902	1290
      827	2046	1390
      851	2131	1430
      905	2281	1510
      940	2349	1580
      966	2432	1600
      1000	2501	1670
      1030	2579	1700
