script: |
  super -f text -I q251.spq > q251.out

inputs:
  - name: q251.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      ORDER BY 2,3,1;
  - name: t1

outputs:
  - name: q251.out
    data: |
      490	111	2476
      1120	222	1130
      1180	222	1172
      1240	222	1226
      1290	222	1272
      1390	222	1371
      1430	222	1411
      382	222	1918
      410	222	2069
      432	222	2165
      440	222	2226
      1050	333	1067
      1300	333	1325
      1510	333	1521
      1580	333	1564
      1670	333	1676
      364	333	1828
      376	333	1861
      398	333	1964
      402	333	2019
      426	333	2125
      458	333	2264
      468	333	2323
      1000	444	1014
      1450	444	1472
      1600	444	1622
      1700	444	1714
      358	444	1769
      478	444	2368
      486	444	2419
