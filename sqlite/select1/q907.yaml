vector: true

script: |
  super -f text -I q907.spq > q907.out

inputs:
  - name: q907.spq
    data: |
      SELECT abs(b-c),
      d-e,
      a+b*2,
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END
      FROM t1 (FORMAT parquet)
      WHERE (c<=d-2 OR c>=d+2)
      OR d NOT BETWEEN 110 AND 150
      OR c>d
      ORDER BY 4,2,3,1;
  - name: t1

outputs:
  - name: q907.out
    data: |
      2	-4	428	111
      2	-2	617	111
      2	1	416	111
      2	-1	601	222
      4	-1	723	222
      3	2	635	222
      3	-2	652	333
      1	-1	317	333
      1	-1	351	333
      1	2	369	333
      4	2	385	333
      1	2	455	333
      1	2	483	333
      3	3	544	333
      1	4	502	333
      1	-4	560	444
      1	-2	579	444
      4	1	391	444
      1	1	666	444
      2	2	743	444
      2	-2	304	555
      2	-2	514	555
      3	-1	475	555
      3	-1	595	555
      3	-1	685	555
      1	1	529	555
      1	1	711	555
      1	3	698	555
