vector: true

script: |
  super -f text -I q221.spq > q221.out

inputs:
  - name: q221.spq
    data: |
      SELECT d,
      abs(b-c),
      a-b,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2+c*3,
      e,
      b
      FROM t1 (FORMAT parquet)
      ORDER BY 2,6,3,5,7,4,1;
  - name: t1

outputs:
  - name: q221.out
    data: |
      108	1	2	333	635	109	105
      114	1	-1	222	674	110	112
      116	1	-3	222	708	117	118
      122	1	-3	222	738	120	124
      154	1	2	333	905	152	151
      164	1	3	444	966	162	160
      169	1	1	333	1000	165	167
      178	1	4	444	1057	177	175
      185	1	2	333	1121	189	186
      190	1	-3	222	1158	192	194
      222	1	-3	222	1338	221	223
      233	1	2	333	1391	230	232
      238	1	3	444	1416	237	236
      101	2	4	444	610	103	100
      136	2	-1	222	827	135	139
      140	2	-1	222	851	144	143
      148	2	4	444	880	146	145
      171	2	4	444	1030	173	170
      203	2	1	333	1207	204	200
      207	2	-1	222	1241	209	206
      248	2	-4	111	1484	246	249
      156	3	1	333	940	157	158
      183	3	1	333	1096	180	181
      196	3	1	333	1180	197	198
      212	3	2	333	1277	210	211
      217	3	-2	222	1297	219	218
      226	3	1	333	1360	227	228
      128	4	-2	222	760	126	129
      133	4	1	333	793	132	130
      241	4	3	444	1455	242	240
