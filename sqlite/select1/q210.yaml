vector: true

script: |
  super -f text -I q210.spq > q210.out

inputs:
  - name: q210.spq
    data: |
      SELECT d,
      a,
      abs(b-c),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      b-c,
      (a+b+c+d+e)/5,
      e
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR (a>b-2 AND a<b+2)
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 3,5,1,4,7,6,2;
  - name: t1

outputs:
  - name: q210.out
    data: |
      108	107	1	333	-1	107	109
      114	111	1	111	-1	112	110
      116	115	1	333	-1	117	117
      164	163	1	333	-1	162	162
      178	179	1	555	-1	177	177
      185	188	1	444	-1	187	189
      222	220	1	444	-1	222	221
      122	121	1	333	1	122	120
      154	153	1	333	1	152	152
      169	168	1	333	1	167	165
      190	191	1	444	1	192	192
      233	234	1	555	1	232	230
      238	239	1	555	1	237	237
      101	104	2	555	-2	102	103
      148	149	2	555	-2	147	146
      171	174	2	555	-2	172	173
      203	201	2	222	-2	202	204
      207	205	2	111	-2	207	209
      136	138	2	111	2	137	135
      140	142	2	111	2	142	144
      248	245	2	444	2	247	246
      183	182	3	333	-3	182	180
      212	213	3	222	-3	212	210
      156	159	3	555	3	157	157
      196	199	3	555	3	197	197
      217	216	3	333	3	217	219
      226	229	3	555	3	227	227
      133	131	4	444	-4	132	132
      241	243	4	222	-4	242	242
      128	127	4	333	4	127	126
