vector: true

script: |
  super -f text -I q996.spq > q996.out

inputs:
  - name: q996.spq
    data: |
      SELECT c-d,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      a+b*2,
      e,
      c,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE e+d BETWEEN a+b-10 AND c+130
      OR (e>c OR e<d)
      ORDER BY 2,4,6,5,3,1;
  - name: t1

outputs:
  - name: q996.out
    data: |
      -1	111	743	246	247	2476
      -1	222	335	110	113	1130
      3	222	351	117	119	1172
      1	222	369	120	123	1226
      -3	222	385	126	125	1272
      1	222	416	135	137	1371
      1	222	428	144	141	1411
      1	222	617	209	208	2069
      -2	222	652	219	215	2165
      2	222	666	221	224	2226
      -2	333	317	109	106	1067
      1	333	391	132	134	1325
      -4	333	455	152	150	1521
      -1	333	475	157	155	1564
      -3	333	502	165	166	1676
      1	333	544	180	184	1828
      2	333	560	189	187	1861
      -1	333	595	197	195	1964
      -1	333	601	204	202	2019
      2	333	635	210	214	2125
      -1	333	685	227	225	2264
      -2	333	698	230	231	2323
      1	444	304	103	102	1014
      -1	444	439	146	147	1472
      -3	444	483	162	161	1622
      1	444	514	173	172	1714
      -2	444	529	177	176	1769
      -3	444	711	237	235	2368
