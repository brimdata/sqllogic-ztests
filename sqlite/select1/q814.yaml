script: |
  super -f text -I q814.spq > q814.out

inputs:
  - name: q814.spq
    data: |
      SELECT a+b*2+c*3+d*4+e*5,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END,
      (a+b+c+d+e)/5,
      abs(a),
      CASE a+1 WHEN b THEN 111 WHEN c THEN 222
      WHEN d THEN 333  WHEN e THEN 444 ELSE 555 END,
      c,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE c>d
      OR e+d BETWEEN a+b-10 AND c+130
      OR (e>a AND e<b)
      ORDER BY 2,1,4,3,5,6,7;
  - name: t1

outputs:
  - name: q814.out
    data: |
      3706	111	247	245	444	247	2476
      1680	222	112	111	111	113	1130
      1757	222	117	115	333	119	1172
      1826	222	122	121	333	123	1226
      1902	222	127	127	333	125	1272
      2046	222	137	138	111	137	1371
      2131	222	142	142	111	141	1411
      2878	222	192	191	444	193	1918
      3114	222	207	205	111	208	2069
      3331	222	222	220	444	224	2226
      1612	333	107	107	333	106	1067
      1985	333	132	131	444	134	1325
      2728	333	182	182	333	184	1828
      2806	333	187	188	444	187	1861
      3175	333	212	213	222	214	2125
      1529	444	102	104	555	102	1014
      2579	444	172	174	555	172	1714
      3629	444	242	243	222	244	2419
