vector: true

script: |
  super -f text -I q36.spq > q36.out

inputs:
  - name: q36.spq
    data: |
      SELECT abs(b-c),
      a,
      a+b*2,
      CASE WHEN a<b-3 THEN 111 WHEN a<=b THEN 222
      WHEN a<b+3 THEN 333 ELSE 444 END
      FROM t1 (FORMAT parquet)
      ORDER BY 1,4,3,2;
  - name: t1

outputs:
  - name: q36.out
    data: |
      1	111	335	222
      1	115	351	222
      1	121	369	222
      1	191	579	222
      1	220	666	222
      1	107	317	333
      1	153	455	333
      1	168	502	333
      1	188	560	333
      1	234	698	333
      1	163	483	444
      1	179	529	444
      1	239	711	444
      2	245	743	111
      2	138	416	222
      2	142	428	222
      2	205	617	222
      2	201	601	333
      2	104	304	444
      2	149	439	444
      2	174	514	444
      3	216	652	222
      3	159	475	333
      3	182	544	333
      3	199	595	333
      3	213	635	333
      3	229	685	333
      4	127	385	222
      4	131	391	333
      4	243	723	444
