script: |
  super -f text -I q957.spq > q957.out

inputs:
  - name: q957.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      abs(a),
      a+b*2,
      a,
      d-e
      FROM t1 (FORMAT parquet)
      WHERE (e>c OR e<d)
      OR (c<=d-2 OR c>=d+2)
      ORDER BY 4,2,3,5,1;
  - name: t1

outputs:
  - name: q957.out
    data: |
      1000	104	304	104	-2
      1050	107	317	107	-1
      1120	111	335	111	4
      1180	115	351	115	-1
      1240	121	369	121	2
      1290	127	385	127	2
      1300	131	391	131	1
      1390	138	416	138	1
      1430	142	428	142	-4
      1450	149	439	149	2
      1510	153	455	153	2
      1580	159	475	159	-1
      1600	163	483	163	2
      1670	168	502	168	4
      1700	174	514	174	-2
      358	179	529	179	1
      364	182	544	182	3
      376	188	560	188	-4
      382	191	579	191	-2
      398	199	595	199	-1
      402	201	601	201	-1
      410	205	617	205	-2
      426	213	635	213	2
      432	216	652	216	-2
      440	220	666	220	1
      458	229	685	229	-1
      468	234	698	234	3
      478	239	711	239	1
      486	243	723	243	-1
      490	245	743	245	2
