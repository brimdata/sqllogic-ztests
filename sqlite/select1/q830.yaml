vector: true

script: |
  super -f text -I q830.spq > q830.out

inputs:
  - name: q830.spq
    data: |
      SELECT CASE WHEN c>(SELECT avg(c) FROM t1 (FORMAT parquet)) THEN a*2 ELSE b*10 END,
      a+b*2+c*3+d*4+e*5,
      a+b*2+c*3+d*4
      FROM t1 (FORMAT parquet)
      WHERE (a>b-2 AND a<b+2)
      ORDER BY 1,2,3;
  - name: t1

outputs:
  - name: q830.out
    data: |
      364	2728	1828
      398	2949	1964
      402	3039	2019
      410	3114	2069
      458	3399	2264
      1120	1680	1130
      1300	1985	1325
      1390	2046	1371
      1430	2131	1411
      1580	2349	1564
      1670	2501	1676
